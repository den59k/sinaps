(this.webpackJsonpsinaps=this.webpackJsonpsinaps||[]).push([[0],{41:function(e,t,a){e.exports=a(56)},47:function(e,t,a){},48:function(e,t,a){},54:function(e,t,a){},56:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),r=a(24),o=a.n(r),i=a(2),l=a(3),c=a(5),m=a(4),u=(a(46),a(47),a(48),a(7)),p=a(18),h=a(12),d=a(26),f=a(34),g=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;for(var s in Object(i.a)(this,a),(n=t.call(this,e)).type=e.type||"text",n.fields=n.props.fields,n.state={},n.fields)n.state[s]="";return n}return Object(l.a)(a,[{key:"handleChange",value:function(e){this.setState(e),this.props.onChange(e)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"input-text"+(this.props.error?" error":""),style:this.props.style},this.props.children,Object.keys(this.fields).map((function(t){return s.a.createElement("input",{type:e.type,value:e.state[t],onChange:function(a){return e.handleChange(Object(d.a)({},t,a.target.value))},key:t,placeholder:e.fields[t]})})),this.props.error&&s.a.createElement("div",{className:"error-label"},this.props.error))}}]),a}(s.a.Component),v=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(i.a)(this,a),(n=t.call(this,e)).handleChange=function(e){n.setState({value:e.target.checked}),n.props.onChange(e.target.checked)};var s=n.props.isChecked||!0;return n.state={value:s},n}return Object(l.a)(a,[{key:"render",value:function(){return s.a.createElement("label",Object.assign({className:"input-checkbox"},this.props),s.a.createElement("input",{type:"checkbox",checked:this.state.value,onChange:this.handleChange}),s.a.createElement("span",{className:"box-checkbox"}),s.a.createElement("span",null,this.props.children))}}]),a}(s.a.Component),b=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).rippleEffect=function(e){var t=e.currentTarget.getBoundingClientRect(),a={left:e.clientX-t.left-n.size/2,top:e.clientY-t.top-n.size/2,id:Object(f.a)(4),size:n.size};a.timeout=setTimeout((function(){n.state.rippleElements.length>1?n.setState({rippleElements:n.state.rippleElements.slice(1)}):n.setState({rippleElements:[]})}),1e3),n.setState({rippleElements:[].concat(Object(h.a)(n.state.rippleElements),[a])})},n.state={rippleElements:[]},n.size=e.size||100,n.style=n.props.style||{},n}return Object(l.a)(a,[{key:"componentWillUnmount",value:function(){this.state.rippleElements.forEach((function(e){clearTimeout(e.timeout)}))}},{key:"render",value:function(){var e=this.props.className||"";return s.a.createElement("button",Object.assign({},this.props,{className:"my-button "+e,onMouseDown:this.rippleEffect}),this.props.children,this.state.rippleElements.map((function(e){return s.a.createElement("div",{className:"ripple-effect",style:{top:e.top,left:e.left,width:e.size+"px",height:e.size+"px"},key:e.id})})))}}]),a}(s.a.Component),E=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.className||"";return s.a.createElement(u.b,Object.assign({},this.props,{className:"my-button clear "+e,onMouseDown:this.rippleEffect}),this.props.children,this.state.rippleElements.map((function(e){return s.a.createElement("div",{className:"ripple-effect",style:{top:e.top,left:e.left,width:e.size+"px",height:e.size+"px"},key:e.id})})))}}]),a}(b);function y(e){var t,a=Object(n.useState)(!1),r=Object(p.a)(a,2),o=r[0],i=r[1],l=function(a){var n=(a.clientX-t.left)/t.width;n<0&&(n=0),n>1&&(n=1),e.onChange&&e.onChange(n)};return s.a.createElement("div",Object.assign({className:"slider"+(o?" active":"")},e,{onMouseDown:function(e){e.preventDefault(),t=e.currentTarget.getBoundingClientRect(),i(!0),l(e),document.addEventListener("mouseup",(function(){i(!1),document.removeEventListener("mousemove",l)}),{once:!0}),document.addEventListener("mousemove",l)}}),s.a.createElement("div",{className:"slider-line"}),s.a.createElement("div",{className:"slider-line on",style:{left:0,width:100*e.value+"%"}}),s.a.createElement("div",{className:"slider-point",style:{left:100*e.value+"%"}}))}function k(e){var t=Object.keys(e.fields),a=Object(n.useState)(e.value||""),r=Object(p.a)(a,2),o=r[0],i=r[1];return s.a.createElement("div",{style:e.style,className:"segment-wrapper "+e.className},s.a.createElement("div",{className:"segment-title"},e.title),s.a.createElement("div",{className:"segment-button"},t.map((function(t){return s.a.createElement("button",{className:t===o?"active":"",onClick:function(){i(t),e.onChange&&e.onChange(t)},key:t},e.fields[t])}))))}var C=a(6),O=a(10),j="wss://"+window.location.host,N=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).login=function(e){if(e.preventDefault(),!n.loadingFlag){var t={login:null,password:null};""===n.auth.login&&(t.login='\u041f\u043e\u043b\u0435 "E-mail" \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043e');for(var a in!1===/^([A-Za-z0-9_\-.])+@([A-Za-z0-9_\-.])+.([A-Za-z]{2,4})$/.test(n.auth.login)&&(t.login="\u041d\u0435\u0442 \u0442\u0430\u043a\u043e\u0433\u043e email, \u0438 \u0431\u044b\u0442\u044c \u043d\u0435 \u043c\u043e\u0436\u0435\u0442"),""===n.auth.password&&(t.password='\u041f\u043e\u043b\u0435 "\u041f\u0430\u0440\u043e\u043b\u044c" \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043e'),n.setState({errors:t}),t)if(null!==t[a])return;n.loadingFlag=!0,fetch("/authorization",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",token:"000000"},body:JSON.stringify(n.auth)}).then((function(e){return e.json()})).then((function(e){if(n.loadingFlag=!1,e.errors)return Object.assign(t,e.errors),void n.setState({errors:t});e.success&&(n.props.onLogin(e.success),n.remember&&localStorage.setItem("auth",JSON.stringify(n.auth)))})).catch((function(e){n.loadingFlag=!1}))}},n.onChange=function(e){Object.assign(n.auth,e);var t=Object.assign({},n.state.errors);for(var a in e)switch(a){case"login":t.login=null;break;case"password":t.password=null}n.setState({errors:t})},n.loadingFlag=!1,n.remember=!0,n.auth={login:"",password:""},n.state={errors:{login:null,password:null}},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"login-page anim up"},s.a.createElement("div",{className:"login-column"},s.a.createElement("form",{className:"login-form",onSubmit:this.login},s.a.createElement("h1",null,"\u0412\u0445\u043e\u0434 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443"),s.a.createElement(g,{fields:{login:"E-mail"},type:"text",onChange:this.onChange,error:this.state.errors.login},s.a.createElement(C.c,{size:"1.6em"})),s.a.createElement(g,{fields:{password:"\u041f\u0430\u0440\u043e\u043b\u044c"},type:"password",onChange:this.onChange,error:this.state.errors.password},s.a.createElement(O.b,{size:"1.3em"})),s.a.createElement("div",{className:"form-flex"},s.a.createElement(v,{onChange:function(t){return e.remember=t}},"\u0417\u0430\u043f\u043e\u043c\u043d\u0438\u0442\u044c \u043c\u0435\u043d\u044f"),s.a.createElement(b,null,"\u0412\u041e\u0419\u0422\u0418"))),s.a.createElement("p",{style:{marginTop:"22px",marginBottom:"13px"}},"\u0415\u0449\u0435 \u043d\u0435 \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0432\u0438\u0434\u0435\u043e\u043b\u0435\u043a\u0446\u0438\u044f\u043c?"),s.a.createElement(u.b,{to:"/register",className:"center-button"},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442"),s.a.createElement("hr",{style:{marginTop:"40px"}}),s.a.createElement("span",{className:"podpis",style:{position:"relative",top:"-19px"}},"\u0438\u043b\u0438"),s.a.createElement(b,{className:"social-media-button",style:{backgroundColor:"#4A76A8",marginBottom:"12px"},size:200},s.a.createElement(O.d,null),"\u0412\u043e\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 \u0412\u041a"),s.a.createElement(b,{className:"social-media-button",style:{backgroundColor:"#F44235"},size:200},s.a.createElement(O.a,null),"\u0412\u043e\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 Google")),s.a.createElement("div",{className:"login-label",style:{marginBottom:"200px"}},s.a.createElement("p",null,"\u0414\u0438\u0441\u0442\u0430\u043d\u0446\u0438\u043e\u043d\u043d\u043e\u0435 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 - ",s.a.createElement("span",{className:"orange"},"\u044d\u0442\u043e \u043f\u0440\u043e\u0441\u0442\u043e"))))}}]),a}(s.a.Component),x=a(27),w=a(37),S=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={className:"",message:null},n.delay=n.props.delay||2e3,n.timeout=-1,n}return Object(l.a)(a,[{key:"alert",value:function(e){var t=this;this.timeout&&clearTimeout(this.timeout),this.setState({message:e}),this.timeout=setTimeout((function(){return t.setState({className:"alert-active"})}),50),this.timeout=setTimeout((function(){t.setState({className:"alert-exit"}),t.timeout=setTimeout((function(){t.setState({message:null}),t.timeout=-1}),500)}),this.delay)}},{key:"componentWillUnmount",value:function(){this.timeout>=0&&(clearTimeout(this.timeout),this.timeout=-1)}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,this.props.children,s.a.createElement("div",{className:"alert-wrapper"},this.state.message&&s.a.createElement("div",{className:"alert "+this.state.className},this.state.message)))}}]),a}(s.a.Component),R=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).register=function(e){if(e.preventDefault(),!n.loadingFlag){var t={mail:null,name:null,pass:null};for(var a in!1===/^([A-Za-z0-9_\-.])+@([A-Za-z0-9_\-.])+.([A-Za-z]{2,4})$/.test(n.info.mail)&&(t.mail="\u041d\u0435\u0442 \u0442\u0430\u043a\u043e\u0433\u043e email, \u0438 \u0431\u044b\u0442\u044c \u043d\u0435 \u043c\u043e\u0436\u0435\u0442"),""===n.info.mail&&(t.mail='\u041f\u043e\u043b\u0435 "Email" \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043e'),""===n.info.surname&&(t.name='\u041f\u043e\u043b\u0435 "\u0424\u0430\u043c\u0438\u043b\u0438\u044f" \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043e'),""===n.info.name&&(t.name='\u041f\u043e\u043b\u0435 "\u0418\u043c\u044f" \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043e'),n.info.repeatPass!==n.info.pass&&(t.pass="\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442"),n.info.pass.length<3&&(t.pass="\u0414\u043b\u044f\u043d\u0430 \u043f\u0430\u0440\u043e\u043b\u044f \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u043e\u0442 3 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"),""===n.info.pass&&(t.pass='\u041f\u043e\u043b\u044f "\u041f\u0430\u0440\u043e\u043b\u044c" \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043e'),n.setState({errors:t}),t)if(null!==t[a])return;fetch("/registration",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",token:"000000"},body:JSON.stringify(n.info)}).then((function(e){return e.json()})).then((function(e){if(n.loadingFlag=!1,e.errors)return Object.assign(t,e.errors),void n.setState({errors:t});e.success&&(console.log("success"),n.alertRef.current.alert("\u0410\u043a\u043a\u0430\u0443\u043d\u0442 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u043d. \u0412\u0435\u0440\u043d\u0438\u0442\u0435\u0441\u044c \u043d\u0430\u0437\u0430\u0434, \u0447\u0442\u043e\u0431\u044b \u0432\u043e\u0439\u0442\u0438"))}))}},n.onChange=function(e){Object.assign(n.info,e);var t=Object.assign({},n.state.errors);for(var a in e)switch(a){case"mail":t.mail=null;break;case"name":case"surname":t.name=null;break;case"pass":case"repeatPass":t.pass=null}n.setState({errors:t})},n.loadingFlag=!1,n.info={mail:"",name:"",surname:"",pass:"",repeatPass:""},n.state={errors:{mail:null,name:null,pass:null}},n.alertRef=s.a.createRef(),n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"login-page anim down",style:{maxWidth:"900px",minHeight:"90vh"}},s.a.createElement(S,{delay:3e3,ref:this.alertRef},s.a.createElement("div",{className:"login-label",style:{marginLeft:"0",height:"330px"}},s.a.createElement(u.b,{className:"toBack",to:"/"},s.a.createElement(x.a,{size:"1.8em"}),"\u0412\u0445\u043e\u0434 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"),s.a.createElement("p",null,"\u0423\u0436\u0435 85 \u0447\u0435\u043b\u043e\u0432\u0435\u043a \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0432\u0438\u0434\u0435\u043e\u043b\u0435\u043a\u0446\u0438\u044f\u043c."," ",s.a.createElement("span",{className:"orange"},"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u044f\u0439\u0442\u0435\u0441\u044c \u0438 \u0432\u044b."))),s.a.createElement("div",{className:"login-column"},s.a.createElement("form",{className:"login-form register-form",onSubmit:this.register},s.a.createElement("h1",null,"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430"),s.a.createElement("div",{className:"form-flex"},s.a.createElement(g,{error:this.state.errors.mail,fields:{mail:"E-mail"},type:"text",onChange:this.onChange},s.a.createElement(C.c,{size:"1.6em"})),s.a.createElement(v,{style:{margin:"12px 22px"},onChange:function(t){return e.remember=t}},"\u041f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f")),s.a.createElement(g,{fields:{name:"\u0418\u043c\u044f",surname:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f"},type:"text",onChange:this.onChange,error:this.state.errors.name},s.a.createElement(w.a,{size:"1.6em"})),s.a.createElement(g,{fields:{pass:"\u041f\u0430\u0440\u043e\u043b\u044c",repeatPass:"\u041f\u043e\u0432\u0442\u043e\u0440 \u043f\u0430\u0440\u043e\u043b\u044f"},type:"password",onChange:this.onChange,error:this.state.errors.pass},s.a.createElement(O.b,{size:"1.3em"})),s.a.createElement("div",{className:"last-button"},s.a.createElement(b,null,"\u041f\u0420\u041e\u0414\u041e\u041b\u0416\u0418\u0422\u042c"))))))}}]),a}(s.a.Component),T=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).login=function(e){e.preventDefault(),n.loadingFlag||(n.loadingFlag=!0,fetch(n.url+"/authorization",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(n.auth)}).then((function(e){return e.json()})).then((function(e){console.log(e),n.loadingFlag=!1})))},n.loadingFlag=!1,n.url=e.net.url,n.auth={login:"",password:""},n}return Object(l.a)(a,[{key:"componentWillUnmount",value:function(){this.props.unmount(this.render())}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"login-page anim"},s.a.createElement("div",{className:"login-column"},s.a.createElement("form",{className:"login-form",onSubmit:this.login},s.a.createElement("h1",null,"\u0412\u0445\u043e\u0434 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443"),s.a.createElement(g,{placeholder:"E-mail",type:"text",onChange:function(t){return e.auth.login=t}},s.a.createElement(C.c,{size:"1.6em"})),s.a.createElement(g,{placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",type:"password",onChange:function(t){return e.auth.password=t}},s.a.createElement(O.b,{size:"1.3em"})),s.a.createElement("div",{className:"form-flex"},s.a.createElement(v,{onChange:function(t){return e.remember=t}},"\u0417\u0430\u043f\u043e\u043c\u043d\u0438\u0442\u044c \u043c\u0435\u043d\u044f"),s.a.createElement(b,null,"\u0412\u041e\u0419\u0422\u0418"))),s.a.createElement("p",{style:{marginTop:"22px",marginBottom:"13px"}},"\u0415\u0449\u0435 \u043d\u0435 \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0432\u0438\u0434\u0435\u043e\u043b\u0435\u043a\u0446\u0438\u044f\u043c?"),s.a.createElement(u.b,{to:"/auth/register",className:"center-button"},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442"),s.a.createElement("hr",{style:{marginTop:"40px"}}),s.a.createElement("span",{className:"podpis",style:{position:"relative",top:"-19px"}},"\u0438\u043b\u0438"),s.a.createElement(b,{className:"social-media-button",style:{backgroundColor:"#4A76A8",marginBottom:"12px"},size:200},s.a.createElement(O.d,null),"\u0412\u043e\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 \u0412\u041a"),s.a.createElement(b,{className:"social-media-button",style:{backgroundColor:"#F44235"},size:200},s.a.createElement(O.a,null),"\u0412\u043e\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 Google")),s.a.createElement("div",{className:"login-label",style:{marginBottom:"200px"}},s.a.createElement("p",null,"\u0414\u0438\u0441\u0442\u0430\u043d\u0446\u0438\u043e\u043d\u043d\u043e\u0435 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 - ",s.a.createElement("span",{className:"orange"},"\u044d\u0442\u043e \u043f\u0440\u043e\u0441\u0442\u043e"))))}}]),a}(s.a.Component),M=a(20),P=a(58),z=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).unmount=function(e,t){},n.routes=[{path:"/",Component:N},{path:"/register",Component:R},{path:"/info",Component:T}],n.state={last:null,className:""},n.myRef=s.a.createRef(),n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return this.props.net.token?s.a.createElement(M.a,{to:"/"}):s.a.createElement("div",{className:"page login-main-page"},s.a.createElement(u.a,{basename:"/auth"},this.routes.map((function(t){var a=t.path,n=t.Component;return s.a.createElement(M.b,{key:a,exact:!0,path:a},(function(t){var a=t.match;return s.a.createElement(P.a,{in:null!=a,timeout:500,classNames:"changes",unmountOnExit:!0},s.a.createElement("div",{className:"animBlock"},s.a.createElement(n,{net:e.props.net,onLogin:e.props.onLogin})))}))}))),s.a.createElement("div",{className:"fixed-logo"}))}}]),a}(s.a.Component),I=a(19),D=a(28),L=a(13),B=a(22),F=a.n(B);function G(){return(G=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function A(e,t){if(null==e)return{};var a,n,s=function(e,t){if(null==e)return{};var a,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(s[a]=e[a]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}var H=s.a.createElement("path",{d:"M7.65426 10.5V14.3462C7.36149 14.2511 7.05073 14.2 6.73133 14.2H5.75702C4.16208 14.2 2.78271 15.4733 2.78271 17.15V19.5345C2.78271 24.1656 5.28416 28.4551 9.17628 30.7267C8.28018 31.2241 7.65426 32.1705 7.65426 33.3001V34.25C7.65426 35.9268 9.03362 37.2001 10.6286 37.2001H20.3716C21.9666 37.2001 23.346 35.9268 23.346 34.25V33.3001C23.346 32.1942 22.746 31.2639 21.88 30.7586C25.6525 28.6105 28.2175 24.6153 28.2175 20V17.15C28.2175 15.4733 26.8381 14.2 25.2432 14.2H24.2689C23.9495 14.2 23.6387 14.2511 23.346 14.3462V10.5C23.346 6.20008 19.7854 2.80005 15.5001 2.80005C11.2149 2.80005 7.65426 6.20008 7.65426 10.5Z",fill:"white",stroke:"white",strokeWidth:4}),W=s.a.createElement("path",{d:"M15.5001 25.7001C18.7287 25.7001 21.346 23.1481 21.346 20V10.5C21.346 7.35199 18.7287 4.80005 15.5001 4.80005C12.2715 4.80005 9.65426 7.35199 9.65426 10.5V20C9.65426 23.1481 12.2715 25.7001 15.5001 25.7001ZM25.2432 16.2H24.2689C23.7306 16.2 23.2946 16.6252 23.2946 17.15V20C23.2946 24.4413 19.3675 28.005 14.7213 27.5632C10.6718 27.1779 7.70564 23.6285 7.70564 19.6616V17.15C7.70564 16.6252 7.26964 16.2 6.73133 16.2H5.75702C5.21872 16.2 4.78271 16.6252 4.78271 17.15V19.5345C4.78271 24.8569 8.67812 29.6016 14.0386 30.3224V32.35H10.6286C10.0903 32.35 9.65426 32.7752 9.65426 33.3001V34.25C9.65426 34.7749 10.0903 35.2001 10.6286 35.2001H20.3716C20.91 35.2001 21.346 34.7749 21.346 34.25V33.3001C21.346 32.7752 20.91 32.35 20.3716 32.35H16.9616V30.345C22.1808 29.6467 26.2175 25.2785 26.2175 20V17.15C26.2175 16.6252 25.7815 16.2 25.2432 16.2Z",fill:"#FF5C00"}),U=function(e){var t=e.svgRef,a=e.title,n=A(e,["svgRef","title"]);return s.a.createElement("svg",G({width:31,height:40,viewBox:"0 0 31 40",fill:"none",ref:t},n),a?s.a.createElement("title",null,a):null,H,W)},J=s.a.forwardRef((function(e,t){return s.a.createElement(U,G({svgRef:t},e))}));a.p;function Z(){return(Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function V(e,t){if(null==e)return{};var a,n,s=function(e,t){if(null==e)return{};var a,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(s[a]=e[a]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}var _=s.a.createElement("path",{d:"M26.5965 22.3165C28.4206 20.1168 29.4375 17.3651 29.4375 14.5C29.4375 11.1578 28.0538 7.96993 25.619 5.6326C23.1871 3.29795 19.9055 2 16.5 2C13.0945 2 9.81289 3.29795 7.38096 5.6326C4.94625 7.96993 3.5625 11.1578 3.5625 14.5C3.5625 17.3651 4.57939 20.1168 6.40353 22.3165L5.58185 23.6861L2.75714 28.3943C2.2542 29.1739 2 30.0695 2 31C2 32.353 2.56065 33.6333 3.53023 34.5641C4.49703 35.4922 5.79151 36 7.125 36H25.875C27.2085 36 28.503 35.4922 29.4698 34.5641C30.4394 33.6333 31 32.353 31 31C31 30.0695 30.7458 29.1739 30.2428 28.3943L27.4181 23.6861L26.5965 22.3165Z",fill:"white",stroke:"white",strokeWidth:4}),X=s.a.createElement("path",{d:"M16.5 4C19.4008 4 22.1828 5.10625 24.234 7.07538C26.2852 9.04451 27.4375 11.7152 27.4375 14.5C27.4375 17.2848 26.2852 19.9555 24.234 21.9246C22.1828 23.8938 19.4008 25 16.5 25C13.5992 25 10.8172 23.8938 8.76602 21.9246C6.71484 19.9555 5.5625 17.2848 5.5625 14.5C5.5625 11.7152 6.71484 9.04451 8.76602 7.07538C10.8172 5.10625 13.5992 4 16.5 4ZM16.5 7C14.428 7 12.4409 7.79018 10.9757 9.1967C9.5106 10.6032 8.6875 12.5109 8.6875 14.5C8.6875 16.4891 9.5106 18.3968 10.9757 19.8033C12.4409 21.2098 14.428 22 16.5 22C17.526 22 18.5419 21.806 19.4897 21.4291C20.4376 21.0522 21.2988 20.4997 22.0243 19.8033C22.7497 19.1069 23.3252 18.2801 23.7178 17.3701C24.1104 16.4602 24.3125 15.4849 24.3125 14.5C24.3125 12.5109 23.4894 10.6032 22.0243 9.1967C20.5591 7.79018 18.572 7 16.5 7ZM16.5 10C17.7432 10 18.9355 10.4741 19.8146 11.318C20.6936 12.1619 21.1875 13.3065 21.1875 14.5C21.1875 15.6935 20.6936 16.8381 19.8146 17.682C18.9355 18.5259 17.7432 19 16.5 19C15.2568 19 14.0645 18.5259 13.1854 17.682C12.3064 16.8381 11.8125 15.6935 11.8125 14.5C11.8125 13.3065 12.3064 12.1619 13.1854 11.318C14.0645 10.4741 15.2568 10 16.5 10ZM7.125 34C6.2962 34 5.50134 33.6839 4.91529 33.1213C4.32924 32.5587 4 31.7956 4 31C4 30.43 4.15625 29.905 4.45312 29.455L7.29688 24.715C9.85431 26.8351 13.121 28.0011 16.5 28C20.0156 28 23.2344 26.755 25.7031 24.715L28.5469 29.455C28.8437 29.905 29 30.43 29 31C29 31.7956 28.6708 32.5587 28.0847 33.1213C27.4987 33.6839 26.7038 34 25.875 34H7.125Z",fill:"#FF5C00"}),Y=function(e){var t=e.svgRef,a=e.title,n=V(e,["svgRef","title"]);return s.a.createElement("svg",Z({width:33,height:38,viewBox:"0 0 33 38",fill:"none",ref:t},n),a?s.a.createElement("title",null,a):null,_,X)},q=s.a.forwardRef((function(e,t){return s.a.createElement(Y,Z({svgRef:t},e))}));a.p;function $(e){var t=e.size||40,a=e.src?""+e.src:null,n=e.name;if(e.profile&&(n=e.profile.name+" "+e.profile.surname,a=e.profile.icon?""+e.profile.icon:null),a)return s.a.createElement("img",{className:F()("icon"),src:a,alt:n,title:n,style:Object(L.a)({width:t+"px",height:t+"px"},e.style)});var r=n[0];return s.a.createElement("div",{style:Object(L.a)({width:t+"px",height:t+"px",lineHeight:t-2+"px",fontSize:t/2+"px"},e.style),className:F()("icon-empty icon",e.className),title:n},r)}function K(e){var t=e.size||40;return s.a.createElement("div",{className:"icon-wrapper",style:{height:t+"px"}},s.a.createElement($,e),!0===e.online&&s.a.createElement("div",{className:"mini-icon"}))}function Q(e){Object(n.useEffect)((function(){if(e.stream.stream){var t=e.context,a=t.createMediaStreamSource(e.stream.stream),n=t.createAnalyser();n.fftSize=64,a.connect(n);var s=t.createGain();n.connect(s),s.connect(t.destination),m(s);var r=new Uint8Array(n.fftSize),o=setInterval((function(){n.getByteTimeDomainData(r);for(var e=0,t=4;t<n.fftSize-4;t++)e+=Math.abs(r[t]-128);var a=e/(n.fftSize-8);(a=Math.min(a/8|0,4))!==d&&f(a)}),300);return function(){return clearInterval(o)}}}),[e.stream]);var t=Object(n.useState)(!1),a=Object(p.a)(t,2),r=a[0],o=a[1],i=Object(n.useState)(null),l=Object(p.a)(i,2),c=l[0],m=l[1],u=Object(n.useState)(0),h=Object(p.a)(u,2),d=h[0],f=h[1],g=Object(L.a)(Object(L.a)({},e),{},{profile:e.stream.user});return delete g.stream,delete g.context,g.style={border:"".concat(d,"px solid #FF5C00"),margin:4-d+"px"},s.a.createElement("div",Object.assign({},g,{style:{display:"inline-block"},className:"icon-wrapper",onClick:function(){!0===r?(o(!1),c.gain.value=1):(o(!0),c.gain.value=0)}}),s.a.createElement($,Object.assign({size:"60"},g)),e.stream.video&&s.a.createElement(q,{className:"sub-icon",style:{left:"-5px"},title:"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0432\u0435\u0431-\u043a\u0430\u043c\u0435\u0440\u0443"}),e.stream.audio&&s.a.createElement(J,{className:"sub-icon",style:{right:"-5px"},title:"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u043c\u0438\u043a\u0440\u043e\u0444\u043e\u043d"}),r&&s.a.createElement("div",{className:"volume-stats"},s.a.createElement(O.e,null)))}function ee(e){return s.a.createElement("div",{className:"title",style:e.pos?e.pos:{display:"none"}},e.text)}var te=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).showTitle=function(e){var t=e.currentTarget;n.titleTimeout=setTimeout((function(){var e=t.getBoundingClientRect(),a=e.right+window.pageXOffset,s=e.top+e.height/2+window.pageYOffset;n.setState({title:{pos:{left:a,top:s},text:t.getAttribute("alt")}})}),600)},n.hideTitle=function(e){n.setState({title:null}),clearTimeout(n.titleTimeout)},n.state={title:null,className:"enter"},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.setState({className:e.state.className+" enter-active"})}),200),setTimeout((function(){e.setState({className:""})}),500)}},{key:"render",value:function(){var e=this,t=[{link:"/"+this.props.profile.login,description:this.props.profile.name,Component:s.a.createElement($,{className:"hover-opacity",profile:this.props.profile})},{link:"/c",description:"\u0413\u0440\u0443\u043f\u043f\u044b",Component:s.a.createElement(D.a,{size:"1.2em"})},{link:"/",description:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f",Component:s.a.createElement(C.d,null)},{link:"/settings",description:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",Component:s.a.createElement(C.i,null)}];return s.a.createElement("nav",{className:"nav-bar "+this.state.className},s.a.createElement(ee,Object.assign({},this.state.title,{show:null!==this.state.title})),s.a.createElement("div",{className:"nav-tools"},s.a.createElement(M.b,{path:"/:page"},(function(a){var n=a.match,r="/";if(null!==n){var o,i=Object(I.a)(t);try{for(i.s();!(o=i.n()).done;){var l=o.value;if(l.link===n.url){r=l.link;break}}}catch(c){i.e(c)}finally{i.f()}}return t.map((function(t){var a=t.link,n=t.Component,o=t.description;return s.a.createElement(u.b,{className:"nav-link"+(r===a?" active":""),key:a,to:a,onMouseEnter:e.showTitle,onMouseLeave:e.hideTitle,onClick:e.hideTitle,alt:o},s.a.createElement("div",{className:"spline"}),n)}))}))))}}]),a}(s.a.Component),ae=(a(54),a(9)),ne=a.n(ae),se=a(17);function re(e){var t=e.size||50;return s.a.createElement("svg",{width:t,height:t,viewport:"0 0 50 50",viewBox:"0 0 50 50",className:"loader",stroke:"currentColor"},s.a.createElement("circle",{cx:"25",cy:"25",r:"15",strokeWidth:"3",fill:"none"}))}var oe=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).bkgClick=function(e){e.target===e.currentTarget&&n.props.cancel&&n.props.cancel()},n.state={bkgClassName:" enter",modalClassName:" enter"},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.setState({bkgClassName:" enter-active",modalClassName:" enter-active"})}),50),setTimeout((function(){e.setState({bkgClassName:"",modalClassName:""})}),400)}},{key:"render",value:function(){return s.a.createElement("div",{className:"modal-window-bkg"+this.state.bkgClassName,onMouseDown:this.bkgClick},s.a.createElement("div",{className:F()("modal-window",this.state.modalClassName,this.props.className)},this.props.disabled&&s.a.createElement("div",{className:"disabled-fill"},s.a.createElement(re,{size:"70"})),s.a.createElement("h3",{className:"modal-title"},this.props.title),this.props.children))}}]),a}(s.a.Component);function ie(e){return s.a.createElement(oe,{disabled:e.disabled,title:e.title,cancel:e.cancel},e.children,s.a.createElement("div",{className:"modal-buttons"},e.cancelTo&&s.a.createElement(E,{style:{marginRight:"10px",fontWeight:"600"},className:"transparent",to:e.cancelTo},"\u041e\u0442\u043c\u0435\u043d\u0430"),e.cancel&&s.a.createElement(b,{style:{marginRight:"10px",fontWeight:"600"},className:"transparent",onClick:e.cancel},"\u041e\u0442\u043c\u0435\u043d\u0430"),s.a.createElement(b,{style:{},onClick:e.onSubmit},e.success?e.success:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")))}var le=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={fixedBody:null,modal:null},n.ref=s.a.createRef(),n}return Object(l.a)(a,[{key:"openWindow",value:function(e){this.setState({fixedBody:{top:-window.pageYOffset,left:-window.pageXOffset},modal:e})}},{key:"closeWindow",value:function(){this.setState({fixedBody:null,modal:null})}},{key:"componentDidMount",value:function(){this.props.modal&&this.openWindow(this.props.modal)}},{key:"componentDidUpdate",value:function(e,t){null===this.state.fixedBody&&null!==t.fixedBody&&window.scrollTo(-t.fixedBody.left,-t.fixedBody.top),!e.modal&&this.props.modal&&this.openWindow(this.props.modal),e.modal&&!this.props.modal&&this.closeWindow()}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{ref:this.ref,style:this.state.fixedBody?Object(L.a)(Object(L.a)({},this.state.fixedBody),{},{position:"fixed",right:"0"}):{}},this.props.children),this.state.modal)}}]),a}(s.a.Component),ce=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).showImageTools=function(){n.setState({showPopup:" active"})},n.hideImageTools=function(){n.setState({showPopup:""})},n.loadPhoto=function(e){e.target.files.length>0&&n.props.changePhoto(e.target.files[0])},n.loadRef=s.a.createRef(),n.state={showPopup:""},n}return Object(l.a)(a,[{key:"render",value:function(){var e,t=this;return e=this.props.src?s.a.createElement("img",{className:"full-profile-image",src:""+this.props.src,alt:this.props.alt}):s.a.createElement("div",{className:"full-profile-image null-image",alt:this.props.alt}),s.a.createElement("div",{className:"edit-image",onClick:function(){return t.loadRef.current.click()},onMouseEnter:this.showImageTools,onMouseLeave:this.hideImageTools},s.a.createElement("div",{className:"popup"+this.state.showPopup},s.a.createElement(C.b,{size:"3em"}),s.a.createElement("div",{className:"popup-label"},"\u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435")),s.a.createElement("input",{type:"file",name:"photo",style:{display:"none"},ref:this.loadRef,onChange:this.loadPhoto,accept:"image/png, image/jpeg"}),e)}}]),a}(s.a.Component);function me(e){return s.a.createElement("section",{style:e.style,className:e.className},s.a.createElement("h3",null,e.title),e.children)}function ue(e){return new Promise((function(t,a){setTimeout(t,e)}))}var pe=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).imageLoaded=function(e){n.sizeImage={width:e.target.naturalWidth,height:e.target.naturalHeight},n.minScale=200/Math.min(n.sizeImage.width,n.sizeImage.height);var t=n.minScale+.1*(n.maxScale-n.minScale);n.setState({movePos:{x:(-n.sizeImage.width+200/t)/2,y:(-n.sizeImage.height+200/t)/2},scale:t})},n.startMoveImage=function(e){n.lastPos={x:e.clientX,y:e.clientY},document.addEventListener("mouseup",(function(e){e.preventDefault(),document.removeEventListener("mousemove",n.moveImage)}),{once:!0}),document.addEventListener("mousemove",n.moveImage),e.preventDefault()},n.editPosImage=function(e,t,a){var s=Object.assign({},n.state.movePos);s.x+=e/a,s.y+=t/a,s.x>0&&(s.x=0),s.y>0&&(s.y=0),s.x-200/a<-n.sizeImage.width&&(s.x=-n.sizeImage.width+200/a),s.y-200/a<-n.sizeImage.height&&(s.y=-n.sizeImage.height+200/a),n.setState({movePos:s})},n.moveImage=function(e){var t=e.clientX-n.lastPos.x,a=e.clientY-n.lastPos.y;n.editPosImage(t,a,n.state.scale),n.lastPos={x:e.clientX,y:e.clientY}},n.changeZoom=function(e){e<0&&(e=0),e>1&&(e=1);var t=n.minScale+e*e*(n.maxScale-n.minScale),a=n.state.scale;n.editPosImage(100*(a-t)/a,100*(a-t)/a,t),n.setState({scale:t})},n.getValue=function(){return Math.sqrt((n.state.scale-n.minScale)/(n.maxScale-n.minScale))},n.submitPhoto=Object(se.a)(ne.a.mark((function e(){var t,a,s,r,o;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({processed:!0}),e.next=3,ue(200);case 3:return t={x:-n.state.movePos.x,y:-n.state.movePos.y,width:200/n.state.scale,height:200/n.state.scale,img:n.imgRef.current},(a=document.createElement("canvas")).width=512,a.height=512,a.getContext("2d",{alpha:!1}).drawImage(t.img,t.x,t.y,t.width,t.height,0,0,512,512),(s=document.createElement("canvas")).width=96,s.height=96,s.getContext("2d",{alpha:!1,antialias:!0}).drawImage(a,0,0,512,512,0,0,96,96),e.next=16,n.getBuffer(a);case 16:return r=e.sent,e.next=19,n.getBuffer(s);case 19:o=e.sent,a.remove(),s.remove(),n.props.onSubmit(r,o);case 23:case"end":return e.stop()}}),e)}))),n.state={modalChangePhoto:!1,movePos:{x:0,y:0},scale:.1,processed:!1},n.maxScale=1,n.minScale=0,n.imgRef=s.a.createRef(),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){return e.setState({photoUrl:e.props.photoUrl})}),300)}},{key:"getBuffer",value:function(e){return new Promise((function(t,a){try{e.toBlob((function(e){return e.arrayBuffer().then((function(e){return t(e)}))}),"image/jpeg",.6)}catch(n){a(n)}}))}},{key:"render",value:function(){var e=this;return s.a.createElement(ie,{title:"\u0424\u043e\u0442\u043e \u043f\u0440\u043e\u0444\u0438\u043b\u044f",cancel:this.props.cancel,onSubmit:this.submitPhoto,disabled:this.state.processed},s.a.createElement("div",{className:"changePhoto",style:{width:"500px",height:"300px"},onMouseDown:this.startMoveImage},s.a.createElement("img",{src:this.state.photoUrl,alt:"",style:{transformOrigin:"0 0",transform:"scale(".concat(this.state.scale,") \n\t\t\t\t\t\t\t\ttranslate(").concat(this.state.movePos.x+150/this.state.scale,"px, ").concat(this.state.movePos.y+50/this.state.scale,"px) ")}}),s.a.createElement("div",{className:"black"}),s.a.createElement("div",{className:"changePhoto-photo",style:{width:"200px",height:"200px",top:"50px",left:"150px"}},s.a.createElement("div",{className:"loader-wrapper"},s.a.createElement(re,{size:"70"})),s.a.createElement("img",{src:this.state.photoUrl,onLoad:this.imageLoaded,alt:"",ref:this.imgRef,style:{transformOrigin:"0 0",transform:"scale(".concat(this.state.scale,") translate(").concat(this.state.movePos.x,"px, ").concat(this.state.movePos.y,"px) ")}}))),s.a.createElement("div",{style:{marginTop:"15px"},className:"slider-wrapper"},s.a.createElement("div",{className:"zoom-icon",onClick:function(){return e.changeZoom(e.getValue()-.1)}},s.a.createElement(C.k,{size:"1.6em"})),s.a.createElement(y,{value:this.getValue(),onChange:this.changeZoom,style:{width:"200px",verticalAlign:"middle"}}),s.a.createElement("div",{className:"zoom-icon",onClick:function(){return e.changeZoom(e.getValue()+.1)}},s.a.createElement(C.j,{size:"1.6em"}))))}}]),a}(s.a.Component),he=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).changePhoto=function(e){var t=URL.createObjectURL(e),a=n.modalWrapperRef.current;a.openWindow(s.a.createElement(pe,{photoUrl:t,cancel:function(){return a.closeWindow()},onSubmit:n.renderImage}))},n.renderImage=function(){var e=Object(se.a)(ne.a.mark((function e(t,a){var s,r,o;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(s=new Uint8Array(t.byteLength+a.byteLength)).set(new Uint8Array(t),0),s.set(new Uint8Array(a),t.byteLength),e.next=5,fetch("/upload-profile-image",{method:"POST",headers:{token:n.props.net.token,"full-image":t.byteLength,"mini-image":a.byteLength},body:s.buffer});case 5:return r=e.sent,e.next=8,r.json();case 8:(o=e.sent).error?(console.error(o),n.alertRef.current.alert("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430")):(n.props.net.update(o),n.alertRef.current.alert("\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043e")),n.modalWrapperRef.current.closeWindow();case 11:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.modalWrapperRef=s.a.createRef(),n.alertRef=s.a.createRef(),n.state={src:null},n.maxScale=2,n}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.net.profile;return s.a.createElement(le,{ref:this.modalWrapperRef},s.a.createElement(S,{delay:2e3,ref:this.alertRef},s.a.createElement("div",{className:"home-page root-block"},s.a.createElement("header",{className:"profile-header"},s.a.createElement(ce,{src:this.props.net.profile.fullIcon,alt:e.name+" "+e.surname,changePhoto:this.changePhoto}),s.a.createElement("div",{className:"person-info"},s.a.createElement("h1",{className:"person-name"},e.name+" "+e.surname),s.a.createElement("h2",{className:"person-group"},"\u0441\u0442\u0443\u0434\u0435\u043d\u0442 ",s.a.createElement(u.b,{to:"/"},"\u0410\u0421\u0423 17-1\u0431"))),s.a.createElement("p",{className:"expertition"},"\u041a\u0430\u043a\u0430\u044f-\u043d\u0438\u0431\u0443\u0434\u044c \u0441\u0438\u043b\u044c\u043d\u0430\u044f \u0446\u0438\u0442\u0430\u0442\u0430")),s.a.createElement(me,{className:"profile-section",style:{marginTop:"10px"},title:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u043a\u043e\u043d\u0444\u0435\u0440\u0435\u043d\u0446\u0438\u0438"}))))}}]),a}(s.a.Component),de=["\ud83d\ude04\ud83d\ude03\ud83d\ude00\ud83d\ude0a\ud83d\ude0f\ud83d\ude09\ud83d\ude0d\ud83d\ude18\ud83d\ude1a\ud83d\ude17\ud83d\ude19\ud83d\ude1c\ud83d\ude1d\ud83d\ude1b\ud83d\ude33\ud83d\ude2c\ud83d\ude14\ud83d\ude0c\ud83d\ude12\ud83d\ude1e\ud83d\ude23\ud83d\ude22\ud83d\ude02\ud83d\ude2d\ud83d\ude2a\ud83d\ude25\ud83d\ude30","\ud83d\ude05\ud83d\ude13\ud83d\ude29\ud83d\ude2b\ud83d\ude28\ud83d\ude31\ud83d\ude20\ud83d\ude21\ud83d\ude24\ud83d\ude16\ud83d\ude06\ud83d\ude0b\ud83d\ude37\ud83d\ude0e\ud83d\ude34\ud83d\ude35\ud83d\ude32\ud83d\ude1f\ud83d\ude26\ud83d\ude27\ud83d\ude08\ud83d\udc7f\ud83d\ude2e\ud83d\ude2c\ud83d\ude10\ud83d\ude15\ud83d\ude2f"];function fe(e){for(var t=0;t<de.length;t++)for(var a=0;a<27;a++)if(de[t].charCodeAt(2*a+1)===e)return 27*t+a;return-1}function ge(e){var t=e%27,a=e/27|0;return'<img class="emoji" src = "/static/split/image_'.concat(a+1,"_").concat(t+1,'.png" alt="').concat(de[a].substr(2*t,2),'"/>')}function ve(e){var t=e.emoji%27,a=e.emoji/27|0,n=18*-t+"px "+18*-a+"px",r=de[Math.min(de.length-1,a)].substr(2*t,2);return s.a.createElement("span",{className:"emoji-pattern-wrapper",onMouseDown:function(t){t.preventDefault(),e.paste(r)}},s.a.createElement("span",{className:"emoji-pattern",style:{backgroundPosition:n}}))}var be=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).send=function(){for(var e,t=n.textInput.current,a="";null!==(e=t.firstChild);)e.nodeType===Node.TEXT_NODE?a+=e.data:("IMG"===e.tagName&&(a+=e.getAttribute("alt")),"BR"===e.tagName&&e!==t.lastChild&&(a+="\n")),e.remove();n.props.send(a),n.checkPlaceholder()},n.keyDown=function(e){13!==e.keyCode||e.shiftKey||(n.send(),e.preventDefault())},n.checkPlaceholder=function(){for(var e=n.textInput.current;null!==e.firstChild&&("BR"===e.firstChild.tagName||" "===e.firstChild.nodeValue);)e.firstChild.remove();e.childNodes.length>0&&n.state.placeholder&&n.setState({placeholder:!1}),0!==e.childNodes.length||n.state.placeholder||n.setState({placeholder:!0})},n.paste=function(e){e.preventDefault();var t=(e.originalEvent||e).clipboardData.getData("text/plain");n.pasteText(t)},n.pasteText=function(e){if(document.activeElement!==n.textInput.current){n.textInput.current.focus();var t=document.getSelection();t.selectAllChildren(n.textInput.current),t.collapseToEnd()}e=e.replace(/\n/g,"<br/>"),n.textInput.current.lastChild&&"BR"===n.textInput.current.lastChild.tagName&&n.textInput.current.lastChild.remove();for(var a=0;a<e.length;a++){var s=e.charCodeAt(a);if(s>=55296&&s<=57343){var r=fe(e.charCodeAt(a+1));if(r>=0){var o=ge(r);e=e.substring(0,a)+o+e.substring(a+2),a+=o.length-1}else a++}}document.execCommand("insertHTML",!1,e)},n.timer=-1,n._showEmojiPanel=function(e){if(0===e.buttons)return n.timer>0?(clearTimeout(n.timer),void(n.timer=-1)):void n.setState({emojiPanel:!0})},n._hideEmojiPanel=function(){n.timer<0&&(n.timer=setTimeout((function(){n.setState({emojiPanel:!1}),n.timer=-1}),200))},n.focus=function(){n.textInput.current.focus()},n.height=e.height||"50",n.lineHeight=e.lineHeight||"25",n.textInput=s.a.createRef(),n.state={placeholder:!0,emojiPanel:!1},n}return Object(l.a)(a,[{key:"render",value:function(){var e={lineHeight:this.lineHeight+"px",padding:(this.height-this.lineHeight)/2+"px 4px",outline:"none"};return s.a.createElement("div",{className:"chat "+this.props.className,style:{display:this.props.show?"flex":"none"}},s.a.createElement("div",{className:"emoji-button",onMouseOver:this._showEmojiPanel,onMouseOut:this._hideEmojiPanel},s.a.createElement(b,{className:"transparent chat-button"+(this.state.emojiPanel?" orange":"")},s.a.createElement(C.h,{size:"1.9em"})),s.a.createElement(Ee,{paste:this.pasteText,show:this.state.emojiPanel})),s.a.createElement("div",{className:"input"},this.state.placeholder&&s.a.createElement("div",{className:"placeholder",style:e},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435..."),s.a.createElement("div",{ref:this.textInput,contentEditable:!0,style:e,onInput:this.checkPlaceholder,onPaste:this.paste,spellCheck:!1,onKeyDown:this.keyDown})),s.a.createElement(b,{className:"transparent chat-button send"+(this.state.placeholder?" closed":""),onClick:this.send},s.a.createElement(C.g,{size:"1.9em",style:{transform:"translateX(2px)"}})))}}]),a}(s.a.Component);function Ee(e){var t=Object(n.useState)(" closed"),a=Object(p.a)(t,2),r=a[0],o=a[1];Object(n.useEffect)((function(){if(!e.show){o(" close-active");var t=setTimeout((function(){return o(" closed")}),250);return function(){clearTimeout(t)}}o(" open"),setTimeout((function(){return o(" open-active")}),20)}),[e.show]);return s.a.createElement("div",{className:"emoji-panel "+r},s.a.createElement("div",{className:"list-emoji-panel",style:{top:"7px"}},function(){for(var t=[],a=0;a<189;a++)t.push(s.a.createElement(ve,{emoji:a,paste:e.paste,key:a}));return t}()))}function ye(e,t,a,n){return e%100/10>>0===1||e%10>=5||e%10===0?n:e%10===1?t:a}function ke(e,t){var a=new Date(e),n=Date.now(),s=60*a.getTimezoneOffset()*1e3,r=(n-s)/864e5>>0,o=(e-s)/864e5>>0;if(r-o===0){if(!0===t)return"\u0441\u0435\u0433\u043e\u0434\u043d\u044f";var i=a.getMinutes();return a.getHours()+":"+(i<10?"0"+i:i)}return r-o===1?"\u0432\u0447\u0435\u0440\u0430":a.getDate()+" "+function(e){switch(e){case 0:return"\u044f\u043d\u0432\u0430\u0440\u044f";case 1:return"\u0444\u0435\u0432\u0440\u0430\u043b\u044f";case 2:return"\u043c\u0430\u0440\u0442\u0430";case 3:return"\u0430\u043f\u0440\u0435\u043b\u044f";case 4:return"\u043c\u0430\u044f";case 5:return"\u0438\u044e\u043d\u044f";case 6:return"\u0438\u044e\u043b\u044f";case 7:return"\u0430\u0432\u0433\u0443\u0441\u0442\u0430";case 8:return"\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f";case 9:return"\u043e\u043a\u0442\u044f\u0431\u0440\u044f";case 10:return"\u043d\u043e\u044f\u0431\u0440\u044f";case 11:return"\u0434\u0435\u043a\u0430\u0431\u0440\u044f";default:return e<10?"0"+e:e}}(a.getMonth())}var Ce=a(38),Oe=a.n(Ce);function je(e){var t=e.message.text,a=new Date(e.message.timestamp),n=a.getMinutes(),r=a.getHours()+":"+(n<10?"0"+n:n),o=e.lastMessage&&e.lastMessage.user.login===e.message.user.login&&e.message.timestamp<e.lastMessage.timestamp+6e5,i=60*a.getTimezoneOffset()*1e3,l=-1;e.lastMessage&&(l=(e.lastMessage.timestamp-i)/864e5>>0);var c=null;return(e.message.timestamp-i)/864e5>>0!==l&&(o=!1,c=ke(e.message.timestamp,!0)),o?s.a.createElement("div",{className:"message-wrapper next"},s.a.createElement("div",{className:"message"},s.a.createElement("div",{className:"message-text"},t))):s.a.createElement("div",{className:F()("message-wrapper new",e.className)},null!==c&&s.a.createElement("div",{className:"message-date"},c),s.a.createElement($,{profile:e.message.user,size:"45"}),s.a.createElement("div",{className:"message"},s.a.createElement("div",{className:"message-header"},s.a.createElement("span",{className:"profile-name"},e.message.user.name+" "+e.message.user.surname),s.a.createElement("span",{className:"time"},r)),s.a.createElement("div",{className:"message-text"},t)))}var Ne=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).updateMessages=function(){n.updateFlag=!0},n.scrollFlag=-1,n.scrollDown=function(){n.scrollFlag=n.messagesRef.current.scrollTop;var e=performance.now(),t=n.messagesRef.current.scrollTop,a=n.messagesRef.current.scrollHeight-n.messagesRef.current.clientHeight;!function s(r){if(n.scrollFlag===n.messagesRef.current.scrollTop){var o=Math.min((r-e)/140,1);o=Oe()(o),n.messagesRef.current.scrollTop=t+(a-t)*o>>0,n.scrollFlag=n.messagesRef.current.scrollTop,o<1&&requestAnimationFrame(s)}}(e)},n.fetchingFlag=!1,n.onScrollMessage=function(e){n.props.bind&&n.messagesRef.current.scrollTop<500&&n.props.messages[0].index>0&&!n.fetchingFlag&&!n.loadingFlag&&(n.fetchingFlag=!0,setTimeout((function(){return n.fetchingFlag=!1}),1e3),n.props.scrollMessage())},n.messagesRef=s.a.createRef(),n.lastScroll=-1,n.updateFlag=!1,n.loadingFlag=!1,n.timeout=null,n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.messagesRef.current;this.loadingFlag=!0,setTimeout((function(){return e.loadingFlag=!1}),0),t.scrollTop=t.scrollHeight}},{key:"componentDidUpdate",value:function(e){var t=this;if(e.bind!==this.props.bind||this.updateFlag){var a=this.messagesRef.current;this.loadingFlag=!0,setTimeout((function(){return t.loadingFlag=!1}),50),a.scrollTop=a.scrollHeight,this.updateFlag=!1}this.lastScroll>=0&&(this.lastScroll<20&&(this.scrollFlag=-1,requestAnimationFrame(this.scrollDown)),this.lastScroll=-1)}},{key:"updateScroll",value:function(){var e=this.messagesRef.current;this.lastScroll=e.scrollHeight-e.scrollTop-e.clientHeight}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"messages",style:{flexGrow:2},ref:this.messagesRef,onScroll:this.onScrollMessage},s.a.createElement("div",{className:"messages-wrapper"},s.a.createElement("div",null,this.props.messages.map((function(t,a){return s.a.createElement(je,{key:t.user.login+t.index,className:t.user.login===e.props.net.profile.login&&"mine",message:t,lastMessage:a>0?e.props.messages[a-1]:null})})))))}}]),a}(s.a.Component),xe=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).onSearch=function(e){},n.getNewBind=function(e){fetch("/get-bind/"+e+"?limit=1",{method:"GET",headers:{token:n.props.net.token}}).then((function(e){return e.json()})).then((function(e){e.error||n.setState({binds:[e].concat(Object(h.a)(n.state.binds))})}))},n.getBind=function(e){n.bind=e;for(var t=null,a=-1,s=0;s<n.state.binds.length;s++)if((t=n.state.binds[s]).link===e){a=s,n.setState({bind:t});break}a<0?fetch("/get-bind/"+e+"?limit=50",{method:"GET",headers:{token:n.props.net.token}}).then((function(e){return e.json()})).then((function(e){e.error||n.setState({binds:[].concat(Object(h.a)(n.state.binds),[e]),bind:e})})):t.messages[0].index>0&&t.messages.length<50?fetch("/get-bind/"+e+"?limit=50&last="+t.messages[0].index,{method:"GET",headers:{token:n.props.net.token}}).then((function(e){return e.json()})).then((function(e){if(!e.error){var s;n.messagesRef.current.updateMessages(),(s=e.messages).push.apply(s,Object(h.a)(t.messages));var r=Object(h.a)(n.state.binds);r[a]=e,n.setState({binds:r,bind:e})}})):t.messages[t.messages.length-1].user.login!==n.props.net.profile.login&&(t.readed=t.messages[t.messages.length-1].index+1,n.forceUpdate((function(){n.props.net.socket.send(JSON.stringify({type:"readed",token:n.props.net.token,readed:t.messages[t.messages.length-1].index+1,bind:t.link}))})))},n.sendMessage=function(e){if(null!==n.state.bind&&""!==e.trim()){var t=n.state.bind.messages.length;n.addMessage({bind:n.bind,user:n.props.net.profile,text:e,index:t>0?n.state.bind.messages[t-1].index+1:0,timestamp:Date.now()}),n.bindsRef.current.scrollTop=0,fetch("/write-message",{method:"POST",headers:{token:n.props.net.token,"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({bind:n.bind,text:e})}).then((function(e){return e.json()})).then((function(e){console.log("Sended message")}))}},n.addMessage=function(e){for(var t=Object(h.a)(n.state.binds),a=null,s=0;s<t.length;s++)e.bind===t[s].link&&(a=t[s],t.splice(s,1));null!==a?(a.messageCount++,n.state.bind===a?(n.messagesRef.current.updateScroll(),a.readed++,e.user.login!==n.props.net.profile.login&&n.props.net.socket.send(JSON.stringify({type:"readed",token:n.props.net.token,readed:a.messageCount,bind:a.link}))):a=Object.assign({},a),e.user.login!==n.props.net.profile.login&&(a.online=!0),a.messages.push(e),t.unshift(a),n.setState({binds:t})):(console.log("GET NEW BIND - ",e.bind),n.getNewBind(e.bind))},n.getStatusBind=function(){if(n.state.bind.isGroup){var e=n.state.bind.userCount;return e?e+" "+ye(e,"\u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a","\u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430","\u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432"):"\u0413\u0440\u0443\u043f\u043f\u0430"}return n.state.bind.online?s.a.createElement("b",null,"\u0412 \u0441\u0435\u0442\u0438"):"\u041d\u0435 \u0432 \u0441\u0435\u0442\u0438"},n.scrollMessage=function(e){var t=n.state.bind;fetch("/get-bind/"+t.link+"?limit=100&last="+t.messages[0].index,{method:"GET",headers:{token:n.props.net.token}}).then((function(e){return e.json()})).then((function(e){e.error?console.log(e.error):(t.messages=e.messages.concat(t.messages),n.setState({bind:t}))}))},n.binds=[],n.bind=null,n.chatRef=s.a.createRef(),n.bindsRef=s.a.createRef(),n.messagesRef=s.a.createRef(),n.state={binds:[],bind:null},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e,t){e.match!==this.props.match&&(this.props.match.params.bind?this.props.match.params.bind!==this.bind&&this.getBind(this.props.match.params.bind):(this.setState({profile:null,messages:null}),this.bind=null)),t.bind!==this.state.bind&&this.chatRef.current.focus()}},{key:"componentDidMount",value:function(){var e=this;fetch("/get-binds",{method:"GET",headers:{token:this.props.net.token}}).then((function(e){return e.json()})).then((function(t){t.error?console.error(t.error):(e.setState({binds:t.binds}),e.props.match.params.bind&&e.getBind(e.props.match.params.bind))})),this.props.net.emitter.on("message",this.addMessage)}},{key:"componentWillUnmount",value:function(){this.props.net.emitter.off("message",this.addMessage)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"anim up message-page root-block"},s.a.createElement("header",{className:"main-header"},s.a.createElement("h1",null,"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f")),s.a.createElement("main",{className:"main-content"},s.a.createElement("div",{className:"column",style:{flexBasis:"400px",maxWidth:"400px",flexShrink:0}},s.a.createElement("div",{className:"search-div"},s.a.createElement(g,{fields:{search:"\u041f\u043e\u0438\u0441\u043a"},onChange:this.onSearch},s.a.createElement(C.f,{size:"1.5em"}))),s.a.createElement("div",{className:"binds-wrapper",ref:this.bindsRef},this.state.binds&&s.a.createElement("ul",{className:"binds"},this.state.binds.map((function(t){return s.a.createElement(we,{key:t.link,bind:t,suser:e.props.net.profile.login,active:t===e.state.bind})}))))),s.a.createElement("div",{className:"column",style:{flexGrow:1,backgroundColor:"#E0E0E0"}},this.state.bind&&s.a.createElement("div",{className:"profile-div"},s.a.createElement($,{src:this.state.bind.icon,name:this.state.bind.name,className:this.state.bind.isGroup?"group":"user",size:"50"}),s.a.createElement("div",{className:"profile-info"},s.a.createElement("div",{className:"name"},this.state.bind.name),s.a.createElement("div",{className:"status"},this.getStatusBind())),!0===this.state.bind.isGroup&&s.a.createElement("div",{className:"bar-right-buttons"},s.a.createElement(E,{to:"/"+this.state.bind.link+"/c"},"\u041e\u0442\u043a\u0440\u044b\u0442\u044c \u043a\u043e\u043d\u0444\u0435\u0440\u0435\u043d\u0446\u0438\u044e"))),this.state.bind&&s.a.createElement(Ne,{net:this.props.net,messages:this.state.bind.messages,bind:this.state.bind.link,scrollMessage:this.scrollMessage,ref:this.messagesRef}),s.a.createElement(be,{className:"chat-div",send:this.sendMessage,show:null!==this.state.bind,ref:this.chatRef}))))}}]),a}(s.a.Component);function we(e){var t=null,a="",n="",r=0,o=e.bind.isGroup?"group":"user";return e.bind.messages.length>0&&(a=ke((t=e.bind.messages[e.bind.messages.length-1]).timestamp),t.user.login!==e.bind.link&&(n=t.user.login===e.suser?"\u0412\u044b: ":t.user.name+": "),r=e.bind.messageCount-e.bind.readed),s.a.createElement(u.b,{to:"/"+e.bind.link,className:"clear"},s.a.createElement("li",{className:"bind"+(e.active?" active":"")+(r>0?" unreaded":"")},s.a.createElement(K,{src:e.bind.icon,name:e.bind.name,size:"50",className:o,online:e.bind.online}),s.a.createElement("div",{className:"bind-inner"},s.a.createElement("div",{className:"content"},s.a.createElement("div",{className:"profile-name"},e.bind.name),t&&s.a.createElement("div",{className:"message-text"},s.a.createElement("span",{className:"author"},n),t.text)),s.a.createElement("div",null,s.a.createElement("div",{className:"time"},a),r>0&&s.a.createElement("div",{className:"unread"},r)))))}var Se=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).onChange=function(e){Object.assign(n.roomInfo,e),n.setState({errors:{name:null}})},n.changeSegment=function(e){n.roomInfo.type=e},n.submit=function(){n.roomInfo.name=n.roomInfo.name.trim(),n.roomInfo.name.length<4?n.setState({errors:{name:"\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u043a\u043e\u0440\u043e\u0442\u043a\u043e\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"}}):fetch("/create-new-group",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",token:n.props.net.token},body:JSON.stringify(n.roomInfo)}).then((function(e){return e.json()})).then((function(e){e.errors?n.setState({errors:e.errors}):n.props.success(e)}))},n.roomInfo={name:"",type:"public"},n.state={errors:{name:null}},n.url=n.props.net.url,n}return Object(l.a)(a,[{key:"render",value:function(){return s.a.createElement(ie,{title:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443",cancel:this.props.cancel,success:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443",onSubmit:this.submit},s.a.createElement("div",{style:{width:"500px",padding:"0 10px"}},s.a.createElement(g,{fields:{name:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0433\u0440\u0443\u043f\u043f\u044b"},style:{width:"400px",margin:"0 auto"},onChange:this.onChange,error:this.state.errors.name},s.a.createElement(D.a,{size:"1.5em"})),s.a.createElement(k,{title:"\u0422\u0438\u043f",fields:{public:"\u041f\u0443\u0431\u043b\u0438\u0447\u043d\u0430\u044f",private:"\u0417\u0430\u043a\u0440\u044b\u0442\u0430\u044f"},style:{width:"260px",margin:"20px auto"},value:"public",onChange:this.changeSegment})))}}]),a}(s.a.Component);function Re(e){var t=Object(n.useState)(null),a=Object(p.a)(t,2),r=a[0],o=a[1],i=e.net.token;Object(n.useEffect)((function(){fetch("/get-group/"+e.link,{method:"GET",headers:{token:i}}).then((function(e){return e.json()})).then((function(e){e.error&&console.error(e),o(e)}))}),[e.link,i]);var l=e.link;return null!==r&&(l=r.name),s.a.createElement(oe,{title:l,cancel:e.cancel,success:"\u0412\u0441\u0442\u0443\u043f\u0438\u0442\u044c",disabled:null===r,className:"group-info"},null!==r&&s.a.createElement("div",{style:{width:"400px",textAlign:"center"}},s.a.createElement(b,{className:"transparent more"},r.userCount+" "+ye(r.userCount,"\u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a","\u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430","\u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432"),r.users>6&&s.a.createElement(C.a,{size:"1.5em"})),s.a.createElement("div",{style:{margin:"3px 0"}},r.users.map((function(e){return s.a.createElement($,{profile:e,key:e.login,size:"50"})}))),r.my?s.a.createElement("div",{className:"modal-buttons-vertical"},s.a.createElement(E,{to:"/"+e.link,className:"transparent"},"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f\u043c"),s.a.createElement(E,{to:"/"+e.link+"/c"},"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u043a\u043e\u043d\u0444\u0435\u0440\u0435\u043d\u0446\u0438\u0438"),s.a.createElement(b,{onClick:e.cancel,className:"transparent"},"\u041d\u0430\u0437\u0430\u0434")):s.a.createElement("div",{className:"modal-buttons"},s.a.createElement(b,{className:"transparent",onClick:e.cancel},"\u041e\u0442\u043c\u0435\u043d\u0430"),s.a.createElement(b,{onClick:function(){fetch("/join-group",{method:"POST",headers:{token:i,"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({group:e.link})}).then((function(e){return e.json()})).then((function(t){t.error?(console.error(t.error),e.onError()):e.onSuccess(t)}))}},"\u0412\u0441\u0442\u0443\u043f\u0438\u0442\u044c"))))}var Te=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).onSearch=function(e){var t=e.search;n.setState({filter:t})},n.onSuccess=function(e){n.props.history.push("/c"),n.setState({myGroups:[e].concat(Object(h.a)(n.state.myGroups))}),n.alert('\u041a\u043e\u043c\u043d\u0430\u0442\u0430 "'.concat(e.name,'" \u0441\u043e\u0437\u0434\u0430\u043d\u0430'))},n.onClickRow=function(e){n.props.history.push("/c/"+e.link)},n.successJoinToRoom=function(e){n.props.history.push("/c"),n.alert('\u0412\u044b \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u0432 \u0433\u0440\u0443\u043f\u043f\u0443 "'.concat(e.name,'"')),n.setState({myGroups:[e].concat(Object(h.a)(n.state.myGroups))});for(var t=n.state.otherGroups,a=0;a<t.length;a++)if(t[a].link===e.link){n.setState({otherGroup:t.slice(0,a).concat(t.slice(a+1))});break}},n.alert=function(e){setTimeout((function(){return n.alertRef.current.alert(e)}),250)},n.alertRef=s.a.createRef(),n.state={redirect:!1,myGroups:null,otherGroups:null,filter:""},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("/get-groups",{method:"GET",headers:{token:this.props.net.token}}).then((function(e){return e.json()})).then((function(t){t.errors?console.error(t.errors):e.setState({myGroups:t.myGroups,otherGroups:t.otherGroups})}))}},{key:"render",value:function(){var e=this,t=function(t){return null==t?null:"add"===t.params.room?s.a.createElement(Se,{cancel:function(){return e.props.history.push("/c")},net:e.props.net,success:e.onSuccess}):s.a.createElement(Re,{net:e.props.net,link:t.params.room,cancel:function(){return e.props.history.push("/c")},onSuccess:e.successJoinToRoom,onError:function(){return e.alert("\u041f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u043a \u043a\u043e\u043c\u043d\u0430\u0442\u0435 \u0432\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430")}})};return s.a.createElement(S,{delay:2e3,ref:this.alertRef},s.a.createElement(M.b,{exact:!0,path:"/c/:room"},(function(a){var n=a.match;return s.a.createElement(le,{modal:t(n)},s.a.createElement("header",{className:"main-header",style:{justifyContent:"space-between"}},s.a.createElement("h1",null,"\u0413\u0440\u0443\u043f\u043f\u044b"),s.a.createElement("div",{className:"search-div",style:{flexGrow:"2",textAlign:"center"}},s.a.createElement(g,{fields:{search:"\u041f\u043e\u0438\u0441\u043a \u0433\u0440\u0443\u043f\u043f..."},style:{width:"400px",display:"inline-flex"},onChange:e.onSearch},s.a.createElement(C.f,{size:"1.5em"}))),s.a.createElement(E,{className:"transparent",style:{width:"150px"},to:"/c/add"},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443")),s.a.createElement("main",{className:"conferences"},e.state.myGroups&&e.state.myGroups.length>-1&&s.a.createElement(Me,{onClickRow:e.onClickRow,title:"\u0413\u0440\u0443\u043f\u043f\u044b \u0441 \u0432\u0430\u043c\u0438",groups:e.state.myGroups,filter:e.state.filter}),e.state.otherGroups&&e.state.otherGroups.length>-1&&s.a.createElement(Me,{onClickRow:e.onClickRow,title:"\u041f\u0440\u043e\u0447\u0438\u0435 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0435 \u0433\u0440\u0443\u043f\u043f\u044b",groups:e.state.otherGroups,filter:e.state.filter})))})))}}]),a}(s.a.Component);function Me(e){var t=e.groups;if(e.filter&&""!==e.filter){var a=new RegExp(e.filter,"iu");t=t.filter((function(e){return a.test(e.name)||a.test(e.admin.name+" "+e.admin.surname)}))}return s.a.createElement("div",null,s.a.createElement("h3",null,e.title," ",s.a.createElement("span",{className:"count"},"(".concat(t.length,")"))),s.a.createElement("table",{className:"group-table"},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null),s.a.createElement("th",{className:"td-title"},"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"),s.a.createElement("th",null,"\u0412\u0441\u0435\u0433\u043e \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432"),s.a.createElement("th",null,"\u041d\u0430\u0447\u0430\u043b\u043e \u043a\u043e\u043d\u0444\u0435\u0440\u0435\u043d\u0446\u0438\u0438"),s.a.createElement("th",null,"\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0442\u043e\u0440"),s.a.createElement("th",null))),s.a.createElement("tbody",null,t.map((function(t){return s.a.createElement("tr",{className:"tr-group",key:t.link,onClick:function(){return e.onClickRow(t)}},s.a.createElement("td",{className:"group-icon"},s.a.createElement($,{src:t.icon,name:t.name,size:"35",className:"group"})),s.a.createElement("td",{className:"td-title"},t.name),s.a.createElement("td",null,t.userCount),s.a.createElement("td",null),s.a.createElement("td",null,t.admin.name+" "+t.admin.surname),s.a.createElement("td",{className:"group-more"},s.a.createElement(b,{className:"transparent more-button"},s.a.createElement(C.e,{size:"1.4em"}))))})))))}function Pe(e){return s.a.createElement("div",null,s.a.createElement("header",{className:"main-header"},s.a.createElement("h1",null,"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438")),s.a.createElement(b,{onClick:function(){e.net.emitter.emit("logout")}},"\u0412\u044b\u0439\u0442\u0438 \u0438\u0437 \u043f\u0440\u043e\u0444\u0438\u043b\u044f"))}function ze(){return(ze=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Ie(e,t){if(null==e)return{};var a,n,s=function(e,t){if(null==e)return{};var a,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(s[a]=e[a]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}var De=s.a.createElement("path",{d:"M15.7843 0.75C19.3092 0.75 22.6898 2.13281 25.1823 4.59422C27.6748 7.05564 29.0751 10.394 29.0751 13.875C29.0751 17.356 27.6748 20.6944 25.1823 23.1558C22.6898 25.6172 19.3092 27 15.7843 27C12.2593 27 8.87873 25.6172 6.38622 23.1558C3.8937 20.6944 2.49342 17.356 2.49342 13.875C2.49342 10.394 3.8937 7.05564 6.38622 4.59422C8.87873 2.13281 12.2593 0.75 15.7843 0.75ZM15.7843 4.5C13.2664 4.5 10.8517 5.48772 9.07137 7.24587C7.291 9.00403 6.2908 11.3886 6.2908 13.875C6.2908 16.3614 7.291 18.746 9.07137 20.5041C10.8517 22.2623 13.2664 23.25 15.7843 23.25C17.031 23.25 18.2655 23.0075 19.4173 22.5364C20.5691 22.0652 21.6156 21.3747 22.4972 20.5041C23.3787 19.6336 24.078 18.6001 24.5551 17.4627C25.0322 16.3252 25.2777 15.1061 25.2777 13.875C25.2777 11.3886 24.2775 9.00403 22.4972 7.24587C20.7168 5.48772 18.3021 4.5 15.7843 4.5ZM15.7843 8.25C17.295 8.25 18.7438 8.84263 19.812 9.89753C20.8802 10.9524 21.4803 12.3832 21.4803 13.875C21.4803 15.3668 20.8802 16.7976 19.812 17.8525C18.7438 18.9074 17.295 19.5 15.7843 19.5C14.2736 19.5 12.8248 18.9074 11.7565 17.8525C10.6883 16.7976 10.0882 15.3668 10.0882 13.875C10.0882 12.3832 10.6883 10.9524 11.7565 9.89753C12.8248 8.84263 14.2736 8.25 15.7843 8.25ZM4.39211 38.25C3.38498 38.25 2.4191 37.8549 1.70695 37.1517C0.994807 36.4484 0.594727 35.4946 0.594727 34.5C0.594727 33.7875 0.784596 33.1313 1.14535 32.5688L4.60097 26.6438C7.70867 29.2939 11.6782 30.7514 15.7843 30.75C20.0563 30.75 23.9676 29.1938 26.9676 26.6438L30.4232 32.5688C30.7839 33.1313 30.9738 33.7875 30.9738 34.5C30.9738 35.4946 30.5737 36.4484 29.8616 37.1517C29.1494 37.8549 28.1835 38.25 27.1764 38.25H4.39211Z",fill:"currentColor"}),Le=function(e){var t=e.svgRef,a=e.title,n=Ie(e,["svgRef","title"]);return s.a.createElement("svg",ze({width:31,height:39,viewBox:"0 0 31 39",fill:"none",ref:t},n),a?s.a.createElement("title",null,a):null,De)},Be=s.a.forwardRef((function(e,t){return s.a.createElement(Le,ze({svgRef:t},e))})),Fe=(a.p,function(e){var t=Object(n.useRef)(null);Object(n.useEffect)((function(){e.srcObject&&(t.current.srcObject=e.srcObject)}),[e.srcObject]);var a=Object(L.a)({},e);return delete a.srcObject,s.a.createElement("div",Object.assign({className:"video-wrapper"},a),s.a.createElement("video",{ref:t,autoPlay:!0,muted:!0}),e.children)}),Ge=function(){function e(t){var a=t.offer,n=t.ice;Object(i.a)(this,e),this.ice=n,this.offer=a,this.streams=[],this.connections=new Map}return Object(l.a)(e,[{key:"connect",value:function(){var e=Object(se.a)(ne.a.mark((function e(t,a){var n,s,r,o,i,l;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.video,s=a.audio,n=!0===n&&{height:200},s=!0===s,r=new RTCPeerConnection,e.next=6,navigator.mediaDevices.getUserMedia({video:n,audio:s});case 6:return o=e.sent,i={pc:r,stream:o},t(o),o.getTracks().forEach((function(e){return r.addTrack(e,o)})),e.next=12,r.setRemoteDescription(this.offer);case 12:return e.next=14,r.createAnswer();case 14:return l=e.sent,e.next=17,r.setLocalDescription(l);case 17:return r.addIceCandidate(new RTCIceCandidate(this.ice)),this.connections.set("__sender",i),e.abrupt("return",l);case 20:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"addReciever",value:function(){var e=Object(se.a)(ne.a.mark((function e(t,a){var n,s,r,o,i,l;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.offer,s=t.ice,r=t.user,o=new RTCPeerConnection,i={pc:o,stream:null},o.addEventListener("track",(function(e){console.log(e),e.streams[0]&&e.streams[0]!==i.stream&&(console.log("pc received remote stream"),i.stream=e.streams[0],a(e.streams[0]))})),e.next=6,o.setRemoteDescription(n);case 6:return e.next=8,o.createAnswer();case 8:return l=e.sent,e.next=11,o.setLocalDescription(l);case 11:return o.addIceCandidate(new RTCIceCandidate(s)),this.connections.set(r.login,i),e.abrupt("return",l);case 14:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e,t=Object(I.a)(this.connections.values());try{for(t.s();!(e=t.n()).done;){var a=e.value;a.pc.close(),a.stream.getTracks().forEach((function(e){return e.stop()}))}}catch(n){t.e(n)}finally{t.f()}}},{key:"remove",value:function(e){this.connections.has(e)&&(this.connections.get(e).pc.close(),this.connections.get(e).stream.getTracks().forEach((function(e){return e.stop()})))}}]),e}(),Ae=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).addSender=function(){var e=Object(se.a)(ne.a.mark((function e(t){var a;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.webrtc.addReciever(t,(function(e){return n.addStream(e,Object(L.a)({user:t.user},t.constraints))}));case 2:a=e.sent,n.props.net.socket.send(JSON.stringify({type:"create-receive",token:n.props.net.token,answer:a,sender:t.user.login}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.closeSender=function(e){var t=e.login;console.log("CLOSE SENDER - ",t),n.setState({streams:n.state.streams.filter((function(e){return e.user.login!==t}))}),n.webrtc.remove(t)},n.updateUserCount=function(e){var t=e.userCount,a=Object.assign({},n.state.room,{userCount:t});n.setState({room:a})},n.onError=function(e){var t=e.error;switch(t){case"ExistLogin":n.alertRef.current.alert("\u0412\u0430\u0448 \u043f\u0440\u043e\u0444\u0438\u043b\u044c \u0443\u0436\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0432 \u044d\u0442\u043e\u0439 \u043a\u043e\u043c\u043d\u0430\u0442\u0435 \u0434\u043b\u044f \u0432\u0438\u0434\u0435\u043e\u0441\u0432\u044f\u0437\u0438");break;default:console.error(t)}},n.sendMessage=function(e){if(""!==e.trim()){var t=n.state.messages.length;n.addMessage({bind:n.state.room.link,user:n.props.net.profile,text:e,index:t>0?n.state.messages[t-1].index+1:0,timestamp:Date.now()}),fetch("/write-message",{method:"POST",headers:{token:n.props.net.token,"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({bind:n.state.room.link,text:e})}).then((function(e){return e.json()})).then((function(e){console.log("Sended message")}))}},n.addMessage=function(e){e.bind===n.state.room.link&&(n.messagesRef.current.updateScroll(),n.setState({messages:[].concat(Object(h.a)(n.state.messages),[e])}))},n.scrollMessage=function(e){var t=n.state.messages;fetch("/get-bind/"+n.state.room.link+"?limit=100&last="+t[0].index,{method:"GET",headers:{token:n.props.net.token}}).then((function(e){return e.json()})).then((function(e){e.error?console.log(e.error):(t=e.messages.concat(t),n.setState({messages:t}))}))},n.addStream=function(e,t){var a={user:t.user,video:t.video,audio:t.audio,stream:e};n.setState({streams:[].concat(Object(h.a)(n.state.streams),[a])})},n.activateCamera=Object(se.a)(ne.a.mark((function e(){var t,a,s;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=Object(I.a)(n.state.streams),e.prev=2,t.s();case 4:if((a=t.n()).done){e.next=10;break}if(a.value.user.login!==n.props.net.profile.login){e.next=8;break}throw new Error("ExistLogin");case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:return e.next=20,n.webrtc.connect((function(e){return n.addStream(e,{user:n.props.net.profile,video:!0,audio:!0})}),{video:!0,audio:!0});case 20:s=e.sent,n.props.net.socket.send(JSON.stringify({type:"create-connection",token:n.props.net.token,answer:s})),n.setState({constraints:{video:!0,audio:!0}}),e.next=30;break;case 25:e.prev=25,e.t1=e.catch(0),"NotAllowedError"===e.t1.name&&n.alertRef.current.alert("\u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043d\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0432\u0435\u0431-\u043a\u0430\u043c\u0435\u0440\u044b \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435"),"ExistLogin"===e.t1.message&&n.onError({error:e.t1.message}),console.log(e.t1.message);case 30:case"end":return e.stop()}}),e,null,[[0,25],[2,12,15,18]])}))),n.activateMicrophone=Object(se.a)(ne.a.mark((function e(){var t,a,s,r;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=n.state.constraints).audio=!0,e.prev=2,a=Object(I.a)(n.state.streams),e.prev=4,a.s();case 6:if((s=a.n()).done){e.next=12;break}if(s.value.user.login!==n.props.net.profile.login){e.next=10;break}throw new Error("ExistLogin");case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),a.e(e.t0);case 17:return e.prev=17,a.f(),e.finish(17);case 20:return e.next=22,n.webrtc.connect((function(e){return n.addStream(e,Object(L.a)({user:n.props.net.profile},t))}),t);case 22:r=e.sent,n.props.net.socket.send(JSON.stringify({type:"create-connection",token:n.props.net.token,answer:r})),n.setState({constraints:t}),e.next=32;break;case 27:e.prev=27,e.t1=e.catch(2),"NotAllowedError"===e.t1.name&&n.alertRef.current.alert("\u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043d\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043c\u0438\u043a\u0440\u043e\u0444\u043e\u043d\u0430 \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435"),"ExistLogin"===e.t1.message&&n.onError({error:e.t1.message}),console.log(e.t1);case 32:case"end":return e.stop()}}),e,null,[[2,27],[4,14,17,20]])}))),n.alertRef=s.a.createRef(),n.link=e.match.params.bind,n.state={room:null,messages:null,streams:[],context:null,constraints:{video:!1,audio:!1},highlighted:null},n.messagesRef=s.a.createRef(),n.webrtc=null,n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;console.log("/join-room/"+this.link),fetch("/join-room/"+this.link,{method:"POST",headers:{token:this.props.net.token,"Content-Type":"application/json;charset=utf-8"}}).then((function(e){return e.json()})).then((function(t){if(t.error)console.error(t.error);else{var a=new(window.AudioContext||window.webkitAudioContext);e.webrtc=new Ge(t.default),e.webrtc.context=a;var n,s=Object(I.a)(t.senders);try{for(s.s();!(n=s.n()).done;){var r=n.value;e.addSender(r)}}catch(o){s.e(o)}finally{s.f()}e.setState({messages:t.messages,room:t.room,context:a}),e.props.net.emitter.on("message",e.addMessage),e.props.net.emitter.on("add-sender",e.addSender),e.props.net.emitter.on("close-sender",e.closeSender),e.props.net.emitter.on("update-user-count",e.updateUserCount),e.props.net.emitter.on("room-error",e.onError)}}))}},{key:"componentWillUnmount",value:function(){this.props.net.emitter.off("message",this.addMessage),this.props.net.emitter.off("add-sender",this.addSender),this.props.net.emitter.off("close-sender",this.closeSender),this.props.net.emitter.off("update-user-count",this.updateUserCount),this.props.net.emitter.on("room-error",this.onError),this.webrtc.close(),this.props.net.socket.send(JSON.stringify({type:"leave-room",token:this.props.net.token}))}},{key:"highlightStream",value:function(e){this.setState({highlighted:e})}},{key:"clearHighlightStream",value:function(e){this.state.highlighted===e&&this.setState({highlighted:null})}},{key:"render",value:function(){var e=this,t=this.state.room;return s.a.createElement(S,{delay:2e3,ref:this.alertRef},s.a.createElement("div",{className:"room-main-content"},s.a.createElement("div",{className:"main-column"},s.a.createElement("header",{className:"main-header"},s.a.createElement(E,{title:"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043a \u043f\u0435\u0440\u0435\u043f\u0438\u0441\u043a\u0435",className:"transparent",to:"/"+this.props.match.params.bind,style:{fontWeight:600}},s.a.createElement(x.a,{size:"1.8em"}),"\u041d\u0430\u0437\u0430\u0434"),null!==t&&s.a.createElement("div",{className:"room-header-title"},s.a.createElement("h1",null,t.name),s.a.createElement(b,{className:"transparent user-count"},t.userCount+" "+ye(t.userCount,"\u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a","\u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430","\u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432")),s.a.createElement("span",{className:"room-time"},"0:00"))),null!==this.state.room&&s.a.createElement("div",{className:"micro-block",style:{textAlign:"center"}},this.state.streams.map((function(t){return s.a.createElement(Q,{key:t.user.login,stream:t,context:e.state.context,onMouseEnter:function(){return e.highlightStream(t.user.login)},onMouseLeave:function(){return e.clearHighlightStream(t.user.login)}})})),s.a.createElement("div",{style:{float:"right"}},s.a.createElement(b,{title:this.state.constraints.audio?"\u0412\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043c\u0438\u043a\u0440\u043e\u0444\u043e\u043d":"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043c\u0438\u043a\u0440\u043e\u0444\u043e\u043d",className:"transparent add-micro-button "+(this.state.constraints.audio?"active":"add"),style:{margin:"4px"},onClick:this.activateMicrophone},s.a.createElement(O.c,{size:"1.9em"})),s.a.createElement(b,{title:this.state.constraints.video?"\u0412\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0432\u0435\u0431-\u043a\u0430\u043c\u0435\u0440\u0443":"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0432\u0435\u0431-\u043a\u0430\u043c\u0435\u0440\u0443",className:"transparent add-micro-button "+(this.state.constraints.video?"active":"add"),style:{margin:"4px",marginRight:"0"},onClick:this.activateCamera},s.a.createElement(Be,{style:{height:"2.1em"}}))))),null!==this.state.room&&s.a.createElement("div",{className:"telling-column"},this.state.streams.length>0&&s.a.createElement("div",{className:"webcam-block"},this.state.streams.map((function(t){return!0===t.video?s.a.createElement(Fe,{srcObject:t.stream,key:t.user.login,onMouseEnter:function(){return e.highlightStream(t.user.login)},onMouseLeave:function(){return e.clearHighlightStream(t.user.login)}},s.a.createElement("div",{className:"video-icon "+(t.user.login===e.state.highlighted?"show":"")},s.a.createElement($,{profile:t.user,size:"50"}))):null}))),s.a.createElement(Ne,{net:this.props.net,messages:this.state.messages,bind:this.state.room.link,scrollMessage:this.scrollMessage,ref:this.messagesRef}),s.a.createElement(be,{className:"chat-div",send:this.sendMessage,show:null!==this.state.bind,ref:this.chatRef}))))}}]),a}(s.a.Component),He=function(e){return s.a.createElement("div",null,s.a.createElement("h1",null,"\u0422\u0430\u043a\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"))},We=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).onMessage=function(e){var t=JSON.parse(e.data);n.props.net.emitter.emit(t.type,t.data)},n.state={animActive:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.net.socket&&this.props.net.socket.addEventListener("message",this.onMessage)}},{key:"componentWillUnmount",value:function(){this.props.net.socket&&this.props.net.socket.removeEventListener("message",this.onMessage)}},{key:"render",value:function(){var e=this;if(!this.props.net.socket)return s.a.createElement(M.a,{to:"/auth"});var t=[{path:["/c","/c/:bind","/c/add"],Component:Te},{path:"/"+this.props.net.profile.login,Component:he},{path:"/settings",Component:Pe},{path:"/:bind/c",Component:Ae},{path:["/:bind","/"],Component:xe}];return s.a.createElement("div",{className:"anim up"},s.a.createElement(u.a,null,s.a.createElement(te,{profile:this.props.net.profile}),s.a.createElement(M.d,null,t.map((function(t){var a=t.path,n=t.Component;return s.a.createElement(M.b,{key:"string"===typeof a?a:a[0],exact:!0,path:a,render:function(t){return s.a.createElement(n,Object.assign({},t,{net:e.props.net}))}})})),s.a.createElement(M.b,{component:He}))))}}]),a}(s.a.Component),Ue=a(39),Je=a.n(Ue),Ze=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).update=function(e){var t=Object.assign({},n.state.net.profile,e),a=Object.assign({},n.state.net,{profile:t});console.log(a),n.setState({net:a})},n.login=function(e){fetch("/authorization",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",token:"000000"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){e.success?n.onLogin(e.success):n.setState({auth:null})}))},n.onLogin=function(e){var t=new WebSocket(j),a=Object.assign({},n.state.net,e);a.socket=t,a.emitter=new Je.a,t.onopen=function(){t.send(JSON.stringify({type:"auth",token:e.token}))},t.onclose=function(e){console.log("\u0412\u0435\u0431-\u0441\u043e\u043a\u0435\u0442 \u0437\u0430\u043a\u0440\u044b\u0442. \u041f\u0440\u0438\u0447\u0438\u043d\u0430:",e.reason)},a.emitter.on("logout",(function(){sessionStorage.clear(),localStorage.clear(),n.state.net.socket.close();var e=Object.assign({},n.state.net,{login:null,profile:null,socket:null,token:null,emitter:null});n.setState({net:e})})),sessionStorage.setItem("token",e.token),n.setState({net:a,token:null,auth:null})},n.state={net:{socket:null,token:null,profile:null,login:null,update:n.update}},sessionStorage.getItem("token")&&(n.state.token=sessionStorage.getItem("token")),localStorage.getItem("auth")&&(n.state.auth=JSON.parse(localStorage.getItem("auth"))),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.state.token?fetch("/i-have-token",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",token:this.state.token},body:JSON.stringify({token:this.state.token})}).then((function(e){return e.json()})).then((function(t){if(e.setState({token:null}),t.error)return sessionStorage.removeItem("token"),void(e.state.auth&&e.login(e.state.auth));e.onLogin(t)})):this.state.auth&&this.login(this.state.auth)}},{key:"render",value:function(){var e=this;return this.state.token||this.state.auth?s.a.createElement("div",null):s.a.createElement(u.a,null,s.a.createElement(M.d,null,s.a.createElement(M.b,{path:"/auth",render:function(t){return s.a.createElement(z,{net:e.state.net,onLogin:e.onLogin})}}),s.a.createElement(M.b,{path:"/",render:function(){return s.a.createElement(We,{net:e.state.net})}})))}}]),a}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(Ze,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[41,1,2]]]);
//# sourceMappingURL=main.56981e63.chunk.js.map