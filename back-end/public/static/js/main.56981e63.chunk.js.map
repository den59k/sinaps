{"version":3,"sources":["components/inputs/LoginInputs.jsx","constants.jsx","components/auth/LoginPage.jsx","components/inputs/Alert.jsx","components/auth/RegisterPage.jsx","components/auth/InfoPage.jsx","components/AuthPage.jsx","components/img/micro-icon.svg","components/img/webcam-icon.svg","components/utils.jsx","components/NavigationBar.jsx","components/inputs/Loader.jsx","components/inputs/ModalWindow.jsx","components/main/tools.jsx","components/main/HomePage.jsx","components/inputs/emoji.jsx","components/inputs/Chat.jsx","tools/rus.js","components/main/messages.jsx","components/main/MessagesPage.jsx","components/main/modal-windows.jsx","components/main/ConferencesPage.jsx","components/main/SettingsPage.jsx","components/room/webcam.svg","components/room/video-block.jsx","components/room/webrtc-connection.js","components/room/RoomPage.jsx","components/Page404.jsx","components/MainPage.jsx","App.jsx","serviceWorker.js","index.js"],"names":["InputText","props","key","type","fields","state","this","setState","onChange","className","error","style","children","Object","keys","map","value","e","handleChange","target","placeholder","React","Component","InputCheckbox","checked","isChecked","RippleButton","rippleEffect","rect","currentTarget","getBoundingClientRect","newRipple","left","clientX","size","top","clientY","id","nanoid","timeout","setTimeout","rippleElements","length","slice","forEach","el","clearTimeout","onMouseDown","width","height","RippleA","HorizontalSlider","box","useState","active","setActive","mouseMove","preventDefault","document","addEventListener","removeEventListener","once","SegmentButton","mode","setMode","title","onClick","wsUrl","window","location","host","LoginPage","login","loadingFlag","errors","password","auth","test","fetch","method","headers","body","JSON","stringify","then","response","json","res","assign","success","onLogin","remember","localStorage","setItem","catch","str","onSubmit","marginTop","marginBottom","to","position","backgroundColor","AlertWrapper","message","delay","Fragment","register","mail","name","pass","info","surname","repeatPass","console","log","alertRef","current","alert","createRef","maxWidth","minHeight","ref","marginLeft","margin","url","net","unmount","render","AuthPage","routes","path","RegisterPage","InfoPage","last","myRef","token","basename","exact","match","CSSTransition","in","classNames","unmountOnExit","_extends","i","arguments","source","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","createElement","d","fill","stroke","strokeWidth","_ref","svgRef","viewBox","ForwardRef","forwardRef","Icon","src","profile","icon","cn","alt","text","lineHeight","fontSize","BindIcon","online","MicroIcon","useEffect","stream","context","createMediaStreamSource","analyser","createAnalyser","fftSize","connect","gain","createGain","destination","setGainNode","dataArray","Uint8Array","interval","setInterval","getByteTimeDomainData","sum","Math","abs","_level","min","level","setLevel","clearInterval","muted","setMuted","gainNode","_props","user","border","display","video","audio","right","Title","pos","NavigationBar","showTitle","titleTimeout","pageXOffset","pageYOffset","getAttribute","hideTitle","link","description","show","_link","r","onMouseEnter","onMouseLeave","Loader","viewport","cx","cy","ModalWindowBase","bkgClick","cancel","bkgClassName","modalClassName","disabled","ModalWindow","cancelTo","marginRight","fontWeight","ModalWindowWrapper","fixedBody","modal","openWindow","prevProps","prevState","scrollTo","closeWindow","ProfileImage","showImageTools","showPopup","hideImageTools","loadPhoto","files","changePhoto","loadRef","click","accept","Section","time","Promise","rej","ModalImageEditor","imageLoaded","sizeImage","naturalWidth","naturalHeight","minScale","scale","maxScale","movePos","x","y","startMoveImage","lastPos","ev","moveImage","editPosImage","deltaX","deltaY","changeZoom","oldScale","getValue","sqrt","submitPhoto","a","processed","img","imgRef","canvas","getContext","alpha","drawImage","_canvas","antialias","getBuffer","buf1","buf2","remove","modalChangePhoto","photoUrl","toBlob","blob","arrayBuffer","buffer","transformOrigin","transform","onLoad","verticalAlign","HomePage","photo","URL","createObjectURL","wrapper","modalWrapperRef","renderImage","buf","byteLength","set","jres","update","fullIcon","emojiTable","findEmoji","code","j","charCodeAt","ImgEmoji","emoji","substr","CssEmoji","paste","backgroundPosition","Chat","send","ch","p","textInput","firstChild","nodeType","Node","TEXT_NODE","data","tagName","lastChild","checkPlaceholder","keyDown","keyCode","shiftKey","nodeValue","childNodes","originalEvent","clipboardData","getData","pasteText","activeElement","focus","sel","getSelection","selectAllChildren","collapseToEnd","replace","em","substring","execCommand","timer","_showEmojiPanel","buttons","emojiPanel","_hideEmojiPanel","padding","outline","onMouseOver","onMouseOut","EmojiPanel","contentEditable","onInput","onPaste","spellCheck","onKeyDown","setClassName","timerID","content","push","getEmojiRow","numeral","count","one","two","five","getDate","timestamp","onlyDay","Date","nowDate","now","offset","getTimezoneOffset","nowDay","day","getMinutes","getHours","month","StringMonth","getMonth","Message","timeString","nextFlag","lastMessage","lastDay","dateString","MessageBlock","updateMessages","updateFlag","scrollFlag","scrollDown","messagesRef","scrollTop","startTime","performance","startScroll","endScroll","scrollHeight","clientHeight","anim","timeFraction","easeInOut","requestAnimationFrame","fetchingFlag","onScrollMessage","bind","messages","index","scrollMessage","lastScroll","m","flexGrow","onScroll","MessagesPage","onSearch","getNewBind","resp","jresp","binds","getBind","bindIndex","list","readed","forceUpdate","socket","sendMessage","trim","len","addMessage","bindsRef","splice","messageCount","updateScroll","unshift","getStatusBind","isGroup","userCount","concat","chatRef","params","emitter","on","off","flexBasis","flexShrink","search","Bind","suser","author","unread","ModalGroupAdd","roomInfo","changeSegment","submit","public","private","ModalGroup","group","setGroup","textAlign","users","my","onError","onSuccess","ConferencesPage","filter","history","myGroups","onClickRow","successJoinToRoom","otherGroups","otherGroup","redirect","getModal","room","justifyContent","GroupTable","groups","reg","RegExp","admin","SettingsPage","emit","VideoBlock","useRef","srcObject","autoPlay","webrtcConnection","offer","ice","streams","connections","Map","addStream","pc","RTCPeerConnection","navigator","mediaDevices","getUserMedia","connection","getTracks","track","addTrack","setRemoteDescription","createAnswer","answer","setLocalDescription","addIceCandidate","RTCIceCandidate","values","c","close","stop","has","get","RoomPage","addSender","sender","webrtc","addReciever","constraints","closeSender","updateUserCount","_stream","activateCamera","Error","activateMicrophone","highlighted","AudioContext","webkitAudioContext","webrtcSystem","default","senders","highlightStream","clearHighlightStream","float","MainPage","onMessage","obj","parse","animActive","component","Page404","App","u","WebSocket","EventEmitter","onopen","onclose","reason","sessionStorage","clear","_net","getItem","removeItem","Boolean","hostname","ReactDOM","StrictMode","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.56981e63.chunk.js","sourcesContent":["import React, { useState } from 'react'\r\nimport {nanoid} from 'nanoid'\r\nimport { Link } from 'react-router-dom'\r\n\r\n\r\nexport class InputText extends React.Component {\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n  \tthis.type = props.type || \"text\"\r\n  \tthis.fields = this.props.fields;\r\n  \t\r\n  \tthis.state = {};\r\n  \tfor(let key in this.fields)\r\n  \t\tthis.state[key] = '';\r\n\r\n\t}\r\n\r\n\thandleChange(state) {   \r\n\t\tthis.setState(state);\r\n\t\tthis.props.onChange(state);\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className={'input-text'+(this.props.error?' error':'')} style={this.props.style}>\r\n\t\t\t\t{this.props.children}\r\n\t\t\t\t{Object.keys(this.fields).map(key => <input type={this.type} value={this.state[key]} \r\n\t\t\t\t\tonChange={e => this.handleChange({ [key]: e.target.value })} key={key} placeholder={this.fields[key]}/>)}\r\n\t\t\t\t{this.props.error && <div className=\"error-label\">{this.props.error}</div>}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\nexport class InputCheckbox extends React.Component {\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tconst checked = this.props.isChecked || true;\r\n\t\tthis.state = {value: checked};\r\n\t}\r\n\r\n\thandleChange = e => {    \r\n\t\tthis.setState({value: e.target.checked});  \r\n\t\tthis.props.onChange(e.target.checked);\r\n\r\n\t}\r\n\r\n\trender(){\r\n\t\treturn (\r\n\t\t\t<label className=\"input-checkbox\" {...this.props} >\r\n\t\t\t\t<input type=\"checkbox\" checked={this.state.value} onChange={this.handleChange}/>\r\n\t\t\t\t<span className=\"box-checkbox\"></span>\r\n\t\t\t\t<span>{this.props.children}</span>\r\n\t\t\t</label>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport class RippleButton extends React.Component {\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tthis.state = { rippleElements: [] }\r\n\t\tthis.size = props.size || 100;\r\n\r\n\t\tthis.style = this.props.style || {};\r\n\t}\r\n\r\n\trippleEffect = (e) => {\r\n\t\tconst rect = e.currentTarget.getBoundingClientRect();\r\n\r\n\t\tconst newRipple = {\r\n\t\t\tleft: e.clientX - rect.left - this.size/2, top: e.clientY - rect.top - this.size/2, \r\n\t\t\tid: nanoid(4), \r\n\t\t\tsize: this.size\r\n\t\t}\r\n\r\n\t\tnewRipple.timeout = setTimeout(() => {\r\n\t\t\tif(this.state.rippleElements.length > 1)\r\n\t\t\t\tthis.setState({rippleElements: this.state.rippleElements.slice(1)});\r\n\t\t\telse\r\n\t\t\t\tthis.setState({rippleElements: []});\r\n\t\t}, 1000);\r\n\r\n\t\tthis.setState({rippleElements: [...this.state.rippleElements, newRipple]});\r\n\t}\r\n\r\n\tcomponentWillUnmount(){\r\n\t\tthis.state.rippleElements.forEach(el => {\r\n\t\t\tclearTimeout(el.timeout);\r\n\t\t});\r\n\t}\r\n\r\n\trender(){\r\n\t\tconst className = this.props.className || '';\r\n\t\treturn (\r\n\t\t\t<button  {...this.props} \r\n\t\t\t\tclassName={'my-button '+className} \r\n\t\t\t\tonMouseDown={this.rippleEffect} >\r\n\t\t\t\t{this.props.children}\r\n\t\t\t\t{this.state.rippleElements.map((el) => <div className=\"ripple-effect\" \r\n\t\t\t\t\tstyle={{top: el.top, left: el.left, width: el.size+'px', height: el.size+'px'}} \r\n\t\t\t\t\tkey={el.id}></div> ) }\r\n\t\t\t</button>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport class RippleA extends RippleButton {\r\n\r\n\trender(){\r\n\t\tconst className = this.props.className || '';\r\n\t\treturn (\r\n\t\t\t<Link \r\n\t\t\t\t{...this.props} \r\n\t\t\t\tclassName={'my-button clear '+className} \r\n\t\t\t\tonMouseDown={this.rippleEffect} >\r\n\t\t\t\t{this.props.children}\r\n\t\t\t\t{this.state.rippleElements.map((el) => <div className=\"ripple-effect\" \r\n\t\t\t\t\tstyle={{top: el.top, left: el.left, width: el.size+'px', height: el.size+'px'}} \r\n\t\t\t\t\tkey={el.id}></div> ) }\r\n\t\t\t</Link>\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nexport function HorizontalSlider(props) {\r\n\r\n\tconst [active, setActive] = useState(false);\r\n\tlet box;\r\n\r\n\tconst mouseMove = (e) => {\r\n\t\tlet value = (e.clientX-box.left)/(box.width);\r\n\t\tif(value < 0) value = 0;\r\n\t\tif(value > 1) value = 1;\r\n\t\tif(props.onChange)\r\n\t\t\tprops.onChange(value);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className={'slider' + (active?' active':'')} {...props}\r\n\t\t\tonMouseDown={(e) => { \r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tbox = e.currentTarget.getBoundingClientRect();\r\n\t\t\t\tsetActive(true);\r\n\t\t\t\tmouseMove(e);\r\n\t\t\t\tdocument.addEventListener('mouseup', () => {\r\n\t\t\t\t\tsetActive(false)\r\n\t\t\t\t\tdocument.removeEventListener('mousemove', mouseMove);\r\n\t\t\t\t},{ once: true });\r\n\t\t\t\tdocument.addEventListener('mousemove', mouseMove);\r\n\t\t\t}}>\r\n\t\t\t<div className=\"slider-line\"></div>\r\n\t\t\t<div className=\"slider-line on\" style={{left: 0, width: (props.value*100)+'%'}}></div>\r\n\t\t\t<div className=\"slider-point\" style={{left: (props.value*100)+'%'}}></div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport function SegmentButton(props) {\r\n\r\n\tconst keys = Object.keys(props.fields);\r\n\r\n\tconst [mode, setMode] = useState(props.value || '');\r\n\r\n\treturn (\r\n\t\t<div style={props.style} className={'segment-wrapper '+props.className}>\r\n\t\t\t<div className=\"segment-title\">{props.title}</div>\r\n\t\t\t<div className=\"segment-button\">\r\n\t\t\t\t{keys.map(key => (\r\n\t\t\t\t\t<button className={(key === mode)?'active':''} \r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tsetMode(key);\r\n\t\t\t\t\t\tif(props.onChange)\r\n\t\t\t\t\t\t\tprops.onChange(key);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t key={key}>{props.fields[key]}</button>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n\r\n}","/*export const url = 'http://192.168.1.35'\r\nexport const dbUrl = 'http://192.168.1.35'\r\nexport const wsUrl = 'ws://192.168.1.35'*/\r\n\r\nexport const url = ''\r\nexport const dbUrl = ''\r\nexport const wsUrl = 'wss://'+window.location.host","import React from 'react'\r\nimport {Link} from 'react-router-dom';\r\nimport { InputText, InputCheckbox, RippleButton } from './../inputs/LoginInputs.jsx'\r\nimport { MdMailOutline } from 'react-icons/md'\r\nimport { FaKey, FaVk, FaGoogle} from 'react-icons/fa'\r\nimport { url } from './../../constants.jsx'\r\n\r\nclass LoginPage extends React.Component {\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tthis.loadingFlag = false;\r\n\t\tthis.remember = true;\r\n\r\n\t\tthis.auth = {login: '', password: ''};\r\n\t\tthis.state = {errors: {login: null, password: null}}\r\n\t}\r\n\r\n\tlogin = (e) => {\r\n\t\te.preventDefault();\r\n\t\tif(this.loadingFlag)\r\n\t\t\treturn;\r\n\r\n\t\tconst errors = {login: null, password: null};\r\n\t\tif(this.auth.login === '')\r\n\t\t\terrors.login = 'Поле \"E-mail\" должно быть заполнено';\r\n\r\n\t\tconst reg = /^([A-Za-z0-9_\\-.])+@([A-Za-z0-9_\\-.])+.([A-Za-z]{2,4})$/;\r\n\t\tif(reg.test(this.auth.login) === false)\r\n\t\t\terrors.login = 'Нет такого email, и быть не может';\r\n\r\n\t\tif(this.auth.password === '')\r\n\t\t\terrors.password = 'Поле \"Пароль\" должно быть заполнено';\r\n\r\n\t\tthis.setState({errors});\r\n\r\n\t\tfor(let key in errors)\r\n\t\t\tif(errors[key] !== null)\r\n\t\t\t\treturn;\r\n\r\n\t\tthis.loadingFlag = true;\r\n\r\n\t\tfetch(url+'/authorization', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json;charset=utf-8',\r\n\t\t\t\t'token': '000000'\r\n\t  \t},\r\n\t\t\tbody: JSON.stringify(this.auth) })\r\n\t\t.then(response => response.json())\r\n\t\t.then(res => {\r\n\t\t\tthis.loadingFlag = false;\r\n\t\t\tif(res.errors){\r\n\t\t\t\tObject.assign(errors, res.errors);\r\n\t\t\t\tthis.setState({errors});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif(res.success){\r\n\t\t\t\tthis.props.onLogin(res.success);\r\n\r\n\t\t\t\tif(this.remember){\r\n\t\t\t\t\tlocalStorage.setItem('auth', JSON.stringify(this.auth));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(e => { this.loadingFlag = false });\r\n\t}\r\n\r\n\r\n\tonChange = str => {\r\n\t\tObject.assign(this.auth, str);\r\n\t\tconst errors = Object.assign({}, this.state.errors);\r\n\r\n\t\tfor(let key in str)\r\n\t\t\tswitch(key){\r\n\t\t\t\tcase 'login': errors.login = null; break;\r\n\t\t\t\tcase 'password': errors.password = null; break;\r\n\t\t\t\tdefault: \r\n\t\t\t}\r\n\t\tthis.setState({errors});\r\n\t}\r\n\r\n\trender() {\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"login-page anim up\">\r\n\t\t\t\t<div className=\"login-column\">\r\n\t\t\t\t\t<form className=\"login-form\" onSubmit={this.login}>\r\n\t\t\t\t\t\t<h1>Вход в систему</h1>\r\n\t\t\t\t\t\t<InputText fields={{login: \"E-mail\"}} type=\"text\" onChange={this.onChange} \r\n\t\t\t\t\t\t\terror={this.state.errors.login}>\r\n\t\t\t\t\t\t\t<MdMailOutline size=\"1.6em\"/>\r\n\t\t\t\t\t\t</InputText>\r\n\t\t\t\t\t\t<InputText fields={{password: \"Пароль\"}} type=\"password\" onChange={this.onChange}\r\n\t\t\t\t\t\t\terror={this.state.errors.password}>\r\n\t\t\t\t\t\t\t<FaKey size=\"1.3em\"/>\r\n\t\t\t\t\t\t</InputText>\r\n\t\t\t\t\t\t<div className=\"form-flex\">\r\n\t\t\t\t\t\t\t<InputCheckbox onChange={(str) => this.remember = str}>Запомнить меня</InputCheckbox>\r\n\t\t\t\t\t\t\t<RippleButton>ВОЙТИ</RippleButton>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</form>\r\n\r\n\t\t\t\t\t<p style={{marginTop: '22px', marginBottom: '13px'}}>Еще не получили доступ к видеолекциям?</p>\r\n\t\t\t\t\t<Link to=\"/register\" className=\"center-button\">Создать аккаунт</Link>\r\n\r\n\t\t\t\t\t<hr style={{marginTop: '40px'}}/>\r\n\t\t\t\t\t<span className=\"podpis\" style={{position: 'relative', top: '-19px'}}>или</span>\r\n\r\n\t\t\t\t\t<RippleButton className=\"social-media-button\" style={{backgroundColor: '#4A76A8', marginBottom: '12px'}} size={200}>\r\n\t\t\t\t\t\t<FaVk/>\r\n\t\t\t\t\t\tВойти через ВК\r\n\t\t\t\t\t</RippleButton>\r\n\t\t\t\t\t<RippleButton className=\"social-media-button\" style={{backgroundColor: '#F44235'}} size={200}>\r\n\t\t\t\t\t\t<FaGoogle/>\r\n\t\t\t\t\t\tВойти через Google\r\n\t\t\t\t\t</RippleButton>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"login-label\" style={{marginBottom: '200px'}}>\r\n\t\t\t\t\t<p>Дистанционное обучение - <span className=\"orange\">это просто</span></p>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nexport default LoginPage;","import React from 'react'\r\n\r\nexport class AlertWrapper extends React.Component {\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tthis.state = {className: '', message: null}\r\n\t\tthis.delay = this.props.delay || 2000;\r\n\t\tthis.timeout = -1;\r\n\t}\r\n\r\n\talert(message){\r\n\t\tif(this.timeout)\r\n\t\t\tclearTimeout(this.timeout);\r\n\t\tthis.setState({message});\r\n\t\tthis.timeout = setTimeout(() => this.setState({className: 'alert-active'}), 50);\r\n\t\tthis.timeout = setTimeout(() => {\r\n\t\t\tthis.setState({className: 'alert-exit'});\r\n\t\t\tthis.timeout = setTimeout(() => {\r\n\t\t\t\tthis.setState({message: null});\r\n\t\t\t\tthis.timeout = -1;\r\n\t\t\t}, 500); \r\n\t\t}, this.delay);\r\n\t}\r\n\r\n\tcomponentWillUnmount(){\r\n\t\tif(this.timeout >= 0){\r\n\t\t\tclearTimeout(this.timeout);\r\n\t\t\tthis.timeout = -1;\r\n\t\t}\r\n\t}\r\n\r\n\trender(){\r\n\t\treturn (\r\n\t\t<React.Fragment>\r\n\t\t\t{this.props.children}\r\n\t\t\t<div className=\"alert-wrapper\">\r\n\t\t\t\t{this.state.message && (\r\n\t\t\t\t\t<div className={'alert '+this.state.className}>\r\n\t\t\t\t\t\t{this.state.message}\r\n\t\t\t\t\t</div>\t\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</React.Fragment>\r\n\t\t);\r\n\t}\r\n\r\n}","import React from 'react'\r\nimport {Link} from 'react-router-dom';\r\nimport { InputText, InputCheckbox, RippleButton } from './../inputs/LoginInputs.jsx'\r\nimport { MdMailOutline } from 'react-icons/md'\r\nimport { IoIosArrowBack } from 'react-icons/io'\r\nimport { FaKey } from 'react-icons/fa'\r\nimport { RiAccountCircleLine } from 'react-icons/ri'\r\nimport { url } from './../../constants.jsx'\r\nimport { AlertWrapper } from './../inputs/Alert.jsx'\r\n\r\nclass LoginPage extends React.Component {\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tthis.loadingFlag = false;\r\n\r\n\t\tthis.info = {mail: '', name: '', surname: '', pass: '', repeatPass: ''};\r\n\r\n\t\tthis.state = {errors: {mail: null, name: null, pass: null}};\r\n\r\n\t\tthis.alertRef = React.createRef();\r\n\t}\r\n\r\n\tregister = (e) => {\r\n\t\te.preventDefault();\r\n\t\tif(this.loadingFlag)\r\n\t\t\treturn;\r\n\r\n\t\tconst errors = {mail: null, name: null, pass: null};\r\n\r\n\t\tconst reg = /^([A-Za-z0-9_\\-.])+@([A-Za-z0-9_\\-.])+.([A-Za-z]{2,4})$/;\r\n\t\tif(reg.test(this.info.mail) === false)\r\n\t\t\terrors.mail = 'Нет такого email, и быть не может';\r\n\r\n\t\tif(this.info.mail === '')\r\n\t\t\terrors.mail = 'Поле \"Email\" должно быть заполнено';\r\n\r\n\t\tif(this.info.surname === '')\r\n\t\t\terrors.name = 'Поле \"Фамилия\" должно быть заполнено';\r\n\r\n\t\tif(this.info.name === '')\r\n\t\t\terrors.name = 'Поле \"Имя\" должно быть заполнено';\r\n\r\n\t\tif(this.info.repeatPass !== this.info.pass)\r\n\t\t\terrors.pass = 'Пароли не совпадают';\r\n\r\n\t\tif(this.info.pass.length < 3)\r\n\t\t\terrors.pass = 'Дляна пароля должна быть от 3 символов';\r\n\r\n\t\tif(this.info.pass === '')\r\n\t\t\terrors.pass = 'Поля \"Пароль\" должно быть заполнено';\r\n\r\n\r\n\t\tthis.setState({errors});\r\n\r\n\t\tfor(let key in errors)\r\n\t\t\tif(errors[key] !== null)\r\n\t\t\t\treturn;\r\n\r\n\t\t//this.loadingFlag = true;\r\n\r\n\t\tfetch(url+'/registration', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json;charset=utf-8',\r\n\t\t\t\t'token': '000000'\r\n\t  \t},\r\n\t\t\tbody: JSON.stringify(this.info) })\r\n\t\t.then(response => response.json())\r\n\t\t.then(res => {\r\n\t\t\tthis.loadingFlag = false;\r\n\t\t\tif(res.errors){\r\n\t\t\t\tObject.assign(errors, res.errors);\r\n\t\t\t\tthis.setState({errors});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif(res.success){\r\n\t\t\t\tconsole.log('success');\r\n\t\t\t\tthis.alertRef.current.alert('Аккаунт успешно создан. Вернитесь назад, чтобы войти');\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tonChange = str => {\r\n\t\tObject.assign(this.info, str);\r\n\t\tconst errors = Object.assign({}, this.state.errors);\r\n\t\tfor(let key in str)\r\n\t\t\tswitch(key){\r\n\t\t\t\tcase 'mail': errors.mail = null; break;\r\n\t\t\t\tcase 'name':\r\n\t\t\t\tcase 'surname': errors.name = null; break;\r\n\t\t\t\tcase 'pass':\r\n\t\t\t\tcase 'repeatPass': errors.pass = null; break;\r\n\t\t\t\tdefault: \r\n\t\t\t}\r\n\t\tthis.setState({errors});\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"login-page anim down\" style={{maxWidth: '900px', minHeight: '90vh'}}>\r\n\t\t\t\t<AlertWrapper delay={3000} ref={this.alertRef}>\r\n\t\t\t\t<div className=\"login-label\" style={{marginLeft: '0', height: '330px'}}>\r\n\t\t\t\t\t<Link className=\"toBack\" to=\"/\"><IoIosArrowBack size=\"1.8em\"/>Вход в аккаунт</Link>\r\n\t\t\t\t\t<p>Уже 85 человек получили доступ к видеолекциям.{' '}\r\n\t\t\t\t\t\t<span className=\"orange\">\r\n\t\t\t\t\t\t\tПрисоединяйтесь и вы.\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"login-column\">\r\n\t\t\t\t\t<form className=\"login-form register-form\" onSubmit={this.register}>\r\n\t\t\t\t\t\t<h1>Создание аккаунта</h1>\r\n\t\t\t\t\t\t<div className=\"form-flex\">\r\n\t\t\t\t\t\t\t<InputText \terror={this.state.errors.mail} fields={{mail: \"E-mail\"}} type=\"text\" \r\n\t\t\t\t\t\t\t\t\t\tonChange={this.onChange}>\r\n\t\t\t\t\t\t\t\t<MdMailOutline size=\"1.6em\"/>\r\n\t\t\t\t\t\t\t</InputText>\r\n\t\t\t\t\t\t\t<InputCheckbox style={{margin: '12px 22px'}} onChange={(str) => this.remember = str}>\r\n\t\t\t\t\t\t\t\tПолучать уведомления\r\n\t\t\t\t\t\t\t</InputCheckbox>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<InputText \tfields={{name: 'Имя', surname: 'Фамилия'}} type=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\tonChange={this.onChange} error={this.state.errors.name}>\r\n\t\t\t\t\t\t\t<RiAccountCircleLine size=\"1.6em\"/>\r\n\t\t\t\t\t\t</InputText>\r\n\t\t\t\t\t\t<InputText  fields={{pass: 'Пароль', repeatPass: 'Повтор пароля'}} type=\"password\"\r\n\t\t\t\t\t\t\t\t\t\t\tonChange={this.onChange} error={this.state.errors.pass}>\r\n\t\t\t\t\t\t\t<FaKey size=\"1.3em\"/>\r\n\t\t\t\t\t\t</InputText>\r\n\t\t\t\t\t\t<div className=\"last-button\">\r\n\t\t\t\t\t\t\t<RippleButton>ПРОДОЛЖИТЬ</RippleButton>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t</div>\r\n\t\t\t\t</AlertWrapper>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nexport default LoginPage;","import React from 'react'\r\nimport {Link} from 'react-router-dom';\r\nimport { InputText, InputCheckbox, RippleButton } from './../inputs/LoginInputs.jsx'\r\nimport { MdMailOutline } from 'react-icons/md'\r\nimport { FaKey, FaVk, FaGoogle} from 'react-icons/fa'\r\n\r\nclass LoginPage extends React.Component {\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tthis.loadingFlag = false;\r\n\t\tthis.url = props.net.url;\r\n\r\n\t\tthis.auth = {login: '', password: ''};\r\n\t}\r\n\r\n\tlogin = (e) => {\r\n\t\te.preventDefault();\r\n\t\tif(this.loadingFlag)\r\n\t\t\treturn;\r\n\t\tthis.loadingFlag = true;\r\n\r\n\t\tfetch(this.url+'/authorization', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json;charset=utf-8'\r\n\t  \t},\r\n\t\t\tbody: JSON.stringify(this.auth) })\r\n\t\t.then(response => response.json())\r\n\t\t.then(res => {\r\n\t\t\tconsole.log(res);\r\n\t\t\tthis.loadingFlag = false;\r\n\t\t});\r\n\t}\r\n\r\n\tcomponentWillUnmount(){\r\n\t\tthis.props.unmount(this.render());\r\n\t}\r\n\r\n\trender() {\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"login-page anim\">\r\n\t\t\t\t<div className=\"login-column\">\r\n\t\t\t\t\t<form className=\"login-form\" onSubmit={this.login}>\r\n\t\t\t\t\t\t<h1>Вход в систему</h1>\r\n\t\t\t\t\t\t<InputText placeholder=\"E-mail\" type=\"text\" onChange={(str) => this.auth.login = str}>\r\n\t\t\t\t\t\t\t<MdMailOutline size=\"1.6em\"/>\r\n\t\t\t\t\t\t</InputText>\r\n\t\t\t\t\t\t<InputText placeholder=\"Пароль\" type=\"password\" onChange={(str) => this.auth.password = str}>\r\n\t\t\t\t\t\t\t<FaKey size=\"1.3em\"/>\r\n\t\t\t\t\t\t</InputText>\r\n\t\t\t\t\t\t<div className=\"form-flex\">\r\n\t\t\t\t\t\t\t<InputCheckbox onChange={(str) => this.remember = str}>Запомнить меня</InputCheckbox>\r\n\t\t\t\t\t\t\t<RippleButton>ВОЙТИ</RippleButton>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</form>\r\n\r\n\t\t\t\t\t<p style={{marginTop: '22px', marginBottom: '13px'}}>Еще не получили доступ к видеолекциям?</p>\r\n\t\t\t\t\t<Link to=\"/auth/register\" className=\"center-button\">Создать аккаунт</Link>\r\n\r\n\t\t\t\t\t<hr style={{marginTop: '40px'}}/>\r\n\t\t\t\t\t<span className=\"podpis\" style={{position: 'relative', top: '-19px'}}>или</span>\r\n\r\n\t\t\t\t\t<RippleButton className=\"social-media-button\" style={{backgroundColor: '#4A76A8', marginBottom: '12px'}} size={200}>\r\n\t\t\t\t\t\t<FaVk/>\r\n\t\t\t\t\t\tВойти через ВК\r\n\t\t\t\t\t</RippleButton>\r\n\t\t\t\t\t<RippleButton className=\"social-media-button\" style={{backgroundColor: '#F44235'}} size={200}>\r\n\t\t\t\t\t\t<FaGoogle/>\r\n\t\t\t\t\t\tВойти через Google\r\n\t\t\t\t\t</RippleButton>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"login-label\" style={{marginBottom: '200px'}}>\r\n\t\t\t\t\t<p>Дистанционное обучение - <span className=\"orange\">это просто</span></p>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nexport default LoginPage;","import React from 'react'\r\nimport \"./../css/login-page.sass\"\r\nimport LoginPage from './auth/LoginPage.jsx'\r\nimport RegisterPage from './auth/RegisterPage.jsx'\r\nimport InfoPage from './auth/InfoPage.jsx'\r\nimport { BrowserRouter, Route, Redirect } from 'react-router-dom';\r\nimport { CSSTransition } from 'react-transition-group';\r\n\r\nclass AuthPage extends React.Component {\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tthis.state = {last: null, className:''};\r\n\t\tthis.myRef = React.createRef();\r\n\t}\r\n\r\n\tunmount = (e, key) => {\r\n\r\n\t}\r\n\r\n\troutes = [\r\n\t\t{ path: '/', Component: LoginPage},\r\n\t\t{ path: '/register', Component: RegisterPage },\r\n\t\t{ path: '/info', Component: InfoPage }\r\n\t]\r\n\r\n\trender() {\r\n\t\tif(this.props.net.token) return (<Redirect to='/'/>);\r\n\t\treturn (\r\n\t\t\t<div className='page login-main-page'>\r\n\t\t\t\t<BrowserRouter basename=\"/auth\">\r\n\t\t\t\t\t{this.routes.map(({path, Component}) => (\r\n\t\t\t\t\t\t<Route key={path} exact path={path}>\r\n\t\t\t\t\t\t\t{({match}) => (\r\n\t\t\t\t\t\t\t\t<CSSTransition\r\n\t\t\t\t\t\t\t\t\tin={match != null}\r\n\t\t\t\t\t\t\t\t\ttimeout={500}\r\n\t\t\t\t\t\t\t\t\tclassNames=\"changes\"\r\n\t\t\t\t\t\t\t\t\tunmountOnExit\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<div className=\"animBlock\">\r\n\t\t\t\t\t\t\t\t\t\t<Component net={this.props.net} onLogin={this.props.onLogin}/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</CSSTransition>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</Route>\r\n\t\t\t\t\t\t))}\r\n\r\n\t      </BrowserRouter>\r\n\t      <div className=\"fixed-logo\">\r\n\t      </div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nexport default AuthPage;","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M7.65426 10.5V14.3462C7.36149 14.2511 7.05073 14.2 6.73133 14.2H5.75702C4.16208 14.2 2.78271 15.4733 2.78271 17.15V19.5345C2.78271 24.1656 5.28416 28.4551 9.17628 30.7267C8.28018 31.2241 7.65426 32.1705 7.65426 33.3001V34.25C7.65426 35.9268 9.03362 37.2001 10.6286 37.2001H20.3716C21.9666 37.2001 23.346 35.9268 23.346 34.25V33.3001C23.346 32.1942 22.746 31.2639 21.88 30.7586C25.6525 28.6105 28.2175 24.6153 28.2175 20V17.15C28.2175 15.4733 26.8381 14.2 25.2432 14.2H24.2689C23.9495 14.2 23.6387 14.2511 23.346 14.3462V10.5C23.346 6.20008 19.7854 2.80005 15.5001 2.80005C11.2149 2.80005 7.65426 6.20008 7.65426 10.5Z\",\n  fill: \"white\",\n  stroke: \"white\",\n  strokeWidth: 4\n});\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M15.5001 25.7001C18.7287 25.7001 21.346 23.1481 21.346 20V10.5C21.346 7.35199 18.7287 4.80005 15.5001 4.80005C12.2715 4.80005 9.65426 7.35199 9.65426 10.5V20C9.65426 23.1481 12.2715 25.7001 15.5001 25.7001ZM25.2432 16.2H24.2689C23.7306 16.2 23.2946 16.6252 23.2946 17.15V20C23.2946 24.4413 19.3675 28.005 14.7213 27.5632C10.6718 27.1779 7.70564 23.6285 7.70564 19.6616V17.15C7.70564 16.6252 7.26964 16.2 6.73133 16.2H5.75702C5.21872 16.2 4.78271 16.6252 4.78271 17.15V19.5345C4.78271 24.8569 8.67812 29.6016 14.0386 30.3224V32.35H10.6286C10.0903 32.35 9.65426 32.7752 9.65426 33.3001V34.25C9.65426 34.7749 10.0903 35.2001 10.6286 35.2001H20.3716C20.91 35.2001 21.346 34.7749 21.346 34.25V33.3001C21.346 32.7752 20.91 32.35 20.3716 32.35H16.9616V30.345C22.1808 29.6467 26.2175 25.2785 26.2175 20V17.15C26.2175 16.6252 25.7815 16.2 25.2432 16.2Z\",\n  fill: \"#FF5C00\"\n});\n\nvar SvgMicroIcon = function SvgMicroIcon(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 31,\n    height: 40,\n    viewBox: \"0 0 31 40\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _ref2, _ref3);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgMicroIcon, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/micro-icon.3c4b07f5.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M26.5965 22.3165C28.4206 20.1168 29.4375 17.3651 29.4375 14.5C29.4375 11.1578 28.0538 7.96993 25.619 5.6326C23.1871 3.29795 19.9055 2 16.5 2C13.0945 2 9.81289 3.29795 7.38096 5.6326C4.94625 7.96993 3.5625 11.1578 3.5625 14.5C3.5625 17.3651 4.57939 20.1168 6.40353 22.3165L5.58185 23.6861L2.75714 28.3943C2.2542 29.1739 2 30.0695 2 31C2 32.353 2.56065 33.6333 3.53023 34.5641C4.49703 35.4922 5.79151 36 7.125 36H25.875C27.2085 36 28.503 35.4922 29.4698 34.5641C30.4394 33.6333 31 32.353 31 31C31 30.0695 30.7458 29.1739 30.2428 28.3943L27.4181 23.6861L26.5965 22.3165Z\",\n  fill: \"white\",\n  stroke: \"white\",\n  strokeWidth: 4\n});\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M16.5 4C19.4008 4 22.1828 5.10625 24.234 7.07538C26.2852 9.04451 27.4375 11.7152 27.4375 14.5C27.4375 17.2848 26.2852 19.9555 24.234 21.9246C22.1828 23.8938 19.4008 25 16.5 25C13.5992 25 10.8172 23.8938 8.76602 21.9246C6.71484 19.9555 5.5625 17.2848 5.5625 14.5C5.5625 11.7152 6.71484 9.04451 8.76602 7.07538C10.8172 5.10625 13.5992 4 16.5 4ZM16.5 7C14.428 7 12.4409 7.79018 10.9757 9.1967C9.5106 10.6032 8.6875 12.5109 8.6875 14.5C8.6875 16.4891 9.5106 18.3968 10.9757 19.8033C12.4409 21.2098 14.428 22 16.5 22C17.526 22 18.5419 21.806 19.4897 21.4291C20.4376 21.0522 21.2988 20.4997 22.0243 19.8033C22.7497 19.1069 23.3252 18.2801 23.7178 17.3701C24.1104 16.4602 24.3125 15.4849 24.3125 14.5C24.3125 12.5109 23.4894 10.6032 22.0243 9.1967C20.5591 7.79018 18.572 7 16.5 7ZM16.5 10C17.7432 10 18.9355 10.4741 19.8146 11.318C20.6936 12.1619 21.1875 13.3065 21.1875 14.5C21.1875 15.6935 20.6936 16.8381 19.8146 17.682C18.9355 18.5259 17.7432 19 16.5 19C15.2568 19 14.0645 18.5259 13.1854 17.682C12.3064 16.8381 11.8125 15.6935 11.8125 14.5C11.8125 13.3065 12.3064 12.1619 13.1854 11.318C14.0645 10.4741 15.2568 10 16.5 10ZM7.125 34C6.2962 34 5.50134 33.6839 4.91529 33.1213C4.32924 32.5587 4 31.7956 4 31C4 30.43 4.15625 29.905 4.45312 29.455L7.29688 24.715C9.85431 26.8351 13.121 28.0011 16.5 28C20.0156 28 23.2344 26.755 25.7031 24.715L28.5469 29.455C28.8437 29.905 29 30.43 29 31C29 31.7956 28.6708 32.5587 28.0847 33.1213C27.4987 33.6839 26.7038 34 25.875 34H7.125Z\",\n  fill: \"#FF5C00\"\n});\n\nvar SvgWebcamIcon = function SvgWebcamIcon(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 33,\n    height: 38,\n    viewBox: \"0 0 33 38\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _ref2, _ref3);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgWebcamIcon, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/webcam-icon.f42ebc50.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useEffect, useState } from 'react'\r\nimport { dbUrl } from './../constants.jsx'\r\nimport cn from 'classnames'\r\n\r\nimport { FaVolumeMute } from 'react-icons/fa'\r\nimport { ReactComponent as MicroSVG } from './img/micro-icon.svg'\r\nimport { ReactComponent as WebcamSVG } from './img/webcam-icon.svg'\r\n\r\nexport function Icon(props) {\r\n\tconst size = props.size || 40;\r\n\r\n\tlet src = props.src?(dbUrl+props.src):null;\r\n\tlet name = props.name;\r\n\r\n\tif(props.profile){\r\n\t\tname = props.profile.name + ' '+props.profile.surname;\r\n\t\tsrc = props.profile.icon?(dbUrl+props.profile.icon):null;\r\n\t}\r\n\r\n\tif(src){\r\n\t\treturn <img className={cn(\"icon\")} src={src} alt={name} title={name}\r\n\t\t\t\t\t\tstyle={{width: size+'px', height: size+'px', ...props.style}}/>\r\n\t}else{\r\n\t\tconst text = name[0];\r\n\t\treturn <div style={{\r\n\t\t\twidth: size+'px', \r\n\t\t\theight: size+'px',\t\t\r\n\t\t\tlineHeight: (size-2)+'px', \r\n\t\t\tfontSize: (size/2)+'px',\r\n\t\t\t...props.style\r\n\t\t}} className={cn(\"icon-empty icon\", props.className)} title={name}>{text}</div>\r\n\t}\r\n}\r\n\r\nexport function BindIcon(props){\r\n\tconst size = props.size || 40;\r\n\treturn <div className=\"icon-wrapper\" style={{height: size+'px'}}>\r\n\t\t<Icon {...props}/>\r\n\t\t{(props.online===true) && <div className=\"mini-icon\"></div>}\r\n\t</div>\r\n}\r\n\r\nexport function MicroIcon(props){\r\n\r\n\tuseEffect(() => {\r\n\t\tif(props.stream.stream){\r\n\t\t\tconst context = props.context;\r\n\r\n\t\t\tconst source = context.createMediaStreamSource(props.stream.stream);\r\n\t\t\tconst analyser = context.createAnalyser();\r\n\r\n\t\t\tanalyser.fftSize = 64;\r\n\t\t\tsource.connect(analyser);\r\n\r\n\t\t\tconst gain = context.createGain();\r\n\r\n\t\t\tanalyser.connect(gain);\r\n\t\t\tgain.connect(context.destination);\r\n\r\n\t\t\tsetGainNode(gain);\r\n\r\n\t\t\tconst dataArray = new Uint8Array(analyser.fftSize);\r\n\r\n\t\t\tconst interval = setInterval(() => {\r\n\t\t\t\tanalyser.getByteTimeDomainData(dataArray);\r\n\t\t\t\tlet sum = 0;\r\n\t\t\t\tfor(let i = 4; i < analyser.fftSize-4; i++)\r\n\t\t\t\t\tsum += Math.abs(dataArray[i]-128);\r\n\t\t\t\t\r\n\t\t\t\tlet _level = sum/(analyser.fftSize-8);\r\n\t\t\t\t_level = Math.min(_level/8|0, 4)\r\n\t\t\t\tif(_level !== level)\r\n\t\t\t\t\tsetLevel(_level);\r\n\r\n\t\t\t}, 300);\r\n\r\n\t\t\treturn (() => clearInterval(interval));\r\n\t\t}\r\n\t}, [props.stream]);\r\n\r\n\tconst [muted, setMuted] = useState(false);\r\n\tconst [gainNode, setGainNode] = useState(null);\r\n\tconst [level, setLevel] = useState(0);\r\n\r\n\tconst mute = () => {\r\n\t\tif(muted === true){\r\n\t\t\tsetMuted(false);\r\n\t\t\tgainNode.gain.value = 1;\r\n\t\t}else{\r\n\t\t\tsetMuted(true);\r\n\t\t\tgainNode.gain.value = 0;\r\n\t\t}\r\n\t}\r\n\r\n\tconst _props = {...props, profile: props.stream.user};\r\n\tdelete _props.stream;\r\n\tdelete _props.context;\r\n\r\n\t_props.style = {border: `${level}px solid #FF5C00`, margin: (4-level)+'px'};\r\n\r\n\treturn(\r\n\t<div {..._props} \r\n\t\tstyle={{display: 'inline-block'}} \r\n\t\tclassName=\"icon-wrapper\"\r\n\t\tonClick={mute}>\r\n\t\t<Icon size=\"60\" {..._props}/>\r\n\t\t{ props.stream.video && <WebcamSVG \r\n\t\t\tclassName=\"sub-icon\" \r\n\t\t\tstyle={{left: '-5px'}} \r\n\t\t\ttitle=\"Использует веб-камеру\"/>}\r\n\t\t{ props.stream.audio && <MicroSVG \r\n\t\t\tclassName=\"sub-icon\" \r\n\t\t\tstyle={{right: '-5px'}} \r\n\t\t\ttitle=\"Использует микрофон\"/>}\r\n\t\t{ muted && <div className='volume-stats'><FaVolumeMute/></div>}\r\n\t</div>\r\n\t);\r\n}\r\n\r\nexport function Title(props){\r\n\treturn <div className=\"title\" style={props.pos?props.pos: {display:'none'} }>{props.text}</div>\r\n}","import React from 'react'\r\nimport { Route, Link } from 'react-router-dom'\r\n\r\nimport { TiGroup } from 'react-icons/ti'\r\nimport { MdSettings, MdMessage } from 'react-icons/md'\r\n\r\nimport { Icon, Title } from './utils.jsx';\r\n\r\nclass NavigationBar extends React.Component {\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {title: null, className: 'enter'}\r\n\t}\r\n\r\n\tshowTitle = (e) => {\r\n\t\tconst target = e.currentTarget;\r\n\t\tthis.titleTimeout = setTimeout(() => {\r\n\t\t\tvar box = target.getBoundingClientRect();\r\n\t\t\tconst left = box.right + window.pageXOffset;\r\n\t\t\tconst top = box.top+box.height/2 + window.pageYOffset;\r\n\t\t\tthis.setState({title: {pos: {left, top}, text: target.getAttribute('alt')}});\r\n\t\t}, 600);\r\n\t}\r\n\r\n\tcomponentDidMount(){\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.setState({className: this.state.className+' enter-active'});\r\n\t\t}, 200);\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.setState({className: ''});\r\n\t\t}, 500);\r\n\t}\r\n\r\n\thideTitle = (e) => {\r\n\t\tthis.setState({title: null});\r\n\t\tclearTimeout(this.titleTimeout);\r\n\t}\r\n\r\n\trender() {\r\n\t\t\r\n\t\tconst routes = [\r\n\t\t\t{ link: '/'+this.props.profile.login, description: this.props.profile.name,\r\n\t\t\t\t Component: <Icon className=\"hover-opacity\" profile={this.props.profile}/> },\r\n\t\t\t{ link: '/c', description: 'Группы',\r\n\t\t\t\tComponent: <TiGroup size=\"1.2em\"/> },\r\n\t\t\t{ link: '/', description: 'Сообщения',\r\n\t\t\t\tComponent: <MdMessage/> },\r\n\t\t\t{ link: '/settings', description: 'Настройки',\r\n\t\t\t\tComponent: <MdSettings/> }\r\n\t\t];\r\n\r\n\t\treturn (\r\n\t\t\t<nav className={\"nav-bar \" + this.state.className}>\r\n\t\t\t\t<Title {...this.state.title} show={this.state.title !== null}/>\r\n\t\t\t\t<div className=\"nav-tools\">\r\n\t\t\t\t\t\t<Route path={\"/:page\"} >\r\n\t\t\t\t\t\t{({match} ) => {\r\n\t\t\t\t\t\t\tlet _link = '/';\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif(match !== null)\r\n\t\t\t\t\t\t\t\tfor(let r of routes)\r\n\t\t\t\t\t\t\t\t\tif(r.link === match.url){\r\n\t\t\t\t\t\t\t\t\t\t_link = r.link;\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\treturn routes.map(({link, Component, description}) => (\r\n\t\t\t\t\t\t\t<Link className={'nav-link' + (_link===link?' active':'')} \r\n\t\t\t\t\t\t\t\t\t\tkey={link}\r\n\t\t\t\t\t\t\t\t\t\tto={link} \r\n\t\t\t\t\t\t\t\t\t\tonMouseEnter={this.showTitle} \r\n\t\t\t\t\t\t\t\t\t\tonMouseLeave={this.hideTitle} \r\n\t\t\t\t\t\t\t\t\t\tonClick={this.hideTitle} \r\n\t\t\t\t\t\t\t\t\t\talt={description}>\r\n\t\t\t\t\t\t\t\t<div className=\"spline\"/>\r\n\t\t\t\t\t\t\t\t{Component}\r\n\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t))}}\r\n\t\t\t\t\t\t</Route>\r\n\t\t\t\t</div>\r\n\t\t\t</nav>\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nexport default NavigationBar;","import React from 'react'\r\n\r\nexport default function Loader (props){ \r\n\tconst size = props.size || 50;\r\n\treturn <svg width={size} height={size} viewport=\"0 0 50 50\" viewBox=\"0 0 50 50\" className=\"loader\"\r\n\tstroke=\"currentColor\">\r\n\t<circle cx=\"25\" cy=\"25\" r=\"15\" strokeWidth=\"3\" fill=\"none\"/>\r\n</svg>;\r\n}","import React from 'react'\r\nimport {RippleButton, RippleA} from './LoginInputs.jsx'\r\nimport Loader from './Loader.jsx'\r\nimport cn from 'classnames'\r\n\r\nexport class ModalWindowBase extends React.Component {\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state={bkgClassName: ' enter', modalClassName: ' enter'}\r\n\t}\r\n\r\n\tbkgClick = (e) => {\r\n\t\tif(e.target === e.currentTarget){\r\n\t\t\tif(this.props.cancel)\r\n\t\t\t\tthis.props.cancel();\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidMount(){\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.setState({bkgClassName: ' enter-active', modalClassName: ' enter-active'})\r\n\t\t}, 50);\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.setState({bkgClassName: '', modalClassName: ''})\r\n\t\t}, 400);\r\n\t}\r\n\r\n\trender() {\r\n\r\n\r\n\t\treturn (\r\n\t\t\t<div className={'modal-window-bkg' + this.state.bkgClassName} onMouseDown={this.bkgClick}>\r\n\t\t\t\t<div className={cn('modal-window', this.state.modalClassName, this.props.className)}>\r\n\t\t\t\t\t{this.props.disabled && <div className=\"disabled-fill\"><Loader size=\"70\"/></div>}\r\n\t\t\t\t\t<h3 className=\"modal-title\">{this.props.title}</h3>\r\n\t\t\t\t\t{this.props.children}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport function ModalWindow(props){\r\n\treturn (\r\n\t\t<ModalWindowBase disabled={props.disabled} title={props.title} cancel={props.cancel}>\r\n\t\t\t{props.children}\r\n\t\t\t<div className=\"modal-buttons\">\r\n\t\t\t\t{props.cancelTo && <RippleA style={{marginRight: '10px', fontWeight: '600'}} \r\n\t\t\t\t\tclassName=\"transparent\" to={props.cancelTo}>Отмена</RippleA>}\r\n\t\t\t\t{props.cancel && <RippleButton style={{marginRight: '10px', fontWeight: '600'}} \r\n\t\t\t\t\tclassName=\"transparent\" onClick={props.cancel}>Отмена</RippleButton>}\r\n\t\t\t\t<RippleButton style={{}} onClick={props.onSubmit}>{props.success?props.success:'Сохранить'}</RippleButton>\r\n\t\t\t</div>\r\n\t\t</ModalWindowBase>\r\n\t);\r\n}\r\n\r\nexport class ModalWindowWrapper extends React.Component {\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tthis.state = {fixedBody: null, modal: null}\r\n\t\tthis.ref = React.createRef();\r\n\t}\r\n\r\n\topenWindow(modal){\r\n\r\n\t\tthis.setState({fixedBody: {top: -window.pageYOffset, left: -window.pageXOffset}, modal});\r\n\t}\r\n\r\n\tcloseWindow(){\r\n\t\tthis.setState({fixedBody: null, modal: null});\r\n\t}\r\n\r\n\tcomponentDidMount(){\r\n\t\tif(this.props.modal)\r\n\t\t\tthis.openWindow(this.props.modal);\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps, prevState){\r\n\t\tif(this.state.fixedBody === null && prevState.fixedBody !== null){\r\n\t\t\twindow.scrollTo(-prevState.fixedBody.left, -prevState.fixedBody.top);\r\n\t\t}\r\n\r\n\t\tif(!prevProps.modal && this.props.modal)\r\n\t\t\tthis.openWindow(this.props.modal);\r\n\t\t\r\n\t\tif(prevProps.modal && !this.props.modal)\r\n\t\t\tthis.closeWindow();\r\n\t}\r\n\r\n\trender(){\r\n\t\treturn (\r\n\t\t<React.Fragment>\r\n\t\t\t<div ref={this.ref} style={this.state.fixedBody?{...this.state.fixedBody, position: 'fixed', right: '0'}:{}}>\r\n\t\t\t\t{this.props.children}\r\n\t\t\t</div>\r\n\t\t\t{this.state.modal}\r\n\t\t</React.Fragment>\r\n\t\t);\r\n\t}\r\n\r\n}","import React from 'react'\r\nimport { MdFileUpload, MdZoomOut, MdZoomIn } from 'react-icons/md'\r\nimport { ModalWindow } from './../inputs/ModalWindow.jsx'\r\nimport { HorizontalSlider } from './../inputs/LoginInputs.jsx'\r\nimport Loader from './../inputs/Loader.jsx'\r\nimport { dbUrl } from './../../constants.jsx'\r\n\r\nexport class ProfileImage extends React.Component {\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tthis.loadRef = React.createRef();\r\n\t\tthis.state = {showPopup: ''}\r\n\t}\r\n\r\n\tshowImageTools = () => {\r\n\t\tthis.setState({showPopup: ' active'});\r\n\t}\r\n\r\n\thideImageTools = () => {\r\n\t\tthis.setState({showPopup: ''});\r\n\t}\r\n\r\n\tloadPhoto = e => {\r\n\t\tif(e.target.files.length > 0){\r\n\t\t\tthis.props.changePhoto(e.target.files[0]);\r\n\t\t}\r\n\t}\r\n\r\n\trender(){\r\n\t\tlet render;\r\n\r\n\t\tif(this.props.src)\r\n\t\t\trender = <img className=\"full-profile-image\" src={dbUrl+this.props.src} alt={this.props.alt} />\r\n\t\telse\r\n\t\t\trender = <div className=\"full-profile-image null-image\" alt={this.props.alt}></div>\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"edit-image\" onClick={() => this.loadRef.current.click()}\r\n \t\t\tonMouseEnter={this.showImageTools} onMouseLeave={this.hideImageTools}>\r\n\t\t\t\t<div className={'popup'+ this.state.showPopup}>\r\n\t\t\t\t\t<MdFileUpload size=\"3em\"/>\r\n\t\t\t\t\t<div className='popup-label'>обновить изображение</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<input type=\"file\" name=\"photo\" style={{display:'none'}} \r\n\t\t\t\tref={this.loadRef} onChange={this.loadPhoto} accept=\"image/png, image/jpeg\"/>\r\n\r\n\t\t\t\t{render}\r\n\t\t\t</div>)\r\n\t}\r\n\r\n}\r\n\r\nexport function Section(props) {\r\n\treturn <section style={props.style} className={props.className}>\r\n\t\t<h3>{props.title}</h3>\r\n\t\t{props.children}\r\n\t</section>\r\n}\r\n\r\nfunction delay(time){\r\n\treturn new Promise((res, rej) => {\r\n\t\tsetTimeout(res, time);\r\n\t});\r\n}\r\n\r\nexport class ModalImageEditor extends React.Component {\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tthis.state = {modalChangePhoto: false, movePos: {x: 0, y: 0}, scale: 0.1, processed: false}\r\n\t\tthis.maxScale = 1\r\n\t\tthis.minScale = 0\r\n\t\tthis.imgRef = React.createRef();\r\n\t}\r\n\r\n\tcomponentDidMount(){\r\n\t\tsetTimeout(() => this.setState({photoUrl: this.props.photoUrl}), 300);\r\n\t}\r\n\r\n\timageLoaded = e => {\r\n\t\tthis.sizeImage = {width: e.target.naturalWidth, height: e.target.naturalHeight};\r\n\t\tthis.minScale = 200/Math.min(this.sizeImage.width, this.sizeImage.height);\r\n\r\n\t\tconst scale = this.minScale+(this.maxScale-this.minScale)*0.1;\r\n\r\n\t\tthis.setState({movePos: {x: (-this.sizeImage.width+200/scale)/2, y: (-this.sizeImage.height+200/scale)/2}, scale });\r\n\t}\r\n\r\n\r\n\tstartMoveImage = e => {\r\n\t\tthis.lastPos = {x: e.clientX, y: e.clientY};\r\n\r\n\t\tdocument.addEventListener('mouseup', ev => {\r\n\t\t\tev.preventDefault();\r\n\t\t\tdocument.removeEventListener('mousemove', this.moveImage);\r\n\t\t}, {once: true});\r\n\r\n\t\tdocument.addEventListener('mousemove', this.moveImage);\r\n\r\n\t\te.preventDefault();\r\n\t}\r\n\r\n\teditPosImage = (deltaX, deltaY, scale) => {\r\n\t\tconst movePos = Object.assign({}, this.state.movePos);\r\n\t\tmovePos.x += deltaX/scale;\r\n\t\tmovePos.y += deltaY/scale;\r\n\r\n\t\tif(movePos.x > 0) movePos.x = 0;\r\n\t\tif(movePos.y > 0) movePos.y = 0;\r\n\t\tif(movePos.x - 200/scale < -this.sizeImage.width)\r\n\t\t\tmovePos.x = -this.sizeImage.width+200/scale\r\n\t\tif(movePos.y - 200/scale < -this.sizeImage.height)\r\n\t\t\tmovePos.y = -this.sizeImage.height+200/scale\r\n\r\n\t\tthis.setState({movePos});\r\n\t}\r\n\r\n\tmoveImage = e => {\r\n\t\tconst deltaX = e.clientX-this.lastPos.x;\r\n\t\tconst deltaY = e.clientY-this.lastPos.y;\r\n\r\n\t\tthis.editPosImage(deltaX, deltaY, this.state.scale);\r\n\r\n\t\tthis.lastPos = {x: e.clientX, y: e.clientY};\r\n\t}\r\n\r\n\tchangeZoom = (value) => {\r\n\t\tif(value < 0) value = 0\r\n\t\tif(value > 1) value = 1\r\n\t\tconst scale = this.minScale+value*value*(this.maxScale-this.minScale);\r\n\t\tconst oldScale = this.state.scale;\r\n\t\tthis.editPosImage(((oldScale-scale)*100)/oldScale, ((oldScale-scale)*100)/oldScale, scale);\r\n\t\tthis.setState({scale});\r\n\t}\r\n\r\n\tgetValue = () => {\r\n\t\treturn Math.sqrt((this.state.scale-this.minScale)/(this.maxScale-this.minScale));\r\n\t}\r\n\r\n\tsubmitPhoto = async () => {\r\n\r\n\t\tthis.setState({processed: true});\r\n\t\tawait delay(200);\r\n\t\tconst pos = {\r\n\t\t\tx: -this.state.movePos.x, \r\n\t\t\ty: -this.state.movePos.y, \r\n\t\t\twidth: 200/this.state.scale, \r\n\t\t\theight: 200/this.state.scale,\r\n\t\t\timg: this.imgRef.current\r\n\t\t}\r\n\r\n\t\tconst canvas = document.createElement('canvas');\r\n\t    canvas.width = 512;\r\n\t    canvas.height = 512;\r\n\t    const ctx = canvas.getContext(\"2d\", {alpha: false});\r\n\t    ctx.drawImage(pos.img, pos.x, pos.y, pos.width, pos.height, 0, 0, 512, 512);\r\n\r\n\t   \tconst _canvas = document.createElement('canvas');\r\n\t   \t_canvas.width = 96;\r\n\t   \t_canvas.height = 96;\r\n\t   \tconst _ctx = _canvas.getContext(\"2d\", {alpha: false, antialias: true});\r\n\t   \t_ctx.drawImage(canvas, 0, 0, 512, 512, 0, 0, 96, 96);\r\n\r\n\t    const buf1 = await this.getBuffer(canvas);\r\n\t    const buf2 = await this.getBuffer(_canvas);\r\n\t    canvas.remove();\r\n\t    _canvas.remove();\r\n\t    this.props.onSubmit(buf1, buf2);\r\n\t}\r\n\r\n\tgetBuffer(canvas){\r\n\t\treturn new Promise((res, rej) => {\r\n\t\t\ttry{\r\n\t\t\t\tcanvas.toBlob(blob => blob.arrayBuffer().then(buffer => res(buffer)), 'image/jpeg', 0.6);\r\n\t\t\t}catch (e){\r\n\t\t\t\trej(e);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\trender(){\r\n\t\treturn (\r\n\t\t<ModalWindow title=\"Фото профиля\" cancel={this.props.cancel} onSubmit={this.submitPhoto} disabled={this.state.processed}>\r\n\t\t\t<div className=\"changePhoto\" style={{width: '500px', height: '300px'}} onMouseDown={this.startMoveImage}>\r\n\t\t\t\t<img src={this.state.photoUrl} alt=\"\"\r\n\t\t\t\tstyle={{transformOrigin: `0 0`,\r\n\t\t\t\t\t\t\t\ttransform: `scale(${this.state.scale}) \r\n\t\t\t\t\t\t\t\ttranslate(${this.state.movePos.x+150/this.state.scale}px, ${this.state.movePos.y+50/this.state.scale}px) `,\r\n\t\t\t\t\t\t\t}}/>\r\n\t\t\t\t<div className=\"black\"></div>\r\n\t\t\t\t<div className=\"changePhoto-photo\" style={{width: '200px', height: '200px', top: '50px', left: '150px'}}>\r\n\t\t\t\t\t<div className=\"loader-wrapper\"><Loader size=\"70\"/></div>\r\n\t\t\t\t\t<img src={this.state.photoUrl} onLoad={this.imageLoaded} alt=\"\" ref={this.imgRef}\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\ttransformOrigin: `0 0`,\r\n\t\t\t\t\t\ttransform: `scale(${this.state.scale}) translate(${this.state.movePos.x}px, ${this.state.movePos.y}px) `,\r\n\t\t\t\t\t}}/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div style={{marginTop: '15px'}} className=\"slider-wrapper\">\r\n\t\t\t\t<div className=\"zoom-icon\" onClick={() => this.changeZoom(this.getValue()-0.1)}><MdZoomOut size=\"1.6em\"/></div>\r\n\t\t\t\t<HorizontalSlider value={this.getValue()} \r\n\t\t\t\t\tonChange={this.changeZoom} \r\n\t\t\t\t\tstyle={{width: '200px', verticalAlign: 'middle'}}/>\r\n\t\t\t\t<div className=\"zoom-icon\" onClick={() => this.changeZoom(this.getValue()+0.1)}><MdZoomIn size=\"1.6em\"/></div>\r\n\t\t\t</div>\r\n\t\t</ModalWindow>\r\n\t\t)\r\n\t}\r\n}\r\n\r\n\r\n","import React from 'react'\r\nimport { Link } from 'react-router-dom'\r\nimport { Section, ProfileImage, ModalImageEditor } from './tools.jsx'\r\nimport { ModalWindowWrapper } from './../inputs/ModalWindow.jsx'\r\nimport { AlertWrapper } from './../inputs/Alert.jsx'\r\nimport { url } from './../../constants'\r\n\r\nclass HomePage extends React.Component {\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tthis.modalWrapperRef = React.createRef();\r\n\t\tthis.alertRef = React.createRef();\r\n\r\n\t\tthis.state = {src: null}\r\n\t\tthis.maxScale = 2;\r\n\t}\r\n\r\n\tchangePhoto = (photo) => {\r\n\t\tconst photoUrl = URL.createObjectURL(photo);\r\n\t\tconst wrapper = this.modalWrapperRef.current;\r\n\t\twrapper.openWindow(\r\n\t\t\t<ModalImageEditor photoUrl={photoUrl} cancel={() => wrapper.closeWindow()} onSubmit={this.renderImage} />\r\n\t\t)\r\n\t}\r\n\r\n\r\n\r\n\trenderImage = async(buf1, buf2) => {\r\n\r\n    //Здесь мы объединяем два изображения в один массив\r\n    const buf = new Uint8Array(buf1.byteLength+buf2.byteLength);\r\n    buf.set(new Uint8Array(buf1), 0);\r\n  \tbuf.set(new Uint8Array(buf2), buf1.byteLength);\r\n\r\n  \t//Как тебе такое, Илон Маск?\r\n    const res = await fetch(url+'/upload-profile-image', {\r\n    \tmethod: 'POST',\r\n      headers: {\r\n        'token': this.props.net.token,\r\n        'full-image': buf1.byteLength,\r\n        'mini-image': buf2.byteLength \r\n      },\r\n      body: buf.buffer\r\n    });\r\n\r\n    const jres = await res.json();\r\n    if(jres.error){\r\n    \tconsole.error(jres);\r\n\t    this.alertRef.current.alert('Произошла ошибка');\r\n    }\r\n    else{\r\n    \tthis.props.net.update(jres);\r\n\t    this.alertRef.current.alert('Изображение успешно обновлено');\r\n    }\r\n    this.modalWrapperRef.current.closeWindow();\r\n\t}\r\n\r\n\r\n\trender() {\r\n\t\tconst profile = this.props.net.profile;\r\n\r\n\t\treturn (\r\n\t\t\t<ModalWindowWrapper ref={this.modalWrapperRef}>\r\n\t\t\t\t<AlertWrapper delay={2000} ref={this.alertRef}>\r\n\t\t\t\t<div className=\"home-page root-block\">\r\n\t\t\t\t\t<header className=\"profile-header\">\r\n\t\t\t\t\t\t<ProfileImage \r\n\t\t\t\t\t\t\tsrc={this.props.net.profile.fullIcon} \r\n\t\t\t\t\t\t\talt={profile.name + ' ' + profile.surname} \r\n\t\t\t\t\t\t\tchangePhoto={this.changePhoto}/>\r\n\t\t\t\t\t\t<div className=\"person-info\">\r\n\t\t\t\t\t\t\t<h1 className=\"person-name\">{profile.name + ' ' + profile.surname}</h1>\r\n\t\t\t\t\t\t\t<h2 className=\"person-group\">студент <Link to={\"/\"}>АСУ 17-1б</Link></h2>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<p className=\"expertition\">Какая-нибудь сильная цитата</p>\r\n\t\t\t\t\t</header>\r\n\r\n\t\t\t\t\t<Section className=\"profile-section\" style={{marginTop: '10px'}} title=\"Доступные конференции\">\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</Section>\r\n\r\n\t\t\t\t</div>\r\n\t\t\t\t</AlertWrapper>\r\n\t\t\t</ModalWindowWrapper>\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nexport default HomePage;","import React from 'react'\r\n\r\nlet emojiTable = [\r\n\t'😄😃😀😊😏😉😍😘😚😗😙😜😝😛😳😬😔😌😒😞😣😢😂😭😪😥😰',\r\n\t'😅😓😩😫😨😱😠😡😤😖😆😋😷😎😴😵😲😟😦😧😈👿😮😬😐😕😯'\r\n];\r\n\r\nexport function findEmoji(code){\r\n\tfor(let i = 0; i < emojiTable.length; i++)\r\n\t\tfor(let j = 0; j < 27; j++){\r\n\t\t\tif(emojiTable[i].charCodeAt(j*2+1) === code)\r\n\t\t\t\treturn i*27+j;\r\n\t\t}\r\n\r\n\treturn -1;\r\n}\r\n\r\nexport function ImgEmoji(emoji){\r\n\t//return <span class='emoji-pattern'></span>\r\n\tlet x = emoji % 27;\r\n\tlet y = emoji/27|0;\r\n\treturn `<img class=\"emoji\" src = \"/static/split/image_${y+1}_${x+1}.png\" alt=\"${emojiTable[y].substr(x*2, 2)}\"/>`\r\n}\r\n\r\nexport function CssEmoji(props){\r\n\r\n\tlet x = props.emoji % 27;\r\n\tlet y = props.emoji/27|0;\r\n\r\n\tlet pos = -x*18 + 'px ' + -y * 18 + 'px';\r\n\r\n\tconst text = emojiTable[Math.min(emojiTable.length-1, y)].substr(x*2, 2);\r\n\r\n\treturn (\r\n\t\t<span className=\"emoji-pattern-wrapper\" \r\n\t\t\t\tonMouseDown={(e) => {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tprops.paste(text);\r\n\t\t\t\t}}>\r\n\t\t\t<span className='emoji-pattern' style={{backgroundPosition: pos}} >{}</span>\r\n\t\t</span>\r\n\t\t);\r\n\r\n}","import React, { useState, useEffect } from 'react'\r\nimport { RippleButton } from './LoginInputs.jsx'\r\nimport { MdSentimentSatisfied, MdSend } from 'react-icons/md'\r\nimport { CssEmoji, ImgEmoji, findEmoji } from './emoji.jsx'\r\n\r\nexport default class Chat extends React.Component{\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.height = props.height || '50';\r\n\t\tthis.lineHeight = props.lineHeight || '25';\r\n\t\tthis.textInput = React.createRef();\r\n\r\n\t\tthis.state = {placeholder: true, emojiPanel: false}\r\n\t}\r\n\r\n\tsend = () => {\r\n\t\tlet p = this.textInput.current;\r\n\t\tlet str = \"\";\r\n\t\tlet ch;\r\n\t\twhile ((ch = p.firstChild) !== null) {\r\n\t\t\tif(ch.nodeType === Node.TEXT_NODE)\r\n\t\t\t\tstr += ch.data;\r\n\t\t\telse{ \r\n\t\t\t\tif(ch.tagName === 'IMG')\r\n\t\t\t\t\tstr += ch.getAttribute('alt');\r\n\t\t\t\tif(ch.tagName === 'BR' && ch !== p.lastChild)\r\n\t\t\t\t\tstr += \"\\n\";\r\n\t\t\t}\r\n\t\t\tch.remove();\r\n\t\t}\r\n\r\n\t\tthis.props.send(str);\r\n\r\n\t\tthis.checkPlaceholder();\r\n\t}\r\n\r\n\tkeyDown = e => {\r\n\t\tif(e.keyCode === 13 && !e.shiftKey){\r\n\t\t\tthis.send();\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t}\r\n\r\n\tcheckPlaceholder = () => {\r\n\t\tconst text = this.textInput.current;\r\n\t\twhile(text.firstChild !== null && \r\n\t\t\t(text.firstChild.tagName === 'BR' || text.firstChild.nodeValue === ' '))\r\n\t\t\ttext.firstChild.remove();\r\n\t\r\n\t\tif(text.childNodes.length > 0 && this.state.placeholder)\r\n\t\t\tthis.setState({placeholder: false});\r\n\r\n\t\tif(text.childNodes.length === 0 && !this.state.placeholder)\r\n\t\t\tthis.setState({placeholder: true});\r\n\t}\r\n\r\n\tpaste = (e) => {\r\n\t\te.preventDefault();\r\n    var text = (e.originalEvent || e).clipboardData.getData('text/plain');\r\n    this.pasteText(text);\r\n\t}\r\n\r\n\tpasteText = (text) => {\r\n\r\n\t\tif(document.activeElement !== this.textInput.current){\r\n\t\t\tthis.textInput.current.focus();\r\n\t\t\tlet sel = document.getSelection();\r\n\t\t\tsel.selectAllChildren(this.textInput.current);\r\n\t\t\tsel.collapseToEnd();\r\n\t\t}\r\n\r\n\t\ttext = text.replace(/\\n/g, '<br/>')\r\n\r\n\t\tif(this.textInput.current.lastChild && this.textInput.current.lastChild.tagName === 'BR')\r\n\t\t\tthis.textInput.current.lastChild.remove();\r\n\t   \t\r\n   for(let i = 0; i < text.length; i++){\t\t\t//Чекнем на иконки\r\n   \t\tlet code = text.charCodeAt(i);\r\n\r\n   \t\tif(code >= 0xD800 && code <= 0xDFFF){\r\n   \t\t\t\r\n   \t\t\tlet em = findEmoji(text.charCodeAt(i+1));\r\n   \t\t\tif(em >= 0){\r\n   \t\t\t\tlet img = ImgEmoji(em);\r\n\t   \t\t\ttext = text.substring(0, i) + img + text.substring(i+2);\r\n\t   \t\t\ti+= img.length - 1;\r\n\t   \t\t}else\r\n\t   \t\t\ti++;\r\n   \t\t\t\r\n   \t\t}\r\n   \t}\r\n\r\n    document.execCommand(\"insertHTML\", false, text);\r\n\t}\r\n\r\n\ttimer = -1;\r\n\t_showEmojiPanel = (e) => {\r\n\t\tif(e.buttons !== 0)\r\n\t\t\treturn;\r\n\t\tif(this.timer > 0){\r\n\t\t\tclearTimeout(this.timer);\r\n\t\t\tthis.timer = -1;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.setState({emojiPanel: true});\r\n\t}\r\n\r\n\t_hideEmojiPanel = () => {\r\n\t\tif(this.timer < 0)\r\n\t\t\tthis.timer = setTimeout(() => {\r\n\t\t\t\tthis.setState({emojiPanel: false});\r\n\t\t\t\tthis.timer = -1;\r\n\t\t\t}, 200);\r\n\t}\r\n\r\n\tfocus = () => {\r\n\t\tthis.textInput.current.focus();\r\n\t}\r\n\t\r\n\trender(){\r\n\t\tconst style = {\r\n\t\t\tlineHeight: this.lineHeight+'px', \r\n\t\t\tpadding: ((this.height-this.lineHeight)/2)+'px 4px', \r\n\t\t\toutline: 'none'};\r\n\r\n\t\treturn (\r\n\t\t\t<div \r\n\t\t\t\tclassName={\"chat \" + this.props.className} \r\n\t\t\t\tstyle={{display: this.props.show?'flex':'none'}}\r\n\t\t\t>\r\n\t\t\t\t<div \r\n\t\t\t\t\tclassName=\"emoji-button\" \r\n\t\t\t\t\tonMouseOver={this._showEmojiPanel} \r\n\t\t\t\t\tonMouseOut={this._hideEmojiPanel} \r\n\t\t\t\t>\r\n\t\t\t\t\t<RippleButton className={'transparent chat-button' + (this.state.emojiPanel?' orange': '')} >\r\n\t\t\t\t\t\t<MdSentimentSatisfied size=\"1.9em\"/>\r\n\t\t\t\t\t</RippleButton>\r\n\t\t\t\t\t<EmojiPanel paste={this.pasteText} show={this.state.emojiPanel}/>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"input\">\r\n\t\t\t\t\t{this.state.placeholder && <div className=\"placeholder\" style={style}>\r\n\t\t\t\t\t\tВведите сообщение...\r\n\t\t\t\t\t</div>}\r\n\t\t\t\t\t<div \tref={this.textInput} \r\n\t\t\t\t\t\t\t\tcontentEditable={true} \r\n\t\t\t\t\t\t\t\tstyle={style} \r\n\t\t\t\t\t\t\t\tonInput={this.checkPlaceholder} \r\n\t\t\t\t\t\t\t\tonPaste={this.paste}\r\n\t\t\t\t\t\t\t\tspellCheck={false}\r\n\t\t\t\t\t\t\t\tonKeyDown={this.keyDown}></div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<RippleButton \r\n\t\t\t\t\tclassName={'transparent chat-button send'+(this.state.placeholder?' closed': '')} \r\n\t\t\t\t\tonClick={this.send}\r\n\t\t\t\t>\r\n\t\t\t\t\t<MdSend size=\"1.9em\" style={{transform: 'translateX(2px)'}}/>\r\n\t\t\t\t</RippleButton>\r\n\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nfunction EmojiPanel (props) {\r\n\r\n\tconst [className, setClassName] = useState(' closed');\r\n\r\n\tuseEffect(() => {\r\n\t\tconst show = props.show;\r\n\r\n\t\tif(show){\r\n\t\t\tsetClassName(' open');\r\n\r\n\t\t\tsetTimeout(() => setClassName(' open-active'), 20);\r\n\t\t}else{\r\n\t\t\tsetClassName(' close-active');\r\n\t\t\tlet timerID = setTimeout(() => setClassName(' closed'), 250);\r\n\t\t\treturn () => {\r\n\t\t\t\tclearTimeout(timerID);\r\n\t\t\t}\r\n\t\t}\r\n\t}, [props.show]);\r\n\r\n\tconst getEmojiRow = () => {\r\n\t\tlet content = []\r\n\t\tfor(let i = 0; i < 189; i++){\r\n\t\t\tcontent.push(<CssEmoji emoji = {i} paste={props.paste} key={i}/>);\r\n\t\t}\r\n\r\n\t\treturn content;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className={'emoji-panel ' + className}>\r\n\t\t\t<div className=\"list-emoji-panel\" style={{top: '7px'}}>\r\n\t\t\t\t{getEmojiRow()}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}","export function StringMonth(month){\r\n\tswitch (month){\r\n\t\tcase 0: return 'января'\r\n\t\tcase 1: return 'февраля'\r\n\t\tcase 2: return 'марта'\r\n\t\tcase 3: return 'апреля'\r\n\t\tcase 4: return 'мая'\r\n\t\tcase 5: return 'июня'\r\n\t\tcase 6: return 'июля'\r\n\t\tcase 7: return 'августа'\r\n\t\tcase 8: return 'сентября'\r\n\t\tcase 9: return 'октября'\r\n\t\tcase 10: return 'ноября'\r\n\t\tcase 11: return 'декабря'\r\n\t\tdefault: return month < 10?('0'+month):month\r\n\t}\r\n}\r\n\r\nexport function numeral(count, one, two, five){\r\n\t//десять-девятнадцать\r\n\tif(count%100/10>>0 === 1)\r\n\t\treturn five;\r\n\t//ноль, пять-девять\r\n\tif(count%10 >= 5 || count%10===0)\r\n\t\treturn five;\r\n\t//один\r\n\tif(count%10 === 1)\r\n\t\treturn one;\r\n\r\n\t//две-четыре\r\n\treturn two;\r\n}\r\n\r\nexport function getDate(timestamp, onlyDay){\r\n\tconst time = new Date(timestamp);\r\n\tconst nowDate = Date.now();\r\n\tconst offset = time.getTimezoneOffset()*60*1000;\r\n\r\n\tconst nowDay = (nowDate-offset)/(24*60*60*1000)>>0;\r\n\r\n\tconst day = (timestamp-offset)/(24*60*60*1000)>>0;\r\n\r\n\tif(nowDay-day === 0){\r\n\t\tif(onlyDay === true)\r\n\t\t\treturn \"сегодня\";\r\n\t\tconst min = time.getMinutes();\r\n\t\treturn time.getHours() + ':'+(min<10?'0'+min:min);\r\n\t}else if(nowDay-day === 1)\r\n\t\treturn 'вчера'\r\n\telse\r\n\t\treturn time.getDate() + ' ' + StringMonth(time.getMonth());\r\n}","import React from 'react'\r\nimport { Icon } from './../utils.jsx';\r\nimport cn from 'classnames'\r\nimport {getDate} from './../../tools/rus.js'\r\nimport easeInOut from 'eases/quad-in-out'\r\n\r\nexport function Message(props){\r\n\r\n\tconst text = props.message.text;\r\n\tconst time = new Date(props.message.timestamp);\r\n\tconst min = time.getMinutes();\r\n\tconst timeString = time.getHours() + ':'+(min<10?'0'+min:min);\r\n\r\n\tlet nextFlag = props.lastMessage && props.lastMessage.user.login === props.message.user.login && \r\n\t\tprops.message.timestamp < props.lastMessage.timestamp+600000;\r\n\r\n\tconst offset = time.getTimezoneOffset()*60*1000;\r\n\tlet lastDay = -1;\r\n\tif(props.lastMessage)\r\n\t\tlastDay = (props.lastMessage.timestamp-offset)/(24*60*60*1000) >> 0;\t//24x60x60x1000\r\n\r\n\tconst day = (props.message.timestamp-offset)/(24*60*60*1000) >> 0;\r\n\tlet dateString = null;\r\n\r\n\tif(day !== lastDay){\r\n\t\tnextFlag = false;\r\n\t\tdateString = getDate(props.message.timestamp, true);\r\n\r\n\t}\r\n\r\n\tif(nextFlag){\r\n\t\treturn (\r\n\t\t\t<div className=\"message-wrapper next\">\r\n\t\t\t\t<div className=\"message\">\r\n\t\t\t\t\t<div className=\"message-text\">\r\n\t\t\t\t\t\t{text}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}else return (\r\n\t\t<div className={cn(\"message-wrapper new\", props.className)}>\r\n\t\t\t{(dateString !== null) && <div className=\"message-date\">{dateString}</div>}\r\n\t\t\t<Icon profile={props.message.user} size=\"45\"/>\r\n\t\t\t<div className=\"message\">\r\n\t\t\t\t<div className=\"message-header\">\r\n\t\t\t\t\t<span className=\"profile-name\">\r\n\t\t\t\t\t\t{props.message.user.name + ' ' + props.message.user.surname}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t\t<span className=\"time\">\r\n\t\t\t\t\t\t{timeString}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"message-text\">\r\n\t\t\t\t\t{text}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t)\r\n}\r\n\r\nexport class MessageBlock extends React.Component{\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tthis.messagesRef = React.createRef();\r\n\t\tthis.lastScroll = -1;\r\n\t\tthis.updateFlag = false;\r\n\t\tthis.loadingFlag = false;\r\n\t\tthis.timeout = null;\r\n\t}\r\n\r\n\tcomponentDidMount(){\r\n\t\tconst el = this.messagesRef.current;\r\n\t\tthis.loadingFlag = true;\r\n\t\tsetTimeout(() => this.loadingFlag = false, 0);\r\n\t\tel.scrollTop = el.scrollHeight;\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps){\r\n\t\tif(prevProps.bind !== this.props.bind || this.updateFlag){\r\n\t\t\tconst el = this.messagesRef.current;\r\n\t\t\tthis.loadingFlag = true;\r\n\t\t\tsetTimeout(() => this.loadingFlag = false, 50);\r\n\t\t\tel.scrollTop = el.scrollHeight;\r\n\t\t\tthis.updateFlag = false;\r\n\t\t}\r\n\r\n\t\tif(this.lastScroll >= 0){\r\n\t\t\tif(this.lastScroll < 20){\r\n\t\t\t\tthis.scrollFlag = -1;\r\n\t\t\t\trequestAnimationFrame(this.scrollDown);\r\n\t\t\t}\r\n\r\n\t\t\tthis.lastScroll = -1;\r\n\t\t}\r\n\t}\r\n\r\n\tupdateMessages = () => {\r\n\t\tthis.updateFlag = true;\r\n\t}\r\n\r\n\t//Это просто анимация появления сообщения\r\n\tscrollFlag = -1;\r\n\tscrollDown = () => {\r\n\t\tthis.scrollFlag = this.messagesRef.current.scrollTop;\r\n\t\tconst startTime = performance.now();\r\n\t\tconst startScroll = this.messagesRef.current.scrollTop;\r\n\t\tconst endScroll = this.messagesRef.current.scrollHeight-this.messagesRef.current.clientHeight;\r\n\r\n\t\tconst anim = time => {\r\n\t\t\tif(this.scrollFlag !== this.messagesRef.current.scrollTop)\r\n\t\t\t\treturn;\r\n\t\t\tlet timeFraction = Math.min((time - startTime) / 140, 1);\r\n\r\n\t\t\ttimeFraction = easeInOut(timeFraction);\r\n\r\n\t\t\tthis.messagesRef.current.scrollTop = (startScroll+(endScroll-startScroll)*timeFraction)>>0;\r\n\t\t\tthis.scrollFlag = this.messagesRef.current.scrollTop;\r\n\t\t\tif(timeFraction < 1)\r\n\t\t\t\trequestAnimationFrame(anim);\r\n\t\t};\r\n\r\n\t\tanim(startTime);\r\n\r\n\t}\r\n\r\n\tfetchingFlag = false\r\n\tonScrollMessage = (e) => {\r\n\t\tif(this.props.bind && \r\n\t\t\t\tthis.messagesRef.current.scrollTop < 500 &&\r\n\t\t\t\tthis.props.messages[0].index > 0 && !this.fetchingFlag && !this.loadingFlag){\r\n\t\t\t\tthis.fetchingFlag = true;\r\n\t\t\t\tsetTimeout(() => this.fetchingFlag = false, 1000);\r\n\t\t\t\tthis.props.scrollMessage();\r\n\t\t\t}\r\n\t}\r\n\r\n\r\n\tupdateScroll(){\r\n\t\tconst m = this.messagesRef.current;\r\n\t\tthis.lastScroll = m.scrollHeight - m.scrollTop - m.clientHeight;\r\n\t}\r\n\r\n\trender(){\r\n\t\treturn (\r\n\t\t\t<div className=\"messages\" style={{flexGrow: 2}} ref={this.messagesRef} \r\n\t\t\t\t\tonScroll={this.onScrollMessage}>\r\n\t\t\t<div className=\"messages-wrapper\">\r\n\t\t\t\t<div>\r\n\t\t\t\t{this.props.messages.map((el, index) => <Message \r\n\t\t\t\t\tkey={el.user.login+el.index} \r\n\t\t\t\t\tclassName={(el.user.login === this.props.net.profile.login) && \"mine\"}\r\n\t\t\t\t\tmessage={el}\r\n\t\t\t\t\tlastMessage={(index > 0)?this.props.messages[index-1]:null}\r\n\t\t\t\t\t/>)\r\n\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t);\r\n\t}\r\n}","import React from 'react'\r\nimport { InputText, RippleA } from './../inputs/LoginInputs.jsx'\r\nimport { MdSearch } from 'react-icons/md'\r\nimport { Icon, BindIcon } from './../utils.jsx';\r\nimport Chat from './../inputs/Chat.jsx'\r\nimport { MessageBlock } from './messages.jsx'\r\nimport { Link } from 'react-router-dom'\r\nimport { url } from './../../constants.jsx'\r\nimport { getDate, numeral } from './../../tools/rus.js'\r\n\r\nclass MessagesPage extends React.Component {\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\r\n\t\tthis.binds = [];\r\n\t\tthis.bind = null;\r\n\t\tthis.chatRef = React.createRef();\r\n\t\tthis.bindsRef = React.createRef();\r\n\t\tthis.messagesRef = React.createRef();\r\n\t\tthis.state = {binds: [], bind: null}\r\n\t}\r\n\r\n\tonSearch = str => {\r\n\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps, prevState){\r\n\t\tif(prevProps.match !== this.props.match){\r\n\t\t\tif(this.props.match.params.bind){\r\n\t\t\t\tif(this.props.match.params.bind !== this.bind){\r\n\t\t\t\t\tthis.getBind(this.props.match.params.bind);\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tthis.setState({profile: null, messages: null});\r\n\t\t\t\tthis.bind = null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t\r\n\t\tif(prevState.bind !== this.state.bind)\r\n\t\t\tthis.chatRef.current.focus();\r\n\t}\r\n\r\n\tcomponentDidMount(){\r\n\r\n\t\tfetch(url+'/get-binds', {\r\n\t\t\tmethod: 'GET',\r\n\t\t\theaders: { token: this.props.net.token },\r\n\t\t}).then(resp => resp.json())\r\n\t\t.then(jresp => {\r\n\t\t\tif(jresp.error){\r\n\t  \t\tconsole.error(jresp.error);\r\n\t  \t\treturn;\r\n\t  \t}\r\n\t  \tthis.setState({ binds: jresp.binds });\r\n\r\n\t\t\tif(this.props.match.params.bind)\r\n\t\t\t\tthis.getBind(this.props.match.params.bind);\r\n\r\n\t\t});\r\n\r\n\t\tthis.props.net.emitter.on('message', this.addMessage);\r\n\t}\r\n\r\n\tcomponentWillUnmount(){\r\n\t\tthis.props.net.emitter.off('message', this.addMessage);\r\n\t}\r\n\r\n\tgetNewBind = str => {\r\n\t\tfetch(url+'/get-bind/'+str+'?limit=1', {\r\n\t\t\tmethod: 'GET',\r\n\t\t\theaders: {\r\n\t\t\t\ttoken: this.props.net.token\r\n\t  \t}\r\n\t\t}).then(resp => resp.json())\r\n\t\t.then(jresp => {\r\n\t\t\tif(!jresp.error)\r\n\t\t\t\tthis.setState({binds: [jresp, ...this.state.binds]});\r\n\t\t});\r\n\t}\r\n\r\n\tgetBind = str => {\r\n\t\tthis.bind = str;\r\n\t\tlet bind = null;\r\n\t\tlet bindIndex = -1;\r\n\r\n\t\t//Так, здесь мы назначаем активную переписку\r\n\t\tfor(let i = 0; i < this.state.binds.length; i++){\r\n\t\t\tbind = this.state.binds[i];\r\n\t\t\tif(bind.link === str){\r\n\t\t\t\tbindIndex = i;\r\n\t\t\t\tthis.setState({bind});\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//Затем, если мы ее не нашли - добавляем\r\n\t\tif(bindIndex < 0){\r\n\t\t\tfetch(url+'/get-bind/'+str+'?limit=50', {\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\theaders: {\r\n\t\t\t\t\ttoken: this.props.net.token\r\n\t\t  \t}\r\n\t\t\t}).then(resp => resp.json())\r\n\t\t\t.then(jresp => {\r\n\t\t\t\tif(!jresp.error)\r\n\t\t\t\t\tthis.setState({binds: [...this.state.binds, jresp], bind: jresp});\r\n\t\t\t});\r\n\t\t}else{\r\n\t\t\t//Если у первого сообщения индекс не нулевой, значит нужно обновить ленту сообщений\r\n\t\t\t//Он при обновлении прочитает сообщения автоматически)\r\n\t\t\tif(bind.messages[0].index > 0 && bind.messages.length < 50){\r\n\t\t\t\tfetch(url+'/get-bind/'+str+'?limit=50&last='+bind.messages[0].index, {\r\n\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\ttoken: this.props.net.token\r\n\t\t\t\t\t}\r\n\t\t\t\t}).then(resp => resp.json())\r\n\t\t\t\t.then(jresp => {\r\n\t\t\t\t\tif(!jresp.error){\r\n\t\t\t\t\t\tthis.messagesRef.current.updateMessages();\r\n\t\t\t\t\t\tjresp.messages.push(...bind.messages);\r\n\t\t\t\t\t\tconst list = [...this.state.binds];\r\n\t\t\t\t\t\tlist[bindIndex] = jresp;\r\n\t\t\t\t\t\tthis.setState({binds: list, bind: jresp});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\t//А иначе прочитать последние сообщения с места\r\n\t\t\t\tif(bind.messages[bind.messages.length-1].user.login !== this.props.net.profile.login){\r\n\t\t\t\t\tbind.readed = bind.messages[bind.messages.length-1].index+1\r\n\t\t\t\t\tthis.forceUpdate(() => {\r\n\t\t\t\t\t\tthis.props.net.socket.send(JSON.stringify({\r\n\t\t\t\t\t\t\ttype: 'readed',\r\n\t\t\t\t\t\t\ttoken: this.props.net.token,\r\n\t\t\t\t\t\t\treaded: bind.messages[bind.messages.length-1].index+1,\r\n\t\t\t\t\t\t\tbind: bind.link\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tsendMessage = (text) => {\r\n\t\tif(this.state.bind === null)\r\n\t\t\treturn;\r\n\t\tif(text.trim() === '')\r\n\t\t\treturn;\r\n\r\n\t\tconst len = this.state.bind.messages.length;\r\n\r\n\t\tthis.addMessage({\r\n\t\t\tbind: this.bind, \r\n\t\t\tuser: this.props.net.profile, \r\n\t\t\ttext, \r\n\t\t\tindex: (len>0)?this.state.bind.messages[len-1].index+1:0,\r\n\t\t\ttimestamp:Date.now()});\r\n\r\n\t\tthis.bindsRef.current.scrollTop = 0;\r\n\r\n\t\tfetch(url+'/write-message', {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\theaders: {\r\n\t\t\t\t\ttoken: this.props.net.token,\r\n\t\t\t\t\t'Content-Type': 'application/json;charset=utf-8',\r\n\t\t\t\t},\r\n\t\t  \tbody: JSON.stringify({bind: this.bind, text})\r\n\t\t}).then(resp => resp.json())\r\n\t\t.then(jresp => {\r\n\t\t\tconsole.log('Sended message');\r\n\t\t});\r\n\t}\r\n\r\n\taddMessage = message => {\r\n\r\n\t\tconst list = [...this.state.binds];\r\n\t\tlet bind = null;\r\n\r\n\t\tfor(let i = 0; i < list.length; i++)\r\n\t\t\tif(message.bind === list[i].link){\r\n\t\t\t\tbind = list[i];\r\n\t\t\t\tlist.splice(i, 1);\r\n\t\t\t}\r\n\r\n\t\tif(bind !== null){\r\n\t\t\tbind.messageCount++;\r\n\t\t\tif(this.state.bind === bind){\r\n\r\n\t\t\t\tthis.messagesRef.current.updateScroll();\r\n\r\n\t\t\t\t//Здесь мы отправим сообщение, что сообщения прочитаны\r\n\t\t\t\tbind.readed++;\r\n\t\t\t\tif(message.user.login !== this.props.net.profile.login)\r\n\t\t\t\t\tthis.props.net.socket.send(JSON.stringify({\r\n\t\t\t\t\t\ttype: 'readed',\r\n\t\t\t\t\t\ttoken: this.props.net.token,\r\n\t\t\t\t\t\treaded: bind.messageCount,\r\n\t\t\t\t\t\tbind: bind.link\r\n\t\t\t\t\t}));\r\n\t\t\t}else \r\n\t\t\t\tbind = Object.assign({}, bind);\r\n\r\n\t\t\tif(message.user.login !== this.props.net.profile.login)\r\n\t\t\t\tbind.online = true;\r\n\t\t\tbind.messages.push(message);\r\n\t\t\tlist.unshift(bind);\r\n\r\n\t\t\tthis.setState({binds: list});\r\n\t\t}else{\r\n\t\t\tconsole.log(\"GET NEW BIND - \", message.bind);\r\n\t\t\tthis.getNewBind(message.bind);\r\n\t\t}\r\n\t}\r\n\r\n\tgetStatusBind = () => {\r\n\t\tif(this.state.bind.isGroup){\r\n\t\t\tconst count = this.state.bind.userCount;\r\n\t\t\tif(count)\r\n\t\t\t\treturn count+' '+numeral(count, 'участник', 'участника', 'участников');\r\n\t\t\t\r\n\t\t\treturn 'Группа';\r\n\t\t}else{\r\n\t\t\tif(this.state.bind.online)\r\n\t\t\t\treturn <b>В сети</b>;\r\n\t\t\telse\r\n\t\t\t\treturn \"Не в сети\";\r\n\t\t}\r\n\t}\r\n\r\n\tscrollMessage = (e) => {\r\n\t\tconst bind = this.state.bind;\r\n\t\tfetch(url+'/get-bind/'+bind.link+'?limit=100&last='+bind.messages[0].index, {\r\n\t\t\tmethod: 'GET',\r\n\t\t\theaders: { token: this.props.net.token }\r\n\t\t}).then(resp => resp.json())\r\n\t\t.then(jresp => {\r\n\t\t\tif(jresp.error){\r\n\t\t\t\tconsole.log(jresp.error);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tbind.messages = jresp.messages.concat(bind.messages);\r\n\t\t\tthis.setState({bind});\r\n\t\t});\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"anim up message-page root-block\">\r\n\t\t\t\t<header className=\"main-header\">\r\n\t\t\t\t\t<h1>Сообщения</h1>\r\n\t\t\t\t</header>\r\n\t\t\t\t<main className=\"main-content\">\r\n\t\t\t\t\t<div className=\"column\" style={{flexBasis: '400px', maxWidth: '400px', flexShrink: 0}}>\r\n\t\t\t\t\t\t<div className=\"search-div\">\r\n\t\t\t\t\t\t\t<InputText fields={{search: \"Поиск\"}} onChange={this.onSearch}>\r\n\t\t\t\t\t\t\t\t<MdSearch size=\"1.5em\"/>\r\n\t\t\t\t\t\t\t</InputText>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"binds-wrapper\" ref={this.bindsRef}>\r\n\t\t\t\t\t\t{this.state.binds && (\r\n\t\t\t\t\t\t\t<ul className=\"binds\">\r\n\t\t\t\t\t\t\t\t{this.state.binds.map(bind => (\r\n\t\t\t\t\t\t\t\t\t\t<Bind  \r\n\t\t\t\t\t\t\t\t\t\t\tkey={bind.link} \r\n\t\t\t\t\t\t\t\t\t\t\tbind={bind}\r\n\t\t\t\t\t\t\t\t\t\t\tsuser={this.props.net.profile.login}\r\n\t\t\t\t\t\t\t\t\t \t\tactive={bind === this.state.bind}\r\n\t\t\t\t\t\t\t\t\t \t/>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"column\" style={{flexGrow: 1, backgroundColor: '#E0E0E0'}}>\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t{this.state.bind && (\r\n\t\t\t\t\t\t\t<div className=\"profile-div\">\r\n\t\t\t\t\t\t\t\t<Icon \r\n\t\t\t\t\t\t\t\t\tsrc={this.state.bind.icon} \r\n\t\t\t\t\t\t\t\t\tname={this.state.bind.name} \r\n\t\t\t\t\t\t\t\t\tclassName={this.state.bind.isGroup?'group':'user'}\r\n\t\t\t\t\t\t\t\t\tsize=\"50\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<div className=\"profile-info\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"name\">{this.state.bind.name}</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"status\">\r\n\t\t\t\t\t\t\t\t\t{this.getStatusBind()}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{(this.state.bind.isGroup===true) && (\r\n\t\t\t\t\t\t\t\t\t<div className=\"bar-right-buttons\">\r\n\t\t\t\t\t\t\t\t\t\t<RippleA to={'/'+this.state.bind.link+'/c'}>\r\n\t\t\t\t\t\t\t\t\t\t\tОткрыть конференцию\r\n\t\t\t\t\t\t\t\t\t\t</RippleA>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div> \r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{this.state.bind && <MessageBlock \r\n\t\t\t\t\t\t\t\tnet={this.props.net}\r\n\t\t\t\t\t\t\t\tmessages={this.state.bind.messages}\r\n\t\t\t\t\t\t\t\tbind={this.state.bind.link}\r\n\t\t\t\t\t\t\t\tscrollMessage={this.scrollMessage}\r\n\t\t\t\t\t\t\t\tref={this.messagesRef}\r\n\t\t\t\t\t\t\t\t/>}\r\n\r\n\t\t\t\t\t\t\t<Chat \r\n\t\t\t\t\t\t\t\tclassName=\"chat-div\" \r\n\t\t\t\t\t\t\t\tsend={this.sendMessage} \r\n\t\t\t\t\t\t\t\tshow={(this.state.bind !== null)}\r\n\t\t\t\t\t\t\t\tref={this.chatRef}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t</main>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nexport default MessagesPage;\r\n\r\nfunction Bind (props) {\r\n\tlet message = null;\r\n\tlet timeString = '';\r\n\tlet author = '';\r\n\tlet unread = 0;\r\n\tconst className = props.bind.isGroup?'group':'user';\r\n\tif(props.bind.messages.length>0){\r\n\t\tmessage = props.bind.messages[props.bind.messages.length-1];\r\n\r\n\t\ttimeString = getDate(message.timestamp);\r\n\r\n\t\tif(message.user.login !== props.bind.link)\r\n\t\t\t\tif(message.user.login === props.suser)\r\n\t\t\t\t\tauthor = \"Вы: \";\r\n\t\t\t\telse\r\n\t\t\t\t\tauthor = message.user.name + \": \";\r\n\r\n\t\tunread = props.bind.messageCount-props.bind.readed\r\n\t}\r\n\treturn <Link to={'/'+props.bind.link} className=\"clear\">\r\n\t\t<li className={'bind'+(props.active?' active':'')+(unread>0?' unreaded':'')}>\r\n\t\t\t<BindIcon src={props.bind.icon} name={props.bind.name} size=\"50\" className={className}\r\n\t\t\t\tonline={props.bind.online}/>\r\n\t\t\t<div className=\"bind-inner\">\r\n\t\t\t\t<div className=\"content\">\r\n\t\t\t\t\t<div className=\"profile-name\">{props.bind.name}</div>\r\n\t\t\t\t\t{message && <div className=\"message-text\">\r\n\t\t\t\t\t\t<span className='author'>{author}</span>\r\n\t\t\t\t\t\t{message.text}\r\n\t\t\t\t\t</div>}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<div className=\"time\">{timeString}</div>\r\n\t\t\t\t\t{(unread>0) && <div className=\"unread\">{unread}</div>}\r\n\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t</li>\r\n\t</Link>\r\n}","import React, {useEffect, useState} from 'react'\r\nimport { ModalWindow, ModalWindowBase } from './../inputs/ModalWindow.jsx'\r\nimport { InputText, SegmentButton, RippleButton, RippleA } from './../inputs/LoginInputs.jsx'\r\nimport { TiGroup } from 'react-icons/ti'\r\nimport { MdExpandMore } from 'react-icons/md'\r\nimport { url } from './../../constants'\r\nimport { numeral } from './../../tools/rus.js';\r\nimport { Icon } from './../utils.jsx'\r\n\r\nexport class ModalGroupAdd extends React.Component {\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tthis.roomInfo = {name: '', type : 'public'}\r\n\t\tthis.state = {errors: {name: null}}\r\n\t\tthis.url = this.props.net.url;\r\n\t}\r\n\r\n\tonChange = str => {\r\n\t\tObject.assign(this.roomInfo, str);\r\n\t\tthis.setState({errors: {name: null}});\r\n\t}\r\n\r\n\tchangeSegment = str => {\r\n\t\t\tthis.roomInfo.type = str;\r\n\t}\r\n\r\n\tsubmit = () => {\r\n\t\tthis.roomInfo.name = this.roomInfo.name.trim();\r\n\t\tif(this.roomInfo.name.length < 4){\r\n\t\t\tthis.setState({errors: {name: 'Слишком короткое название'}})\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfetch(url+'/create-new-group', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json;charset=utf-8',\r\n\t\t\t\ttoken: this.props.net.token\r\n\t  \t},\r\n\t  \tbody: JSON.stringify(this.roomInfo)\r\n\t  }).then(response => response.json())\r\n\t  .then(resp => {\r\n\t  \tif(resp.errors){\r\n\t  \t\tthis.setState({errors: resp.errors});\r\n\t  \t\treturn;\r\n\t  \t}\r\n\r\n  \t\tthis.props.success(resp);\r\n\r\n\t  });\r\n\r\n\t}\r\n\r\n\trender() {\r\n\r\n\t\treturn (\r\n\t\t\t<ModalWindow \ttitle=\"Создать группу\" cancel={this.props.cancel} \r\n\t\t\t\t\t\t\t\t\t\tsuccess=\"Создать группу\" onSubmit={this.submit}>\r\n\t\t\t\t<div style={{width: '500px', padding: '0 10px'}}>\r\n\t\t\t\t\t<InputText  fields={{name: \"Название группы\"}} style={{width: '400px', margin: '0 auto'}} \r\n\t\t\t\t\t\tonChange={this.onChange} error={this.state.errors.name}>\r\n\t\t\t\t\t\t<TiGroup size=\"1.5em\"/>\r\n\t\t\t\t\t</InputText>\r\n\r\n\t\t\t\t\t<SegmentButton title=\"Тип\" fields={{public: 'Публичная', private: 'Закрытая'}} \r\n\t\t\t\t\tstyle={{width: '260px', margin: '20px auto'}} value=\"public\" onChange={this.changeSegment}/>\r\n\t\t\t\t</div>\r\n\t\t\t</ModalWindow>\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nexport function ModalGroup (props) {\r\n\r\n\tconst [group, setGroup] = useState(null);\r\n\tconst token = props.net.token;\r\n\r\n\tuseEffect(() => {\r\n\r\n\t\tfetch(url+'/get-group/'+props.link, {\r\n\t\t\tmethod: 'GET',\r\n\t\t\theaders: { token }\r\n\t\t}).then(resp => resp.json())\r\n\t\t.then(jresp => {\r\n\t\t\tif(jresp.error)\r\n\t\t\t\tconsole.error(jresp);\r\n\t\t\tsetGroup(jresp);\r\n\t\t});\r\n\t}, [props.link, token]);\r\n\r\n\tconst onSubmit = () => {\r\n\t\tfetch(url+'/join-group', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\theaders: { \r\n\t\t\t\ttoken,\r\n\t\t\t\t'Content-Type': 'application/json;charset=utf-8'\r\n\t\t \t},\r\n\t\t \tbody: JSON.stringify({group: props.link})\r\n\t\t}).then(resp => resp.json())\r\n\t\t.then(jresp => {\r\n\t\t\tif(jresp.error){\r\n\t\t\t\tconsole.error(jresp.error);\r\n\t\t\t\tprops.onError();\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tprops.onSuccess(jresp);\r\n\t\t});\r\n\t}\r\n\r\n\tlet title = props.link;\r\n\tif(group !== null)\r\n\t\ttitle = group.name;\r\n\treturn (\r\n\t\t<ModalWindowBase \r\n\t\t\ttitle={title} \r\n\t\t\tcancel={props.cancel} \r\n\t\t\tsuccess={\"Вступить\"} \r\n\t\t\tdisabled={group===null}\r\n\t\t\tclassName=\"group-info\"\r\n\t\t>\r\n\t\t\t{(group !== null) && <div style={{width: '400px', textAlign: 'center'}}>\r\n\t\t\t\t<RippleButton className=\"transparent more\">\r\n\t\t\t\t\t{group.userCount + ' ' + numeral(group.userCount, 'участник', 'участника', 'участников')}\r\n\t\t\t\t\t{(group.users > 6) && <MdExpandMore size=\"1.5em\"/>}\r\n\t\t\t\t</RippleButton>\r\n\t\t\t\t<div style={{margin: '3px 0'}}>\r\n\t\t\t\t\t{group.users.map(user => <Icon profile={user} key={user.login} size=\"50\"/>)}\r\n\t\t\t\t</div>\r\n\t\t\t\t{group.my?(\r\n\t\t\t\t\t<div className=\"modal-buttons-vertical\">\r\n\t\t\t\t\t\t<RippleA to={'/'+props.link} className=\"transparent\">\r\n\t\t\t\t\t\t\tПерейти к сообщениям\r\n\t\t\t\t\t\t</RippleA>\r\n\t\t\t\t\t\t<RippleA to={'/'+props.link+'/c'} >\r\n\t\t\t\t\t\t\tПерейти к конференции\r\n\t\t\t\t\t\t</RippleA>\r\n\t\t\t\t\t\t<RippleButton onClick={props.cancel} className=\"transparent\">\r\n\t\t\t\t\t\t\tНазад\r\n\t\t\t\t\t\t</RippleButton>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t):(\r\n\t\t\t\t<div className=\"modal-buttons\">\r\n\t\t\t\t\t<RippleButton className=\"transparent\" onClick={props.cancel}>\r\n\t\t\t\t\t\tОтмена\r\n\t\t\t\t\t</RippleButton>\r\n\t\t\t\t\t<RippleButton onClick={onSubmit}>\r\n\t\t\t\t\t\tВступить\r\n\t\t\t\t\t</RippleButton>\r\n\t\t\t\t</div>\r\n\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t</div>}\r\n\t\t</ModalWindowBase>\r\n\t);\r\n\r\n}","import React from 'react'\r\nimport { Route } from 'react-router-dom'\r\nimport { RippleA, InputText, RippleButton } from './../inputs/LoginInputs.jsx'\r\nimport { ModalWindowWrapper } from './../inputs/ModalWindow.jsx'\r\nimport { MdSearch, MdMoreVert } from 'react-icons/md'\r\nimport { ModalGroupAdd, ModalGroup } from './modal-windows.jsx'\r\nimport { AlertWrapper } from './../inputs/Alert.jsx'\r\nimport { url } from './../../constants'\r\nimport { Icon } from './../utils.jsx';\r\n\r\nclass ConferencesPage extends React.Component {\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tthis.alertRef = React.createRef();\r\n\t\tthis.state = {redirect: false, myGroups: null, otherGroups: null, filter: ''}\r\n\t}\r\n\r\n\tonSearch = ({search}) => {\r\n\t\tthis.setState({filter: search});\r\n\t}\r\n\r\n\tcomponentDidMount(){\r\n\t\tfetch(url+'/get-groups', {\r\n\t\t\tmethod: 'GET',\r\n\t\t\theaders: {\r\n\t\t\t\ttoken: this.props.net.token\r\n\t  \t}\r\n\t  }).then(resp => resp.json())\r\n\t  .then(jresp => {\r\n\t  \tif(jresp.errors){\r\n\t  \t\tconsole.error(jresp.errors);\r\n\t  \t\treturn;\r\n\t  \t}\r\n\t  \tthis.setState({myGroups: jresp.myGroups, otherGroups: jresp.otherGroups});\r\n\r\n\t  });\r\n\t}\r\n\r\n\tonSuccess = group => {\r\n\t\t\r\n\t\tthis.props.history.push('/c');\r\n\t\tthis.setState({myGroups: [group, ...this.state.myGroups]});\r\n\t\tthis.alert(`Комната \"${group.name}\" создана`);\r\n\t}\r\n\r\n\tonClickRow = (group) => {\r\n\t\tthis.props.history.push('/c/'+group.link);\r\n\t}\r\n\r\n\tsuccessJoinToRoom = (group) => {\r\n\t\tthis.props.history.push('/c');\r\n\t\tthis.alert(`Вы добавлены в группу \"${group.name}\"`);\r\n\t\tthis.setState({myGroups: [group, ...this.state.myGroups]});\r\n\r\n\t\tconst otherGroups = this.state.otherGroups;\r\n\t\tfor(let i = 0; i < otherGroups.length; i++)\r\n\t\t\tif(otherGroups[i].link === group.link){\r\n\t\t\t\tthis.setState({otherGroup: otherGroups.slice(0, i).concat(otherGroups.slice(i+1))});\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t}\r\n\r\n\talert = (str) => {\r\n\t\tsetTimeout(() => this.alertRef.current.alert(str), 250);\r\n\t}\r\n\r\n\trender() {\r\n\r\n\t\tconst getModal = (match) => {\r\n\t\t\tif(match == null) return null;\r\n\r\n\t\t\tif(match.params.room === 'add') \r\n\t\t\t\treturn <ModalGroupAdd \r\n\t\t\t\t\tcancel={() => this.props.history.push('/c')} \r\n\t\t\t\t\tnet={this.props.net} \r\n\t\t\t\t\tsuccess={this.onSuccess}/>\r\n\t\t\t\t\t\r\n\t\t\treturn <ModalGroup \r\n\t\t\t\tnet={this.props.net}\r\n\t\t\t\tlink={match.params.room} \r\n\t\t\t\tcancel={() => this.props.history.push('/c')} \r\n\t\t\t\tonSuccess={this.successJoinToRoom}\r\n\t\t\t\tonError={() => this.alert(`При добавлении к комнате возникла ошибка`)}\r\n\t\t\t/>;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<AlertWrapper delay={2000} ref={this.alertRef}>\r\n\t\t\t\t<Route exact path=\"/c/:room\"> \r\n\t\t\t\t{({match}) => (\r\n\t\t\t\t<ModalWindowWrapper modal={getModal(match)}>\r\n\t\t\t\t\t<header className=\"main-header\" style={{justifyContent: 'space-between'}}>\r\n\t\t\t\t\t\t<h1>Группы</h1>\r\n\t\t\t\t\t\t<div className=\"search-div\" style={{flexGrow: '2', textAlign: 'center'}}>\r\n\t\t\t\t\t\t\t<InputText fields={{search: \"Поиск групп...\"}} style={{width: '400px', display: 'inline-flex'}} onChange={this.onSearch}>\r\n\t\t\t\t\t\t\t\t<MdSearch size=\"1.5em\"/>\r\n\t\t\t\t\t\t\t</InputText>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<RippleA className=\"transparent\" style={{width: '150px'}} to=\"/c/add\">\r\n\t\t\t\t\t\t\tСоздать группу\r\n\t\t\t\t\t\t</RippleA>\r\n\t\t\t\t\t</header>\r\n\t\t\t\t\t<main className=\"conferences\">\r\n\r\n\t\t\t\t\t\t{this.state.myGroups && this.state.myGroups.length > -1 && \r\n\t\t\t\t\t\t\t<GroupTable onClickRow={this.onClickRow} title=\"Группы с вами\" \r\n\t\t\t\t\t\t\t\tgroups={this.state.myGroups} filter={this.state.filter}/>}\r\n\r\n\t\t\t\t\t\t{this.state.otherGroups && this.state.otherGroups.length > -1 && \r\n\t\t\t\t\t\t\t<GroupTable onClickRow={this.onClickRow} title=\"Прочие открытые группы\" \r\n\t\t\t\t\t\t\t\tgroups={this.state.otherGroups} filter={this.state.filter}/>}\r\n\r\n\t\t\t\t\t</main>\r\n\t\t\t\t</ModalWindowWrapper>\r\n\t\t\t\t)}\r\n\t\t\t\t</Route>\r\n\t\t\t</AlertWrapper>\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nexport default ConferencesPage;\r\n\r\nfunction GroupTable(props) {\r\n\r\n\tlet groups = props.groups;\r\n\r\n\tif(props.filter && props.filter !== ''){\r\n\t\tconst reg = new RegExp(props.filter, 'iu');\r\n\t\tgroups = groups.filter(el => (reg.test(el.name) || reg.test(el.admin.name + ' ' + el.admin.surname)))\r\n\t}\r\n\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<h3>{props.title} <span className=\"count\">{`(${groups.length})`}</span></h3>\r\n\t\t\t<table className=\"group-table\">\r\n\t\t\t\t<thead>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<th></th>\r\n\t\t\t\t\t\t<th className=\"td-title\">Название</th>\r\n\t\t\t\t\t\t<th>Всего участников</th>\r\n\t\t\t\t\t\t<th>Начало конференции</th>\r\n\t\t\t\t\t\t<th>Организатор</th>\r\n\t\t\t\t\t\t<th></th>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</thead>\r\n\t\t\t\t<tbody>\r\n\t\t\t\t\t{groups.map(el => (\r\n\t\t\t\t\t\t<tr className=\"tr-group\" key={el.link} onClick={() => props.onClickRow(el)}>\r\n\t\t\t\t\t\t\t<td className=\"group-icon\"><Icon src={el.icon} name={el.name} size=\"35\" className=\"group\"/></td>\r\n\t\t\t\t\t\t\t<td className=\"td-title\">{el.name}</td>\r\n\t\t\t\t\t\t\t<td>{el.userCount}</td>\r\n\t\t\t\t\t\t\t<td></td>\r\n\t\t\t\t\t\t\t<td>{el.admin.name + ' ' + el.admin.surname}</td>\r\n\t\t\t\t\t\t\t<td className=\"group-more\">\r\n\t\t\t\t\t\t\t\t<RippleButton className=\"transparent more-button\">\r\n\t\t\t\t\t\t\t\t\t<MdMoreVert size=\"1.4em\"/>\r\n\t\t\t\t\t\t\t\t</RippleButton>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</tbody>\r\n\t\t\t</table>\r\n\t\t</div>);\r\n}\r\n\r\n","import React from 'react'\r\nimport {RippleButton} from './../inputs/LoginInputs.jsx'\r\n\r\nexport default function SettingsPage (props){\r\n\r\n\tconst exit = () => {\r\n\t\tprops.net.emitter.emit('logout');\r\n\t}\r\n\r\n\treturn (\r\n\t<div>\r\n\t\t<header className=\"main-header\">\r\n\t\t\t<h1>Настройки</h1>\r\n\t\t</header>\r\n\t\t<RippleButton onClick={exit}>\r\n\t\t\tВыйти из профиля\r\n\t\t</RippleButton>\r\n\t</div>\r\n\t);\r\n}","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M15.7843 0.75C19.3092 0.75 22.6898 2.13281 25.1823 4.59422C27.6748 7.05564 29.0751 10.394 29.0751 13.875C29.0751 17.356 27.6748 20.6944 25.1823 23.1558C22.6898 25.6172 19.3092 27 15.7843 27C12.2593 27 8.87873 25.6172 6.38622 23.1558C3.8937 20.6944 2.49342 17.356 2.49342 13.875C2.49342 10.394 3.8937 7.05564 6.38622 4.59422C8.87873 2.13281 12.2593 0.75 15.7843 0.75ZM15.7843 4.5C13.2664 4.5 10.8517 5.48772 9.07137 7.24587C7.291 9.00403 6.2908 11.3886 6.2908 13.875C6.2908 16.3614 7.291 18.746 9.07137 20.5041C10.8517 22.2623 13.2664 23.25 15.7843 23.25C17.031 23.25 18.2655 23.0075 19.4173 22.5364C20.5691 22.0652 21.6156 21.3747 22.4972 20.5041C23.3787 19.6336 24.078 18.6001 24.5551 17.4627C25.0322 16.3252 25.2777 15.1061 25.2777 13.875C25.2777 11.3886 24.2775 9.00403 22.4972 7.24587C20.7168 5.48772 18.3021 4.5 15.7843 4.5ZM15.7843 8.25C17.295 8.25 18.7438 8.84263 19.812 9.89753C20.8802 10.9524 21.4803 12.3832 21.4803 13.875C21.4803 15.3668 20.8802 16.7976 19.812 17.8525C18.7438 18.9074 17.295 19.5 15.7843 19.5C14.2736 19.5 12.8248 18.9074 11.7565 17.8525C10.6883 16.7976 10.0882 15.3668 10.0882 13.875C10.0882 12.3832 10.6883 10.9524 11.7565 9.89753C12.8248 8.84263 14.2736 8.25 15.7843 8.25ZM4.39211 38.25C3.38498 38.25 2.4191 37.8549 1.70695 37.1517C0.994807 36.4484 0.594727 35.4946 0.594727 34.5C0.594727 33.7875 0.784596 33.1313 1.14535 32.5688L4.60097 26.6438C7.70867 29.2939 11.6782 30.7514 15.7843 30.75C20.0563 30.75 23.9676 29.1938 26.9676 26.6438L30.4232 32.5688C30.7839 33.1313 30.9738 33.7875 30.9738 34.5C30.9738 35.4946 30.5737 36.4484 29.8616 37.1517C29.1494 37.8549 28.1835 38.25 27.1764 38.25H4.39211Z\",\n  fill: \"currentColor\"\n});\n\nvar SvgWebcam = function SvgWebcam(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 31,\n    height: 39,\n    viewBox: \"0 0 31 39\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgWebcam, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/webcam.a8ba8439.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useEffect, useRef } from 'react'\r\n\r\nconst VideoBlock = (props) => {\r\n\r\n\tconst ref = useRef(null);\r\n\tuseEffect(() => {\r\n\t\tif(props.srcObject)\r\n\t\t\tref.current.srcObject = props.srcObject;\r\n\t}, [props.srcObject]);\r\n\r\n\tconst _props = {...props};\r\n\tdelete _props.srcObject;\r\n\r\n\treturn (\r\n\t\t<div className=\"video-wrapper\" {..._props}>\r\n\t\t\t<video ref={ref} autoPlay={true} muted={true}>\r\n\t\t\t</video>\r\n\t\t\t{props.children}\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default VideoBlock;","\r\n\r\nexport default class webrtcConnection{\r\n\tconstructor({offer, ice}){\r\n\t\tthis.ice = ice;\r\n\t\tthis.offer = offer;\r\n\t\tthis.streams = [];\r\n\t\tthis.connections = new Map();\r\n\t}\r\n\r\n\tasync connect(addStream, {video, audio}){\r\n\r\n\t\tvideo = video===true? ({height: 200}):false;\r\n\t\taudio = audio === true;\r\n\r\n\t\tconst pc = new RTCPeerConnection();\r\n\r\n\t\tconst stream = await navigator.mediaDevices.getUserMedia({video, audio});\r\n\r\n\t\tconst connection = { pc, stream }\r\n\r\n\t\taddStream(stream);\r\n\r\n\t\tstream.getTracks().forEach(track => pc.addTrack(track, stream));\r\n\r\n\t\tawait pc.setRemoteDescription(this.offer);\r\n\t\tconst answer = await pc.createAnswer();\r\n\r\n\t\tawait pc.setLocalDescription(answer);\r\n\t\tpc.addIceCandidate(new RTCIceCandidate(this.ice));\r\n\r\n\t\tthis.connections.set(\"__sender\", connection);\r\n\r\n\t\treturn answer;\r\n\t}\r\n\r\n\tasync addReciever({offer, ice, user}, addStream){\r\n\t\tconst pc = new RTCPeerConnection();\r\n\r\n\t\tconst connection = { pc, stream: null }\r\n\r\n\t\tpc.addEventListener('track', e => {\r\n\t\t\tconsole.log(e);\r\n\t\t\tif(e.streams[0] && e.streams[0] !== connection.stream){\r\n\t\t\t\tconsole.log('pc received remote stream');\r\n\t\t\t\tconnection.stream = e.streams[0];\r\n\t\t\t\taddStream(e.streams[0]);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tawait pc.setRemoteDescription(offer);\r\n\t\tconst answer = await pc.createAnswer();\r\n\r\n\t\tawait pc.setLocalDescription(answer);\r\n\t\tpc.addIceCandidate(new RTCIceCandidate(ice));\r\n\r\n\t\tthis.connections.set(user.login, connection);\r\n\r\n\t\treturn answer;\r\n\t}\r\n\r\n\tclose(){\r\n\t\tfor(let c of this.connections.values()){\r\n\t\t\tc.pc.close();\r\n\t\t\tc.stream.getTracks().forEach(track => track.stop());\r\n\t\t}\r\n\t}\r\n\r\n\tremove(login){\r\n\t\tif(this.connections.has(login)){\r\n\t\t\tthis.connections.get(login).pc.close();\r\n\t\t\tthis.connections.get(login).stream.getTracks().forEach(track => track.stop());\r\n\t\t}\r\n\t}\r\n}","import React from 'react'\r\nimport { url } from './../../constants'\r\nimport { IoIosArrowBack } from 'react-icons/io'\r\nimport { FaMicrophone } from 'react-icons/fa'\r\nimport { ReactComponent as WebCamIcon } from './webcam.svg'\r\nimport { MessageBlock } from './../main/messages.jsx'\r\nimport { AlertWrapper } from './../inputs/Alert.jsx'\r\nimport { RippleA, RippleButton } from './../inputs/LoginInputs.jsx'\r\nimport { numeral } from './../../tools/rus'\r\nimport { Icon, MicroIcon } from './../utils.jsx'\r\nimport VideoBlock from './video-block.jsx'\r\n\r\nimport Chat from './../inputs/Chat.jsx'\r\n\r\nimport webrtcSystem from './webrtc-connection'\r\n\r\nexport default class RoomPage extends React.Component {\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tthis.alertRef = React.createRef();\r\n\t\tthis.link = props.match.params.bind;\r\n\t\tthis.state = { \r\n\t\t\troom: null, \r\n\t\t\tmessages: null, \r\n\t\t\tstreams: [], \r\n\t\t\tcontext: null,\r\n\t\t\tconstraints: { video: false, audio: false } ,\r\n\t\t\thighlighted: null,\r\n\t\t};\r\n\t\tthis.messagesRef = React.createRef();\r\n\t\tthis.webrtc = null;\r\n\t}\r\n\r\n\tcomponentDidMount(){\r\n\t\tconsole.log(url+'/join-room/'+this.link);\r\n\t\tfetch(url+'/join-room/'+this.link, {\r\n\t\t\tmethod: 'POST',\r\n\t\t\theaders: {\r\n\t\t\t\ttoken: this.props.net.token,\r\n\t\t\t\t'Content-Type': 'application/json;charset=utf-8',\r\n  \t\t},\r\n\t\t}).then(resp => resp.json())\r\n\t\t.then(jresp => {\r\n\t\t\tif(jresp.error){\r\n\t\t\t\tconsole.error(jresp.error);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t//console.log(jresp);\r\n\t\t\tconst context = new (window.AudioContext || window.webkitAudioContext)();\r\n\t\t\tthis.webrtc = new webrtcSystem(jresp.default);\r\n\t\t\tthis.webrtc.context = context;\r\n\t\t\tfor(let sender of jresp.senders)\r\n\t\t\t\tthis.addSender(sender);\r\n\t\t\tthis.setState({messages: jresp.messages, room: jresp.room, context});\r\n\t\t\tthis.props.net.emitter.on('message', this.addMessage);\r\n\t\t\tthis.props.net.emitter.on('add-sender', this.addSender);\r\n\t\t\tthis.props.net.emitter.on('close-sender', this.closeSender);\r\n\t\t\tthis.props.net.emitter.on('update-user-count', this.updateUserCount);\r\n\t\t\tthis.props.net.emitter.on('room-error', this.onError);\r\n\t\t});\r\n\t}\r\n\r\n\tcomponentWillUnmount(){\r\n\t\t\r\n\t\tthis.props.net.emitter.off('message', this.addMessage);\r\n\t\tthis.props.net.emitter.off('add-sender', this.addSender);\r\n\t\tthis.props.net.emitter.off('close-sender', this.closeSender);\r\n\t\tthis.props.net.emitter.off('update-user-count', this.updateUserCount);\r\n\t\tthis.props.net.emitter.on('room-error', this.onError);\r\n\t\tthis.webrtc.close();\r\n\t\tthis.props.net.socket.send(JSON.stringify({\r\n\t\t\ttype: 'leave-room',\r\n\t\t\ttoken: this.props.net.token,\r\n\t\t}));\r\n\t}\r\n\r\n\taddSender = async (sender) => {\r\n\t\tconst answer = await this.webrtc.addReciever(sender, (\r\n\t\t\tstream => this.addStream(stream, {user: sender.user, ...sender.constraints})\r\n\t\t));\r\n\r\n\t\tthis.props.net.socket.send(JSON.stringify({\r\n\t\t\ttype: 'create-receive',\r\n\t\t\ttoken: this.props.net.token,\r\n\t\t\tanswer,\r\n\t\t\tsender: sender.user.login\r\n\t\t}));\r\n\t}\r\n\r\n\tcloseSender = ({login}) => {\r\n\t\tconsole.log(\"CLOSE SENDER - \", login);\r\n\t\tthis.setState({streams: this.state.streams.filter(\r\n\t\t\t({user}) => user.login !== login\r\n\t\t)});\r\n\t\tthis.webrtc.remove(login);\r\n\t}\r\n\r\n\tupdateUserCount = ({userCount}) => {\r\n\t\tconst room = Object.assign({}, this.state.room, {userCount});\r\n\t\tthis.setState({room});\r\n\t}\r\n\r\n\tonError = ({error}) => {\r\n\t\tswitch (error){\r\n\t\t\tcase 'ExistLogin': this.alertRef.current.alert(\r\n\t\t\t\t'Ваш профиль уже используется в этой комнате для видеосвязи'\r\n\t\t\t\t); break;\r\n\t\t\tdefault: console.error(error); break;\r\n\t\t}\r\n\t}\r\n\r\n\tsendMessage = (text) => {\r\n\r\n\t\tif(text.trim() === '')\r\n\t\t\treturn;\r\n\r\n\t\tconst len = this.state.messages.length;\r\n\r\n\t\tthis.addMessage({\r\n\t\t\tbind: this.state.room.link, \r\n\t\t\tuser: this.props.net.profile, \r\n\t\t\ttext, \r\n\t\t\tindex: (len>0)?this.state.messages[len-1].index+1:0,\r\n\t\t\ttimestamp:Date.now()});\r\n\r\n\t\tfetch(url+'/write-message', {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\theaders: {\r\n\t\t\t\t\ttoken: this.props.net.token,\r\n\t\t\t\t\t'Content-Type': 'application/json;charset=utf-8',\r\n\t\t\t\t},\r\n\t\t  \tbody: JSON.stringify({bind: this.state.room.link, text})\r\n\t\t}).then(resp => resp.json())\r\n\t\t.then(jresp => {\r\n\t\t\tconsole.log('Sended message');\r\n\t\t});\r\n\t}\r\n\r\n\taddMessage = message => {\r\n\t\tif(message.bind === this.state.room.link){\r\n\t\t\tthis.messagesRef.current.updateScroll();\r\n\t\t\tthis.setState({messages: [...this.state.messages, message]});\r\n\t\t}\r\n\t}\r\n\r\n\tscrollMessage = (e) => {\r\n\t\tlet messages = this.state.messages;\r\n\t\tfetch(url+'/get-bind/'+this.state.room.link+'?limit=100&last='+messages[0].index, {\r\n\t\t\tmethod: 'GET',\r\n\t\t\theaders: { token: this.props.net.token }\r\n\t\t}).then(resp => resp.json())\r\n\t\t.then(jresp => {\r\n\t\t\tif(jresp.error){\r\n\t\t\t\tconsole.log(jresp.error);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tmessages = jresp.messages.concat(messages);\r\n\t\t\tthis.setState({messages});\r\n\t\t});\r\n\t}\r\n\r\n\taddStream = (stream, {user, video, audio}) => {\r\n\t\tconst _stream = {user, video, audio, stream}\r\n\t\tthis.setState({streams: [...this.state.streams, _stream]});\r\n\t}\r\n\r\n\r\n\tactivateCamera = async () => {\r\n\t\ttry{\r\n\t\t\tfor(let stream of this.state.streams){\r\n\t\t\t\tif(stream.user.login === this.props.net.profile.login)\r\n\t\t\t\t\tthrow(new Error('ExistLogin'));\r\n\t\t\t}\r\n\t\t\tconst answer = await this.webrtc.connect(\r\n\t\t\t\t(stream) => this.addStream(stream, {\r\n\t\t\t\t\tuser: this.props.net.profile, \r\n\t\t\t\t\tvideo: true, \r\n\t\t\t\t\taudio: true\r\n\t\t\t\t}), \r\n\t\t\t\t{ video: true, audio: true }\r\n\t\t\t);\r\n\r\n\t\t\tthis.props.net.socket.send(JSON.stringify({\r\n\t\t\t\ttype: 'create-connection',\r\n\t\t\t\ttoken: this.props.net.token,\r\n\t\t\t\tanswer\r\n\t\t\t}));\r\n\r\n\t\t\tthis.setState({constraints: { video: true, audio: true } });\r\n\r\n\t\t}catch(e){\r\n\t\t\tif(e.name === \"NotAllowedError\")\r\n\t\t\t\tthis.alertRef.current.alert(\r\n\t\t\t\t\t\"Сначала включите разрешение на использование веб-камеры в браузере\"\r\n\t\t\t\t);\r\n\t\t\tif(e.message === \"ExistLogin\")\r\n\t\t\t\tthis.onError({error: e.message});\r\n\t\t\tconsole.log(e.message);\r\n\t\t}\r\n\t}\r\n\r\n\tactivateMicrophone = async () => {\r\n\t\tconst constraints = this.state.constraints;\r\n\t\tconstraints.audio = true;\r\n\t\ttry{\r\n\t\t\tfor(let stream of this.state.streams){\r\n\t\t\t\tif(stream.user.login === this.props.net.profile.login)\r\n\t\t\t\t\tthrow(new Error('ExistLogin'));\r\n\t\t\t}\r\n\r\n\t\t\tconst answer = await this.webrtc.connect(\r\n\t\t\t\t(stream) => this.addStream(stream, {user: this.props.net.profile, ...constraints}),\r\n\t\t\t\tconstraints\r\n\t\t\t);\r\n\r\n\t\t\tthis.props.net.socket.send(JSON.stringify({\r\n\t\t\t\ttype: 'create-connection',\r\n\t\t\t\ttoken: this.props.net.token,\r\n\t\t\t\tanswer\r\n\t\t\t}));\r\n\r\n\t\t\tthis.setState({ constraints });\r\n\r\n\t\t}catch(e){\r\n\t\t\tif(e.name === \"NotAllowedError\")\r\n\t\t\t\tthis.alertRef.current.alert(\"Сначала включите разрешение на использование микрофона в браузере\");\r\n\t\t\tif(e.message === \"ExistLogin\")\r\n\t\t\t\tthis.onError({error: e.message});\r\n\t\t\tconsole.log(e);\r\n\t\t}\r\n\t}\r\n\r\n\thighlightStream (login){\r\n\t\tthis.setState({highlighted: login});\r\n\t}\r\n\r\n\tclearHighlightStream (login){\r\n\t\tif(this.state.highlighted === login)\r\n\t\t\tthis.setState({highlighted: null});\r\n\t}\r\n\r\n\trender(){\r\n\t\tconst room = this.state.room;\r\n\t\treturn (\r\n\t\t\t<AlertWrapper delay={2000} ref={this.alertRef}>\r\n\t\t\t\t<div className=\"room-main-content\">\r\n\t\t\t\t\t<div className=\"main-column\">\r\n\t\t\t\t\t\t<header className=\"main-header\">\r\n\t\t\t\t\t\t\t<RippleA \r\n\t\t\t\t\t\t\t\ttitle=\"Вернуться к переписке\"\r\n\t\t\t\t\t\t\t\tclassName=\"transparent\" \r\n\t\t\t\t\t\t\t\tto={'/'+this.props.match.params.bind} \r\n\t\t\t\t\t\t\t\tstyle={{fontWeight: 600}}>\r\n\t\t\t\t\t\t\t\t<IoIosArrowBack size=\"1.8em\"/>Назад\r\n\t\t\t\t\t\t\t</RippleA>\r\n\t\t\t\t\t\t\t{(room !== null) && <div className=\"room-header-title\">\r\n\t\t\t\t\t\t\t\t<h1>{room.name}</h1>\r\n\t\t\t\t\t\t\t\t<RippleButton className=\"transparent user-count\">\r\n\t\t\t\t\t\t\t\t\t{room.userCount + ' ' + numeral(room.userCount, 'участник', 'участника', 'участников')}\r\n\t\t\t\t\t\t\t\t</RippleButton>\r\n\r\n\t\t\t\t\t\t\t\t<span className=\"room-time\" >0:00</span>\r\n\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t</header>\r\n\r\n\t\t\t\t\t\t{(this.state.room !== null) && (\r\n\t\t\t\t\t\t<div className=\"micro-block\" style={{textAlign: 'center'}}>\r\n\t\t\t\t\t\t\t{this.state.streams.map(_stream => (\r\n\t\t\t\t\t\t\t\t<MicroIcon \r\n\t\t\t\t\t\t\t\t\tkey={_stream.user.login} \r\n\t\t\t\t\t\t\t\t\tstream={_stream}\r\n\t\t\t\t\t\t\t\t\tcontext={this.state.context}\r\n\t\t\t\t\t\t\t\t\tonMouseEnter={() => this.highlightStream(_stream.user.login)}\r\n\t\t\t\t\t\t\t\t\tonMouseLeave={() => this.clearHighlightStream(_stream.user.login)}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t))}\r\n\r\n\t\t\t\t\t\t\t<div  style={{float: 'right'}}>\r\n\t\t\t\t\t\t\t\t<RippleButton \r\n\t\t\t\t\t\t\t\t\ttitle={this.state.constraints.audio?'Выключить микрофон':'Включить микрофон'}\r\n\t\t\t\t\t\t\t\t\tclassName={'transparent add-micro-button '+(this.state.constraints.audio?\"active\" : \"add\") }\r\n\t\t\t\t\t\t\t\t\tstyle={{margin: '4px'}}\r\n\t\t\t\t\t\t\t\t\tonClick={this.activateMicrophone}>\r\n\t\t\t\t\t\t\t\t\t<FaMicrophone size=\"1.9em\"/>\r\n\t\t\t\t\t\t\t\t</RippleButton>\r\n\r\n\t\t\t\t\t\t\t\t<RippleButton \r\n\t\t\t\t\t\t\t\t\ttitle={this.state.constraints.video?'Выключить веб-камеру':'Включить веб-камеру'}\r\n\t\t\t\t\t\t\t\t\tclassName={'transparent add-micro-button '+(this.state.constraints.video?\"active\" : \"add\") }\r\n\t\t\t\t\t\t\t\t\tstyle={{margin: '4px', marginRight: '0'}}\r\n\t\t\t\t\t\t\t\t\tonClick={this.activateCamera}>\r\n\t\t\t\t\t\t\t\t\t<WebCamIcon style={{height: '2.1em'}}/>\r\n\t\t\t\t\t\t\t\t</RippleButton>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{(this.state.room !== null) && <div className=\"telling-column\">\r\n\t\t\t\t\t\t{this.state.streams.length > 0 && <div className=\"webcam-block\">\r\n\t\t\t\t\t\t\t{this.state.streams.map(_stream => _stream.video === true?(\r\n\t\t\t\t\t\t\t\t<VideoBlock\r\n\t\t\t\t\t\t\t\t\tsrcObject={_stream.stream} \r\n\t\t\t\t\t\t\t\t\tkey={_stream.user.login}\r\n\t\t\t\t\t\t\t\t\tonMouseEnter={() => this.highlightStream(_stream.user.login)}\r\n\t\t\t\t\t\t\t\t\tonMouseLeave={() => this.clearHighlightStream(_stream.user.login)}>\r\n\t\t\t\t\t\t\t\t\t<div className={'video-icon '+ (_stream.user.login === this.state.highlighted?'show':'')}>\r\n\t\t\t\t\t\t\t\t\t\t<Icon profile={_stream.user} size=\"50\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</VideoBlock>\r\n\t\t\t\t\t\t\t):null)}\r\n\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t<MessageBlock \r\n\t\t\t\t\t\t\t\tnet={this.props.net}\r\n\t\t\t\t\t\t\t\tmessages={this.state.messages}\r\n\t\t\t\t\t\t\t\tbind={this.state.room.link}\r\n\t\t\t\t\t\t\t\tscrollMessage={this.scrollMessage}\r\n\t\t\t\t\t\t\t\tref={this.messagesRef}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Chat \r\n\t\t\t\t\t\t\tclassName=\"chat-div\" \r\n\t\t\t\t\t\t\tsend={this.sendMessage} \r\n\t\t\t\t\t\t\tshow={(this.state.bind !== null)}\r\n\t\t\t\t\t\t\tref={this.chatRef}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>}\r\n\t\t\t\t</div>\r\n\t\t\t</AlertWrapper>\r\n\t\t);\r\n\t}\r\n}","import React from 'react'\r\n\r\nexport default function (props){\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<h1>Такой страницы не существует</h1>\r\n\r\n\t\t</div>\r\n\t);\r\n}","import React from 'react'\r\nimport { Redirect, BrowserRouter, Route, Switch } from 'react-router-dom';\r\nimport NavigationBar from './NavigationBar.jsx';\r\nimport \"./../css/main-page.sass\"\r\n\r\nimport HomePage from './main/HomePage.jsx'\r\nimport MessagesPage from './main/MessagesPage.jsx'\r\nimport ConferencesPage from './main/ConferencesPage.jsx'\r\nimport SettingsPage from './main/SettingsPage.jsx'\r\nimport RoomPage from './room/RoomPage.jsx'\r\nimport Page404 from './Page404.jsx'\r\n\r\nclass MainPage extends React.Component {\r\n\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {animActive: false}\r\n\t}\r\n\r\n\tonMessage = (e) => {\r\n\t\tconst obj = JSON.parse(e.data);\r\n\t\tthis.props.net.emitter.emit(obj.type, obj.data);\r\n\t}\r\n\r\n\tcomponentDidMount(){\r\n\t\tif(this.props.net.socket)\r\n\t\t\tthis.props.net.socket.addEventListener('message', this.onMessage);\r\n\t}\r\n\r\n\tcomponentWillUnmount(){\r\n\t\tif(this.props.net.socket)\r\n\t\t\tthis.props.net.socket.removeEventListener('message', this.onMessage);\r\n\t}\r\n\r\n\trender() {\r\n\t\tif(!this.props.net.socket)\r\n\t\t\treturn <Redirect to=\"/auth\"/>\r\n\t\tconst routes = [\r\n\t\t\t{ path: ['/c', '/c/:bind', '/c/add'], Component: ConferencesPage},\r\n\t\t\t{ path: '/'+this.props.net.profile.login, Component: HomePage},\r\n\t\t\t{ path: '/settings', Component: SettingsPage },\r\n\t\t\t{ path: '/:bind/c', Component: RoomPage },\r\n\t\t\t{ path: ['/:bind', '/'], Component: MessagesPage},\r\n\t\t]\r\n\r\n\t\treturn (\r\n\t\t<div className=\"anim up\">\r\n\t\t\t<BrowserRouter>\r\n\t\t\t\t<NavigationBar profile={this.props.net.profile}/>\r\n\t\t\t\t<Switch>\r\n\t\t\t\t\t{routes.map(({path, Component}) => (\r\n\t\t\t\t\t\t<Route \tkey={(typeof path === 'string')?path:path[0]} exact path={path} \r\n\t\t\t\t\t\t\t\t\t\trender={(props) => <Component {...props} net={this.props.net} /> } />\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t<Route component={Page404}/>\r\n\t\t\t\t</Switch>\r\n\t\t\t</BrowserRouter>\r\n\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nexport default MainPage;","import React from 'react'\nimport 'normalize.css'\nimport \"./css/index.sass\"\nimport AuthPage from './components/AuthPage.jsx'\nimport MainPage from './components/MainPage.jsx'\nimport EventEmitter from 'events'\nimport { url, wsUrl } from './constants'\n\nimport { BrowserRouter, Route, Switch } from 'react-router-dom';\n\nclass App extends React.Component {\n\n  constructor(props){\n    super(props);\n    this.state = {\n      net: {\n        socket: null,\n        token: null,\n        profile: null,\n        login: null,\n        update: this.update\n      }\n    }\n\n   if(sessionStorage.getItem('token'))\n      this.state.token = sessionStorage.getItem('token');\n    \n    if(localStorage.getItem('auth'))\n      this.state.auth = JSON.parse(localStorage.getItem('auth'));\n  }\n\n  update = (u) => {\n\n    const profile = Object.assign({}, this.state.net.profile, u);\n\n    const net = Object.assign({}, this.state.net, {profile});\n    console.log(net);\n    this.setState({net});\n  }\n\n  login = auth => {\n    fetch(url+'/authorization', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json;charset=utf-8',\n        'token': '000000'\n      },\n      body: JSON.stringify(auth) })\n    .then(response => response.json())\n    .then(res => {\n      if(res.success)\n        this.onLogin(res.success);\n      else\n        this.setState({auth: null});\n    });\n  }\n\n  componentDidMount(){\n\n    if(this.state.token){\n      \n      fetch(url+'/i-have-token', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json;charset=utf-8',\n          token: this.state.token\n        },\n        body: JSON.stringify({token: this.state.token}) })\n      .then(response => response.json())\n      .then(res => {\n        this.setState({token: null});\n\n        if(res.error){\n          sessionStorage.removeItem('token');\n          if(this.state.auth)\n            this.login(this.state.auth);\n          return;\n        }\n\n        this.onLogin(res);\n      });\n    }else if(this.state.auth)\n      this.login(this.state.auth);\n  }\n\n  onLogin = u => {\n    const socket = new WebSocket(wsUrl);\n    const net = Object.assign({}, this.state.net, u);\n    net.socket = socket;\n    net.emitter = new EventEmitter();\n\n    socket.onopen = () => { \n      socket.send(JSON.stringify({type: 'auth', token: u.token})); \n    }\n    socket.onclose = (e) =>{\n      console.log('Веб-сокет закрыт. Причина:', e.reason);\n    }\n\n    net.emitter.on('logout', () => {\n      sessionStorage.clear();\n      localStorage.clear();\n      this.state.net.socket.close();\n      const _net = Object.assign({}, this.state.net, {\n        login: null,\n        profile: null,\n        socket: null,\n        token: null,\n        emitter: null\n      });\n\n      this.setState({\n        net: _net\n      });\n    });\n\n    sessionStorage.setItem('token', u.token);\n\n    this.setState({net, token: null, auth: null});\n  }\n\n  render() { \n    if(this.state.token || this.state.auth) return  <div></div>\n    return (\n      <BrowserRouter>\n        <Switch>\n          <Route path='/auth' render={(props) => <AuthPage net={this.state.net} onLogin={this.onLogin}/>}/>\n          <Route path='/' render={() => <MainPage net={this.state.net}/>}/>\n        </Switch>\n      </BrowserRouter>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}